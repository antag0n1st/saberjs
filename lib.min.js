function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function sqr(a){return a*a}function dist2(a,b){return sqr(a.x-b.x)+sqr(a.y-b.y)}function distToSegmentSquared(a,b,c){var d=dist2(b,c);if(0===d)return dist2(a,b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e=Math.max(0,Math.min(1,e)),dist2(a,{x:b.x+e*(c.x-b.x),y:b.y+e*(c.y-b.y)})}function distToSegment(a,b,c){return Math.sqrt(distToSegmentSquared(a,b,c))}function log(a){console.log(a)}function toHHMMSS(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=a-3600*b-60*c;return b<10&&(b="0"+b),c<10&&(c="0"+c),d<10&&(d="0"+d),b+":"+c+":"+d}function toMMSS(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=a-3600*b-60*c;return b<10&&(b="0"+b),c<10&&(c="0"+c),d<10&&(d="0"+d),c+":"+d}function timeout(a,b,c,d){var e=new Timer(a,b,c);return d=d||0,e.run(d),e}function createAjax(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}function ajaxGet(a,b){var c=createAjax();c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status){var a=c.getResponseHeader("content-type")||"";a.indexOf("json")>-1?b(JSON.parse(c.responseText),c):b(c.responseText,c)}else b&&b(null,c)},c.open("GET",a,!0),c.send()}function ajaxPost(a,b,c){var d=createAjax();d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){if(c){var a=d.getResponseHeader("content-type")||"";if(a.indexOf("json")>-1){var b=d.responseText;try{b=JSON.parse(d.responseText)}catch(a){b=d.responseText}c(b,d)}else c(d.responseText,d)}}else c&&c(null,d)},d.open("POST",a,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded");var e=serialize(b);d.send(e)}function lang(a){var b=Localization.instance().text[a];return b||a}function shuffleArray(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a}function treatAsUTC(a){var b=new Date(a);return b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),b}function daysBetween(a,b){return(treatAsUTC(b)-treatAsUTC(a))/864e5}function createPointsInSpace(a,b,c,d,e){for(var f=350,g=e||250,h=0,i=[],j=new V(b/2,c/2),k=0;h<a;){var l=!0,m=new V(Math.randomInt(0,b),Math.randomInt(0,c));k++,k>1e3&&g--;for(var n=0;n<i.length;n++){var o=i[n];if(Math.getDistance(m,o)<g){l=!1;break}}d&&Math.getDistance(m,j)<f&&(l=!1),l&&(h++,i.push(m))}return i}function getQueryString(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.search);return null===d?"":decodeURIComponent(d[1].replace(/\+/g," "))}function leadingZeros(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function shorten(a,b,c){for(var d="",e=[" ",",",".","!","?"],f=0,g=0;g<a.length;g++)if(d+=a[g],-1!==e.indexOf(a[g])&&(++f>=b||g>=c)){d+="...";break}return d}function googleAnalytics(a,b){b=b||"screen view",ga("send",{hitType:"event",eventCategory:b,eventAction:a})}function inArray(a,b){return-1!==a.indexOf(b)}function convertColor(a){if("transparent"===a||"#ffffff"===a||"#FFFFFF"===a)return 16777215;var b=a||"";return b=b.replace("#","0x"),b=PIXI.utils.hex2rgb(b),Color.get_color_32(1,255*b[0],255*b[1],255*b[2])}function getDateByTimeZone(a){a=a||0;var b=new Date,c=b.getTime()+6e4*b.getTimezoneOffset();return new Date(c+36e5*a)}function isDataBetween(a,b,c){var d=new Date(a.getFullYear(),a.getMonth(),a.getDate());return d>=b&&d<=c}function applyToConstructor(a,b){var c=[null].concat(b);return new(a.bind.apply(a,c))}!function(){"use strict";var a=function(){this.init()};a.prototype={init:function(){var a=this||b;return a._counter=1e3,a._codecs={},a._howls=[],a._muted=!1,a._volume=1,a._canPlayEvent="canplaythrough",a._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,a.masterGain=null,a.noAudio=!1,a.usingWebAudio=!0,a.autoSuspend=!0,a.ctx=null,a.mobileAutoEnable=!0,a._setup(),a},volume:function(a){var c=this||b;if(a=parseFloat(a),c.ctx||j(),void 0!==a&&a>=0&&a<=1){if(c._volume=a,c._muted)return c;c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a,b.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var e=c._howls[d]._getSoundIds(),f=0;f<e.length;f++){var g=c._howls[d]._soundById(e[f]);g&&g._node&&(g._node.volume=g._volume*a)}return c}return c._volume},mute:function(a){var c=this||b;c.ctx||j(),c._muted=a,c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a?0:c._volume,b.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var e=c._howls[d]._getSoundIds(),f=0;f<e.length;f++){var g=c._howls[d]._soundById(e[f]);g&&g._node&&(g._node.muted=!!a||g._muted)}return c},unload:function(){for(var a=this||b,c=a._howls.length-1;c>=0;c--)a._howls[c].unload();return a.usingWebAudio&&a.ctx&&void 0!==a.ctx.close&&(a.ctx.close(),a.ctx=null,j()),a},codecs:function(a){return(this||b)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||b;if(a.state=a.ctx?a.ctx.state||"running":"running",a._autoSuspend(),!a.usingWebAudio)if("undefined"!=typeof Audio)try{var c=new Audio;void 0===c.oncanplaythrough&&(a._canPlayEvent="canplay")}catch(b){a.noAudio=!0}else a.noAudio=!0;try{var c=new Audio;c.muted&&(a.noAudio=!0)}catch(a){}return a.noAudio||a._setupCodecs(),a},_setupCodecs:function(){var a=this||b,c=null;try{c="undefined"!=typeof Audio?new Audio:null}catch(b){return a}if(!c||"function"!=typeof c.canPlayType)return a;var d=c.canPlayType("audio/mpeg;").replace(/^no$/,""),e=a._navigator&&a._navigator.userAgent.match(/OPR\/([0-6].)/g),f=e&&parseInt(e[0].split("/")[1],10)<33;return a._codecs={mp3:!(f||!d&&!c.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!d,opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!c.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!c.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!c.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(c.canPlayType("audio/x-flac;")||c.canPlayType("audio/flac;")).replace(/^no$/,"")},a},_enableMobileAudio:function(){var a=this||b,c=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(a._navigator&&a._navigator.userAgent),d=!!("ontouchend"in window||a._navigator&&a._navigator.maxTouchPoints>0||a._navigator&&a._navigator.msMaxTouchPoints>0);if(!a._mobileEnabled&&a.ctx&&(c||d)){a._mobileEnabled=!1,a._mobileUnloaded||44100===a.ctx.sampleRate||(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var e=function(){b._autoResume();var c=a.ctx.createBufferSource();c.buffer=a._scratchBuffer,c.connect(a.ctx.destination),void 0===c.start?c.noteOn(0):c.start(0),"function"==typeof a.ctx.resume&&a.ctx.resume(),c.onended=function(){c.disconnect(0),a._mobileEnabled=!0,a.mobileAutoEnable=!1,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0)}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),a}},_autoSuspend:function(){var a=this;if(a.autoSuspend&&a.ctx&&void 0!==a.ctx.suspend&&b.usingWebAudio){for(var c=0;c<a._howls.length;c++)if(a._howls[c]._webAudio)for(var d=0;d<a._howls[c]._sounds.length;d++)if(!a._howls[c]._sounds[d]._paused)return a;return a._suspendTimer&&clearTimeout(a._suspendTimer),a._suspendTimer=setTimeout(function(){a.autoSuspend&&(a._suspendTimer=null,a.state="suspending",a.ctx.suspend().then(function(){a.state="suspended",a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())}))},3e4),a}},_autoResume:function(){var a=this;if(a.ctx&&void 0!==a.ctx.resume&&b.usingWebAudio)return"running"===a.state&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):"suspended"===a.state?(a.ctx.resume().then(function(){a.state="running";for(var b=0;b<a._howls.length;b++)a._howls[b]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):"suspending"===a.state&&(a._resumeAfterSuspend=!0),a}};var b=new a,c=function(a){var b=this;if(!a.src||0===a.src.length)return void console.error("An array of source files must be passed with any new Howl.");b.init(a)};c.prototype={init:function(a){var c=this;return b.ctx||j(),c._autoplay=a.autoplay||!1,c._format="string"!=typeof a.format?a.format:[a.format],c._html5=a.html5||!1,c._muted=a.mute||!1,c._loop=a.loop||!1,c._pool=a.pool||5,c._preload="boolean"!=typeof a.preload||a.preload,c._rate=a.rate||1,c._sprite=a.sprite||{},c._src="string"!=typeof a.src?a.src:[a.src],c._volume=void 0!==a.volume?a.volume:1,c._xhrWithCredentials=a.xhrWithCredentials||!1,c._duration=0,c._state="unloaded",c._sounds=[],c._endTimers={},c._queue=[],c._playLock=!1,c._onend=a.onend?[{fn:a.onend}]:[],c._onfade=a.onfade?[{fn:a.onfade}]:[],c._onload=a.onload?[{fn:a.onload}]:[],c._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[],c._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[],c._onpause=a.onpause?[{fn:a.onpause}]:[],c._onplay=a.onplay?[{fn:a.onplay}]:[],c._onstop=a.onstop?[{fn:a.onstop}]:[],c._onmute=a.onmute?[{fn:a.onmute}]:[],c._onvolume=a.onvolume?[{fn:a.onvolume}]:[],c._onrate=a.onrate?[{fn:a.onrate}]:[],c._onseek=a.onseek?[{fn:a.onseek}]:[],c._onresume=[],c._webAudio=b.usingWebAudio&&!c._html5,void 0!==b.ctx&&b.ctx&&b.mobileAutoEnable&&b._enableMobileAudio(),b._howls.push(c),c._autoplay&&c._queue.push({event:"play",action:function(){c.play()}}),c._preload&&c.load(),c},load:function(){var a=this,c=null;if(b.noAudio)return void a._emit("loaderror",null,"No audio support.");"string"==typeof a._src&&(a._src=[a._src]);for(var e=0;e<a._src.length;e++){var g,h;if(a._format&&a._format[e])g=a._format[e];else{if("string"!=typeof(h=a._src[e])){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}g=/^data:audio\/([^;,]+);/i.exec(h),g||(g=/\.([^.]+)$/.exec(h.split("?",1)[0])),g&&(g=g[1].toLowerCase())}if(g||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),g&&b.codecs(g)){c=a._src[e];break}}return c?(a._src=c,a._state="loading","https:"===window.location.protocol&&"http:"===c.slice(0,5)&&(a._html5=!0,a._webAudio=!1),new d(a),a._webAudio&&f(a),a):void a._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(a,c){var d=this,e=null;if("number"==typeof a)e=a,a=null;else{if("string"==typeof a&&"loaded"===d._state&&!d._sprite[a])return null;if(void 0===a){a="__default";for(var f=0,g=0;g<d._sounds.length;g++)d._sounds[g]._paused&&!d._sounds[g]._ended&&(f++,e=d._sounds[g]._id);1===f?a=null:e=null}}var h=e?d._soundById(e):d._inactiveSound();if(!h)return null;if(e&&!a&&(a=h._sprite||"__default"),"loaded"!==d._state){h._sprite=a,h._ended=!1;var i=h._id;return d._queue.push({event:"play",action:function(){d.play(i)}}),i}if(e&&!h._paused)return c||setTimeout(function(){d._emit("play",h._id)},0),h._id;d._webAudio&&b._autoResume();var j=Math.max(0,h._seek>0?h._seek:d._sprite[a][0]/1e3),k=Math.max(0,(d._sprite[a][0]+d._sprite[a][1])/1e3-j),l=1e3*k/Math.abs(h._rate);h._paused=!1,h._ended=!1,h._sprite=a,h._seek=j,h._start=d._sprite[a][0]/1e3,h._stop=(d._sprite[a][0]+d._sprite[a][1])/1e3,h._loop=!(!h._loop&&!d._sprite[a][2]);var m=h._node;if(d._webAudio){var n=function(){d._refreshBuffer(h);var a=h._muted||d._muted?0:h._volume;m.gain.setValueAtTime(a,b.ctx.currentTime),h._playStart=b.ctx.currentTime,void 0===m.bufferSource.start?h._loop?m.bufferSource.noteGrainOn(0,j,86400):m.bufferSource.noteGrainOn(0,j,k):h._loop?m.bufferSource.start(0,j,86400):m.bufferSource.start(0,j,k),l!==1/0&&(d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),l)),c||setTimeout(function(){d._emit("play",h._id)},0)};"running"===b.state?n():(d.once("resume",n),d._clearTimer(h._id))}else{var o=function(){m.currentTime=j,m.muted=h._muted||d._muted||b._muted||m.muted,m.volume=h._volume*b.volume(),m.playbackRate=h._rate;try{var a=m.play();if("undefined"!=typeof Promise&&a instanceof Promise&&(d._playLock=!0,a.then(function(){d._playLock=!1,d._loadQueue()})),m.paused)return void d._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");l!==1/0&&(d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),l)),c||d._emit("play",h._id)}catch(a){d._emit("playerror",h._id,a)}},p=window&&window.ejecta||!m.readyState&&b._navigator.isCocoonJS;if(4===m.readyState||p)o();else{var q=function(){o(),m.removeEventListener(b._canPlayEvent,q,!1)};m.addEventListener(b._canPlayEvent,q,!1),d._clearTimer(h._id)}}return h._id},pause:function(a){var b=this;if("loaded"!==b._state||b._playLock)return b._queue.push({event:"pause",action:function(){b.pause(a)}}),b;for(var c=b._getSoundIds(a),d=0;d<c.length;d++){b._clearTimer(c[d]);var e=b._soundById(c[d]);if(e&&!e._paused&&(e._seek=b.seek(c[d]),e._rateSeek=0,e._paused=!0,b._stopFade(c[d]),e._node))if(b._webAudio){if(!e._node.bufferSource)continue;void 0===e._node.bufferSource.stop?e._node.bufferSource.noteOff(0):e._node.bufferSource.stop(0),b._cleanBuffer(e._node)}else isNaN(e._node.duration)&&e._node.duration!==1/0||e._node.pause();arguments[1]||b._emit("pause",e?e._id:null)}return b},stop:function(a,b){var c=this;if("loaded"!==c._state)return c._queue.push({event:"stop",action:function(){c.stop(a)}}),c;for(var d=c._getSoundIds(a),e=0;e<d.length;e++){c._clearTimer(d[e]);var f=c._soundById(d[e]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,c._stopFade(d[e]),f._node&&(c._webAudio?f._node.bufferSource&&(void 0===f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),c._cleanBuffer(f._node)):isNaN(f._node.duration)&&f._node.duration!==1/0||(f._node.currentTime=f._start||0,f._node.pause())),b||c._emit("stop",f._id))}return c},mute:function(a,c){var d=this;if("loaded"!==d._state)return d._queue.push({event:"mute",action:function(){d.mute(a,c)}}),d;if(void 0===c){if("boolean"!=typeof a)return d._muted;d._muted=a}for(var e=d._getSoundIds(c),f=0;f<e.length;f++){var g=d._soundById(e[f]);g&&(g._muted=a,g._interval&&d._stopFade(g._id),d._webAudio&&g._node?g._node.gain.setValueAtTime(a?0:g._volume,b.ctx.currentTime):g._node&&(g._node.muted=!!b._muted||a),d._emit("mute",g._id))}return d},volume:function(){var a,c,d=this,e=arguments;if(0===e.length)return d._volume;if(1===e.length||2===e.length&&void 0===e[1]){d._getSoundIds().indexOf(e[0])>=0?c=parseInt(e[0],10):a=parseFloat(e[0])}else e.length>=2&&(a=parseFloat(e[0]),c=parseInt(e[1],10));var f;if(!(void 0!==a&&a>=0&&a<=1))return f=c?d._soundById(c):d._sounds[0],f?f._volume:0;if("loaded"!==d._state)return d._queue.push({event:"volume",action:function(){d.volume.apply(d,e)}}),d;void 0===c&&(d._volume=a),c=d._getSoundIds(c);for(var g=0;g<c.length;g++)(f=d._soundById(c[g]))&&(f._volume=a,e[2]||d._stopFade(c[g]),d._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(a,b.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=a*b.volume()),d._emit("volume",f._id));return d},fade:function(a,c,d,e){var f=this;if("loaded"!==f._state)return f._queue.push({event:"fade",action:function(){f.fade(a,c,d,e)}}),f;f.volume(a,e);for(var g=f._getSoundIds(e),h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i){if(e||f._stopFade(g[h]),f._webAudio&&!i._muted){var j=b.ctx.currentTime,k=j+d/1e3;i._volume=a,i._node.gain.setValueAtTime(a,j),i._node.gain.linearRampToValueAtTime(c,k)}f._startFadeInterval(i,a,c,d,g[h],void 0===e)}}return f},_startFadeInterval:function(a,b,c,d,e,f){var g=this,h=b,i=b>c?"out":"in",j=Math.abs(b-c),k=j/.01,l=k>0?d/k:d;l<4&&(k=Math.ceil(k/(4/l)),l=4),a._fadeTo=c,a._interval=setInterval(function(){k>0&&(h+="in"===i?.01:-.01),h=Math.max(0,h),h=Math.min(1,h),h=Math.round(100*h)/100,g._webAudio?a._volume=h:g.volume(h,a._id,!0),f&&(g._volume=h),(c<b&&h<=c||c>b&&h>=c)&&(clearInterval(a._interval),a._interval=null,a._fadeTo=null,g.volume(c,a._id),g._emit("fade",a._id))},l)},_stopFade:function(a){var c=this,d=c._soundById(a);return d&&d._interval&&(c._webAudio&&d._node.gain.cancelScheduledValues(b.ctx.currentTime),clearInterval(d._interval),d._interval=null,c.volume(d._fadeTo,a),d._fadeTo=null,c._emit("fade",a)),c},loop:function(){var a,b,c,d=this,e=arguments;if(0===e.length)return d._loop;if(1===e.length){if("boolean"!=typeof e[0])return!!(c=d._soundById(parseInt(e[0],10)))&&c._loop;a=e[0],d._loop=a}else 2===e.length&&(a=e[0],b=parseInt(e[1],10));for(var f=d._getSoundIds(b),g=0;g<f.length;g++)(c=d._soundById(f[g]))&&(c._loop=a,d._webAudio&&c._node&&c._node.bufferSource&&(c._node.bufferSource.loop=a,a&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop)));return d},rate:function(){var a,c,d=this,e=arguments;if(0===e.length)c=d._sounds[0]._id;else if(1===e.length){var f=d._getSoundIds(),g=f.indexOf(e[0]);g>=0?c=parseInt(e[0],10):a=parseFloat(e[0])}else 2===e.length&&(a=parseFloat(e[0]),c=parseInt(e[1],10));var h;if("number"!=typeof a)return h=d._soundById(c),h?h._rate:d._rate;if("loaded"!==d._state)return d._queue.push({event:"rate",action:function(){d.rate.apply(d,e)}}),d;void 0===c&&(d._rate=a),c=d._getSoundIds(c);for(var i=0;i<c.length;i++)if(h=d._soundById(c[i])){h._rateSeek=d.seek(c[i]),h._playStart=d._webAudio?b.ctx.currentTime:h._playStart,h._rate=a,d._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.value=a:h._node&&(h._node.playbackRate=a);var j=d.seek(c[i]),k=(d._sprite[h._sprite][0]+d._sprite[h._sprite][1])/1e3-j,l=1e3*k/Math.abs(h._rate);!d._endTimers[c[i]]&&h._paused||(d._clearTimer(c[i]),d._endTimers[c[i]]=setTimeout(d._ended.bind(d,h),l)),d._emit("rate",h._id)}return d},seek:function(){var a,c,d=this,e=arguments;if(0===e.length)c=d._sounds[0]._id;else if(1===e.length){var f=d._getSoundIds(),g=f.indexOf(e[0]);g>=0?c=parseInt(e[0],10):d._sounds.length&&(c=d._sounds[0]._id,a=parseFloat(e[0]))}else 2===e.length&&(a=parseFloat(e[0]),c=parseInt(e[1],10));if(void 0===c)return d;if("loaded"!==d._state)return d._queue.push({event:"seek",action:function(){d.seek.apply(d,e)}}),d;var h=d._soundById(c);if(h){if(!("number"==typeof a&&a>=0)){if(d._webAudio){var i=d.playing(c)?b.ctx.currentTime-h._playStart:0,j=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(j+i*Math.abs(h._rate))}return h._node.currentTime}var k=d.playing(c);k&&d.pause(c,!0),h._seek=a,h._ended=!1,d._clearTimer(c),k&&d.play(c,!0),!d._webAudio&&h._node&&(h._node.currentTime=a),d._emit("seek",c)}return d},playing:function(a){var b=this;if("number"==typeof a){var c=b._soundById(a);return!!c&&!c._paused}for(var d=0;d<b._sounds.length;d++)if(!b._sounds[d]._paused)return!0;return!1},duration:function(a){var b=this,c=b._duration,d=b._soundById(a);return d&&(c=b._sprite[d._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var a=this,c=a._sounds,d=0;d<c.length;d++){if(c[d]._paused||a.stop(c[d]._id),!a._webAudio){/MSIE |Trident\//.test(b._navigator&&b._navigator.userAgent)||(c[d]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),c[d]._node.removeEventListener("error",c[d]._errorFn,!1),c[d]._node.removeEventListener(b._canPlayEvent,c[d]._loadFn,!1)}delete c[d]._node,a._clearTimer(c[d]._id);var f=b._howls.indexOf(a);f>=0&&b._howls.splice(f,1)}var g=!0;for(d=0;d<b._howls.length;d++)if(b._howls[d]._src===a._src){g=!1;break}return e&&g&&delete e[a._src],b.noAudio=!1,a._state="unloaded",a._sounds=[],a=null,null},on:function(a,b,c,d){var e=this,f=e["_on"+a];return"function"==typeof b&&f.push(d?{id:c,fn:b,once:d}:{id:c,fn:b}),e},off:function(a,b,c){var d=this,e=d["_on"+a],f=0;if("number"==typeof b&&(c=b,b=null),b||c)for(f=0;f<e.length;f++){var g=c===e[f].id;if(b===e[f].fn&&g||!b&&g){e.splice(f,1);break}}else if(a)d["_on"+a]=[];else{var h=Object.keys(d);for(f=0;f<h.length;f++)0===h[f].indexOf("_on")&&Array.isArray(d[h[f]])&&(d[h[f]]=[])}return d},once:function(a,b,c){var d=this;return d.on(a,b,c,1),d},_emit:function(a,b,c){for(var d=this,e=d["_on"+a],f=e.length-1;f>=0;f--)e[f].id&&e[f].id!==b&&"load"!==a||(setTimeout(function(a){a.call(this,b,c)}.bind(d,e[f].fn),0),e[f].once&&d.off(a,e[f].fn,e[f].id));return d},_loadQueue:function(){var a=this;if(a._queue.length>0){var b=a._queue[0];a.once(b.event,function(){a._queue.shift(),a._loadQueue()}),b.action()}return a},_ended:function(a){var c=this,d=a._sprite;if(!c._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(c._ended.bind(c,a),100),c;var e=!(!a._loop&&!c._sprite[d][2]);if(c._emit("end",a._id),!c._webAudio&&e&&c.stop(a._id,!0).play(a._id),c._webAudio&&e){c._emit("play",a._id),a._seek=a._start||0,a._rateSeek=0,a._playStart=b.ctx.currentTime;var f=1e3*(a._stop-a._start)/Math.abs(a._rate);c._endTimers[a._id]=setTimeout(c._ended.bind(c,a),f)}return c._webAudio&&!e&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,c._clearTimer(a._id),c._cleanBuffer(a._node),b._autoSuspend()),c._webAudio||e||c.stop(a._id),c},_clearTimer:function(a){var b=this;return b._endTimers[a]&&(clearTimeout(b._endTimers[a]),delete b._endTimers[a]),b},_soundById:function(a){for(var b=this,c=0;c<b._sounds.length;c++)if(a===b._sounds[c]._id)return b._sounds[c];return null},_inactiveSound:function(){var a=this;a._drain();for(var b=0;b<a._sounds.length;b++)if(a._sounds[b]._ended)return a._sounds[b].reset();return new d(a)},_drain:function(){var a=this,b=a._pool,c=0,d=0;if(!(a._sounds.length<b)){for(d=0;d<a._sounds.length;d++)a._sounds[d]._ended&&c++;for(d=a._sounds.length-1;d>=0;d--){if(c<=b)return;a._sounds[d]._ended&&(a._webAudio&&a._sounds[d]._node&&a._sounds[d]._node.disconnect(0),a._sounds.splice(d,1),c--)}}},_getSoundIds:function(a){var b=this;if(void 0===a){for(var c=[],d=0;d<b._sounds.length;d++)c.push(b._sounds[d]._id);return c}return[a]},_refreshBuffer:function(a){var c=this;return a._node.bufferSource=b.ctx.createBufferSource(),a._node.bufferSource.buffer=e[c._src],a._panner?a._node.bufferSource.connect(a._panner):a._node.bufferSource.connect(a._node),a._node.bufferSource.loop=a._loop,a._loop&&(a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop),a._node.bufferSource.playbackRate.value=a._rate,c},_cleanBuffer:function(a){var c=this;if(b._scratchBuffer){a.bufferSource.onended=null,a.bufferSource.disconnect(0);try{a.bufferSource.buffer=b._scratchBuffer}catch(a){}}return a.bufferSource=null,c}};var d=function(a){this._parent=a,this.init()};d.prototype={init:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++b._counter,c._sounds.push(a),a.create(),a},create:function(){var a=this,c=a._parent,d=b._muted||a._muted||a._parent._muted?0:a._volume;return c._webAudio?(a._node=void 0===b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),a._node.gain.setValueAtTime(d,b.ctx.currentTime),a._node.paused=!0,a._node.connect(b.masterGain)):(a._node=new Audio,a._errorFn=a._errorListener.bind(a),a._node.addEventListener("error",a._errorFn,!1),a._loadFn=a._loadListener.bind(a),a._node.addEventListener(b._canPlayEvent,a._loadFn,!1),a._node.src=c._src,a._node.preload="auto",a._node.volume=d*b.volume(),a._node.load()),a},reset:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._rateSeek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++b._counter,a},_errorListener:function(){var a=this;a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorFn,!1)},_loadListener:function(){var a=this,c=a._parent;c._duration=Math.ceil(10*a._node.duration)/10,0===Object.keys(c._sprite).length&&(c._sprite={__default:[0,1e3*c._duration]}),"loaded"!==c._state&&(c._state="loaded",c._emit("load"),c._loadQueue()),a._node.removeEventListener(b._canPlayEvent,a._loadFn,!1)}};var e={},f=function(a){var b=a._src;if(e[b])return a._duration=e[b].duration,void i(a);if(/^data:[^;]+;base64,/.test(b)){for(var c=atob(b.split(",")[1]),d=new Uint8Array(c.length),f=0;f<c.length;++f)d[f]=c.charCodeAt(f);h(d.buffer,a)}else{var j=new XMLHttpRequest;j.open("GET",b,!0),j.withCredentials=a._xhrWithCredentials,j.responseType="arraybuffer",j.onload=function(){var b=(j.status+"")[0];if("0"!==b&&"2"!==b&&"3"!==b)return void a._emit("loaderror",null,"Failed loading audio file with status: "+j.status+".");h(j.response,a)},j.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete e[b],a.load())},g(j)}},g=function(a){try{a.send()}catch(b){a.onerror()}},h=function(a,c){b.ctx.decodeAudioData(a,function(a){a&&c._sounds.length>0&&(e[c._src]=a,i(c,a))},function(){c._emit("loaderror",null,"Decoding audio data failed.")})},i=function(a,b){b&&!a._duration&&(a._duration=b.duration),0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,1e3*a._duration]}),"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue())},j=function(){try{"undefined"!=typeof AudioContext?b.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?b.ctx=new webkitAudioContext:b.usingWebAudio=!1}catch(a){b.usingWebAudio=!1}var a=/iP(hone|od|ad)/.test(b._navigator&&b._navigator.platform),c=b._navigator&&b._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=c?parseInt(c[1],10):null;if(a&&d&&d<9){var e=/safari/.test(b._navigator&&b._navigator.userAgent.toLowerCase());(b._navigator&&b._navigator.standalone&&!e||b._navigator&&!b._navigator.standalone&&!e)&&(b.usingWebAudio=!1)}b.usingWebAudio&&(b.masterGain=void 0===b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),b.masterGain.gain.setValueAtTime(b._muted?0:1,b.ctx.currentTime),b.masterGain.connect(b.ctx.destination)),b._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:b,Howl:c}}),"undefined"!=typeof exports&&(exports.Howler=b,exports.Howl=c),"undefined"!=typeof window?(window.HowlerGlobal=a,window.Howler=b,window.Howl=c,window.Sound=d):"undefined"!=typeof global&&(global.HowlerGlobal=a,global.Howler=b,global.Howl=c,global.Sound=d)}(),function(a){function b(){this.fontFamily="fjs"+(999999*Math.random()|0)}if(!Object.defineProperty)throw"Font.js requires Object.defineProperty, which this browser does not support.";if(!document.createElement("canvas").getContext)throw"Font.js requires <canvas> and the Canvas2D API, which this browser does not support.";!function(a){function b(a,b){return this.slice(a,b)}function c(a,b){var c,d=a.length;for(arguments.length<2&&(b=0),c=0;c<d;++c,++b)this[b]=255&a[c]}function d(a){var d,e;if("number"==typeof a)for(d=new Array(a),e=0;e<a;++e)d[e]=0;else d=a.slice(0);return d.subarray=b,d.buffer=d,d.byteLength=d.length,d.set=c,"object"==typeof a&&a.buffer&&(d.buffer=a.buffer),d}try{new Uint8Array(1);return}catch(a){}a.Uint8Array=d,a.Uint32Array=d,a.Int32Array=d}(a),function(a){if(!a.opera&&!("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype)){var b;b=a.VBArray?function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}:function(){this.responseBody},Object.defineProperty(XMLHttpRequest.prototype,"response",{get:b})}}(a),a.btoa||(a.btoa=function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do{b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h)}while(k<a.length);m=n.join("");var o=a.length%3;return(o?m.slice(0,o-3):m)+"===".slice(o||3)}),b.prototype.url="",b.prototype.format="",b.prototype.data="",b.prototype.base64="AAEAAAAKAIAAAwAgT1MvMgAAAAAAAACsAAAAWGNtYXAAAAAAAAABBAAAACxnbHlmAAAAAAAAATAAAAAQaGVhZAAAAAAAAAFAAAAAOGhoZWEAAAAAAAABeAAAACRobXR4AAAAAAAAAZwAAAAIbG9jYQAAAAAAAAGkAAAACG1heHAAAAAAAAABrAAAACBuYW1lAAAAAAAAAcwAAAAgcG9zdAAAAAAAAAHsAAAAEAAEAAEAZAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAAMAAQAAAAwABAAgAAAABAAEAAEAAABB//8AAABB////wAABAAAAAAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAAAAAAABfDzz1AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAEAAgAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAAAQAAAAIAAQABAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAHgADAAEECQABAAAAAAADAAEECQACAAIAAAAAAAEAAAAAAAAAAAAAAAAAAA==",b.prototype.metrics={quadsize:0,leading:0,ascent:0,descent:0,weightclass:400},b.prototype.systemfont=!1,b.prototype.loaded=!1,b.prototype.onload=function(){},b.prototype.onerror=function(){},b.prototype.canvas=!1,b.prototype.context=!1,b.prototype.validate=function(a,b,c,d,e){if(!1!==e&&e<0)return void this.onerror("Requested system font '"+this.fontFamily+"' could not be loaded (it may not be installed).");getComputedStyle(a,null).getPropertyValue("width").replace("px","")>0?(document.head.removeChild(b),document.body.removeChild(a),this.loaded=!0,this.onload()):setTimeout(function(){d.validate(a,b,c,d,!1!==e&&e-50)},1e3)},b.prototype.ondownloaded=function(){var a=this,b=function(a){return String.fromCharCode(a)},c=function(a){if(a<256)return b(0)+b(a);var c=a>>8,d=255&a;return b(c)+b(d)},d=function(a,b){return 256*a+b},e=function(a,b){var c,d=a>>7==1;return a&=127,c=256*a+b,d?c-32768:c},f=function(a,b,c,d){return 16777216*a+65536*b+256*c+d},g=function(b){a.onerror(b)},h=b(0)+b(1)+b(0)+b(0),i="OTTO",j=this.data,k=b(j[0])+b(j[1])+b(j[2])+b(j[3]),l=k===h,m=!l&&k===i;if(l)this.format="truetype";else{if(!m)return void g("Error: file at "+this.url+" cannot be interpreted as OpenType font.");this.format="opentype"}var n,o,p=d(j[4],j[5]),q=12,r=q+16*p,s={};for(n=q;n<r;n+=16)o=b(j[n])+b(j[n+1])+b(j[n+2])+b(j[n+3]),s[o]={name:o,checksum:f(j[n+4],j[n+5],j[n+6],j[n+7]),offset:f(j[n+8],j[n+9],j[n+10],j[n+11]),length:f(j[n+12],j[n+13],j[n+14],j[n+15])};var t=function(a){return s[a]?a:(g("Error: font is missing the required OpenType '"+a+"' table."),!1)};if(!1!==(o=t("head"))){n=s[o].offset,s[o].version=""+j[n]+j[n+1]+j[n+2]+j[n+3];var u=d(j[n+18],j[n+19]);if(this.metrics.quadsize=u,!1!==(o=t("hhea"))&&(n=s[o].offset,s[o].version=""+j[n]+j[n+1]+j[n+2]+j[n+3],this.metrics.ascent=e(j[n+4],j[n+5])/u,this.metrics.descent=e(j[n+6],j[n+7])/u,this.metrics.leading=e(j[n+8],j[n+9])/u,!1!==(o=t("OS/2"))&&(n=s[o].offset,s[o].version=""+j[n]+j[n+1],this.metrics.weightclass=d(j[n+4],j[n+5]),!1!==(o=t("cmap"))))){n=s[o].offset,s[o].version=""+j[n]+j[n+1],p=d(j[n+2],j[n+3]);for(var v,w,x,y,z,A=!1,v=0;v<p;v++)w=n+4+8*v,x=d(j[w],j[w+1]),y=d(j[w+2],j[w+3]),z=f(j[w+4],j[w+5],j[w+6],j[w+7]),3===x&&1===y&&(A=z);var B="A";if(!1!==A&&(n+=A,4===(k=d(j[n],j[n+1])))){for(var C=d(j[n+6],j[n+7])/2,D=function(a){return-1===[9,10,11,12,13,32,127,128,129,141,142,143,144,149,157,158,160,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8232,8233,8234,8235,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,12288].indexOf(a)},E=n+14,F=n+14+2*C,G=!1;E<F&&(G=d(j[E],j[E+1]),!D(G));E+=2)G=!1;if(0!=G){B=String.fromCharCode(G);var H=(65536-(G-1))%65536,I=b(0)+c(G)+c(65535)+c(0)+c(G)+c(65535)+c(H)+c(1),J=btoa(I);this.base64=this.base64.substring(0,380)+J+this.base64.substring(380+J.length)}}this.bootstrapValidation(B,!1)}}},b.prototype.bootstrapValidation=function(a,b){var c=this.fontFamily+" testfont",d=document.createElement("style");d.setAttribute("type","text/css"),d.innerHTML="@font-face {\n  font-family: '"+c+"';\n  src: url('data:application/x-font-ttf;base64,"+this.base64+"')\n       format('truetype');}",document.head.appendChild(d);var e=!1;this.systemfont||(e=this.toStyleNode(),document.head.appendChild(e));var f=document.createElement("p");if(f.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",f.style.fontFamily="'"+this.fontFamily+"', '"+c+"'",f.innerHTML=a+a+a+a+a+a+a+a+a+a,document.body.appendChild(f),"undefined"==typeof getComputedStyle)this.onload(),error("Error: getComputedStyle is not supported by this browser.\nConsequently, Font.onload() cannot be trusted.");else{var g=this.systemfont?1e3:this.metrics.quadsize,h=document.createElement("canvas");h.width=g,h.height=g,this.canvas=h;var i=h.getContext("2d");i.font="1em '"+this.fontFamily+"'",i.fillStyle="white",i.fillRect(-1,-1,g+2,g+2),i.fillStyle="black",i.fillText("test text",50,g/2),this.context=i;var j=this,k=function(){j.validate(f,d,e,j,b)};setTimeout(k,50)}},b.prototype.processSystemFont=function(){this.systemfont=!0,this.metrics=!1,this.bootstrapValidation("A",1e3)},b.prototype.loadFont=function(){var a=this;if(-1===this.url.indexOf("."))return void setTimeout(function(){a.processSystemFont()},10);var b=new XMLHttpRequest;b.open("GET",a.url,!0),b.responseType="arraybuffer",b.onload=function(c){var d=b.response;d?(a.data=new Uint8Array(d),a.ondownloaded()):a.onerror("Error downloading font resource from "+a.url)},b.onerror=function(b){a.onerror("Error downloading font resource from "+a.url)},b.send(null)},b.prototype.styleNode=!1,b.prototype.toStyleNode=function(){if(this.styleNode)return this.styleNode;this.styleNode=document.createElement("style"),this.styleNode.type="text/css";var a="@font-face {\n";return a+="  font-family: '"+this.fontFamily+"';\n",a+="  src: url('"+this.url+"') format('"+this.format+"');\n",(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(a+="  src: url('"+this.url.replace(".ttf",".eot")+"?#eifix') format('embedded-opentype');\n"),a+="}",this.styleNode.innerHTML=a,this.styleNode},b.prototype.measureText=function(a,b){if(!this.loaded)return this.onerror("measureText() was called while the font was not yet loaded"),!1;this.context.font=b+"px '"+this.fontFamily+"'";var c=this.context.measureText(a);c.fontsize=b,c.ascent=0,c.descent=0,c.bounds={minx:0,maxx:c.width,miny:0,maxy:0},c.height=0;var d=[];c.width,this.metrics.quadsize;d.push(a);var e,f=d.length;for(e=0;e<f;e++)this.measureSegment(d[e],b,c);return c},b.prototype.measureSegment=function(a,b,c){var d,e=function(a,b){return document.defaultView.getComputedStyle(a,null).getPropertyValue(b)},f=document.createElement("div");f.style.position="absolute",f.style.opacity=0,f.style.font=b+"px '"+this.fontFamily+"'";var g=10;for(f.innerHTML=a,d=1;d<g;d++)f.innerHTML+="<br/>"+a;document.body.appendChild(f),c.leading=1.2*b;var h=e(f,"height");if(h=h.replace("px",""),h>=b*g&&(c.leading=h/g|0),document.body.removeChild(f),/^\s*$/.test(a))return c;var i=(this.canvas,this.context),j=this.systemfont?1e3:this.metrics.quadsize,k=j,l=j,m=j/2,n=50,o=(j-c.width)/2;o!==(0|o)&&(o|=0),i.fillStyle="white",i.fillRect(-n,-n,k+2*n,l+2*n),i.fillStyle="black",i.fillText(a,o,m);for(var p=c.width+n|0,q=4*b,r=o-n/2,s=m-q/2,t=i.getImageData(r,s,p,q).data,d=0,u=0,v=4*p,w=t.length,x=q/2;++d<w&&255===t[d];);var y=d/v|0;for(d=w-1;--d>0&&255===t[d];);var z=d/v|0;for(d=0,u=0;u<p&&255===t[d];)(d+=v)>=w&&(u++,d=d-w+4);var A=u,B=1;for(d=w-3,u=0;u<p&&255===t[d];)(d-=v)<0&&(u++,d=w-3-4*B++);var C=p-u;return c.ascent=x-y,c.descent=z-x,c.bounds={minx:A-n/2,maxx:C-n/2,miny:-c.descent,maxy:c.ascent},c.height=z-y+1,c},Object.defineProperty(b.prototype,"src",{set:function(a){this.url=a,this.loadFont()}}),"undefined"!=typeof define?define(function(){return b}):a.Font=b}(window),function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.SAT=b()}(this,function(){"use strict";function a(a,b){this.x=a||0,this.y=b||0}function b(b,c){this.pos=b||new a,this.r=c||0}function c(b,c){this.pos=b||new a,this.angle=0,this.offset=new a,this.setPoints(c||[])}function d(b,c,d){this.pos=b||new a,this.w=c||0,this.h=d||0}function e(){this.a=null,this.b=null,this.overlapN=new a,this.overlapV=new a,this.clear()}function f(a,b,c){for(var d=Number.MAX_VALUE,e=-Number.MAX_VALUE,f=a.length,g=0;g<f;g++){var h=a[g].dot(b);h<d&&(d=h),h>e&&(e=h)}c[0]=d,c[1]=e}function g(a,b,c,d,e,g){var h=r.pop(),i=r.pop(),j=p.pop().copy(b).sub(a),k=j.dot(e);if(f(c,e,h),f(d,e,i),i[0]+=k,i[1]+=k,h[0]>i[1]||i[0]>h[1])return p.push(j),r.push(h),r.push(i),!0;if(g){var l=0;if(h[0]<i[0])if(g.aInB=!1,h[1]<i[1])l=h[1]-i[0],g.bInA=!1;else{var m=h[1]-i[0],n=i[1]-h[0];l=m<n?m:-n}else if(g.bInA=!1,h[1]>i[1])l=h[0]-i[1],g.aInB=!1;else{var m=h[1]-i[0],n=i[1]-h[0];l=m<n?m:-n}var o=Math.abs(l);o<g.overlap&&(g.overlap=o,g.overlapN.copy(e),l<0&&g.overlapN.reverse())}return p.push(j),r.push(h),r.push(i),!1}function h(a,b){var c=a.len2(),d=b.dot(a);return d<0?u:d>c?w:v}function i(a,b){var c=p.pop().copy(a).sub(b.pos),d=b.r*b.r,e=c.len2();return p.push(c),e<=d}function j(a,b){t.pos.copy(a),s.clear();var c=n(t,b,s);return c&&(c=s.aInB),c}function k(a,b,c){var d=p.pop().copy(b.pos).sub(a.pos),e=a.r+b.r,f=e*e,g=d.len2();if(g>f)return p.push(d),!1;if(c){var h=Math.sqrt(g);c.a=a,c.b=b,c.overlap=e-h,c.overlapN.copy(d.normalize()),c.overlapV.copy(d).scale(c.overlap),c.aInB=a.r<=b.r&&h<=b.r-a.r,c.bInA=b.r<=a.r&&h<=a.r-b.r}return p.push(d),!0}function l(a,b,c){for(var d=p.pop().copy(b.pos).sub(a.pos),e=b.r,f=e*e,g=a.calcPoints,i=g.length,j=p.pop(),k=p.pop(),l=0;l<i;l++){var m=l===i-1?0:l+1,n=0===l?i-1:l-1,o=0,q=null;j.copy(a.edges[l]),k.copy(d).sub(g[l]),c&&k.len2()>f&&(c.aInB=!1);var r=h(j,k);if(r===u){j.copy(a.edges[n]);var s=p.pop().copy(d).sub(g[n]);if((r=h(j,s))===w){var t=k.len();if(t>e)return p.push(d),p.push(j),p.push(k),p.push(s),!1;c&&(c.bInA=!1,q=k.normalize(),o=e-t)}p.push(s)}else if(r===w){if(j.copy(a.edges[m]),k.copy(d).sub(g[m]),(r=h(j,k))===u){var t=k.len();if(t>e)return p.push(d),p.push(j),p.push(k),!1;c&&(c.bInA=!1,q=k.normalize(),o=e-t)}}else{var v=j.perp().normalize(),t=k.dot(v),x=Math.abs(t);if(t>0&&x>e)return p.push(d),p.push(v),p.push(k),!1;c&&(q=v,o=e-t,(t>=0||o<2*e)&&(c.bInA=!1))}q&&c&&Math.abs(o)<Math.abs(c.overlap)&&(c.overlap=o,c.overlapN.copy(q))}return c&&(c.a=a,c.b=b,c.overlapV.copy(c.overlapN).scale(c.overlap)),p.push(d),p.push(j),p.push(k),!0}function m(a,b,c){var d=l(b,a,c);if(d&&c){var e=c.a,f=c.aInB;c.overlapN.reverse(),c.overlapV.reverse(),c.a=c.b,c.b=e,c.aInB=c.bInA,c.bInA=f}return d}function n(a,b,c){for(var d=a.calcPoints,e=d.length,f=b.calcPoints,h=f.length,i=0;i<e;i++)if(g(a.pos,b.pos,d,f,a.normals[i],c))return!1;for(var i=0;i<h;i++)if(g(a.pos,b.pos,d,f,b.normals[i],c))return!1;return c&&(c.a=a,c.b=b,c.overlapV.copy(c.overlapN).scale(c.overlap)),!0}var o={};o.Vector=a,o.V=a,a.prototype.copy=a.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},a.prototype.clone=a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.perp=a.prototype.perp=function(){var a=this.x;return this.x=this.y,this.y=-a,this},a.prototype.rotate=a.prototype.rotate=function(a){var b=this.x,c=this.y;return this.x=b*Math.cos(a)-c*Math.sin(a),this.y=b*Math.sin(a)+c*Math.cos(a),this},a.prototype.reverse=a.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},a.prototype.normalize=a.prototype.normalize=function(){var a=this.len();return a>0&&(this.x=this.x/a,this.y=this.y/a),this},a.prototype.add=a.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},a.prototype.sub=a.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},a.prototype.scale=a.prototype.scale=function(a,b){return this.x*=a,this.y*=b||a,this},a.prototype.project=a.prototype.project=function(a){var b=this.dot(a)/a.len2();return this.x=b*a.x,this.y=b*a.y,this},a.prototype.projectN=a.prototype.projectN=function(a){var b=this.dot(a);return this.x=b*a.x,this.y=b*a.y,this},a.prototype.reflect=a.prototype.reflect=function(a){var b=this.x,c=this.y;return this.project(a).scale(2),this.x-=b,this.y-=c,this},a.prototype.reflectN=a.prototype.reflectN=function(a){var b=this.x,c=this.y;return this.projectN(a).scale(2),this.x-=b,this.y-=c,this},a.prototype.dot=a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.len2=a.prototype.len2=function(){return this.dot(this)},a.prototype.len=a.prototype.len=function(){return Math.sqrt(this.len2())},o.Circle=b,b.prototype.getAABB=b.prototype.getAABB=function(){var b=this.r;return new d(this.pos.clone().sub(new a(b,b)),2*b,2*b).toPolygon()},o.Polygon=c,c.prototype.setPoints=c.prototype.setPoints=function(b){if(!this.points||this.points.length!==b.length){var c,d=this.calcPoints=[],e=this.edges=[],f=this.normals=[];for(c=0;c<b.length;c++)d.push(new a),e.push(new a),f.push(new a)}return this.points=b,this._recalc(),this},c.prototype.setAngle=c.prototype.setAngle=function(a){return this.angle=a,this._recalc(),this},c.prototype.setOffset=c.prototype.setOffset=function(a){return this.offset=a,this._recalc(),this},c.prototype.rotate=c.prototype.rotate=function(a){for(var b=this.points,c=b.length,d=0;d<c;d++)b[d].rotate(a);return this._recalc(),this},c.prototype.translate=c.prototype.translate=function(a,b){for(var c=this.points,d=c.length,e=0;e<d;e++)c[e].x+=a,c[e].y+=b;return this._recalc(),this},c.prototype._recalc=function(){var a,b=this.calcPoints,c=this.edges,d=this.normals,e=this.points,f=this.offset,g=this.angle,h=e.length;for(a=0;a<h;a++){var i=b[a].copy(e[a]);i.x+=f.x,i.y+=f.y,0!==g&&i.rotate(g)}for(a=0;a<h;a++){var j=b[a],k=a<h-1?b[a+1]:b[0],l=c[a].copy(k).sub(j);d[a].copy(l).perp().normalize()}return this},c.prototype.getAABB=c.prototype.getAABB=function(){for(var b=this.calcPoints,c=b.length,e=b[0].x,f=b[0].y,g=b[0].x,h=b[0].y,i=1;i<c;i++){var j=b[i];j.x<e?e=j.x:j.x>g&&(g=j.x),j.y<f?f=j.y:j.y>h&&(h=j.y)}return new d(this.pos.clone().add(new a(e,f)),g-e,h-f).toPolygon()},o.Box=d,d.prototype.toPolygon=d.prototype.toPolygon=function(){var b=this.pos,d=this.w,e=this.h;return new c(new a(b.x,b.y),[new a,new a(d,0),new a(d,e),new a(0,e)])},o.Response=e,e.prototype.clear=e.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var p=[],q=0;q<10;q++)p.push(new a);for(var r=[],q=0;q<5;q++)r.push([]);var s=new e,t=new d(new a,1e-6,1e-6).toPolygon();o.isSeparatingAxis=g;var u=-1,v=0,w=1;return o.pointInCircle=i,o.pointInPolygon=j,o.testCircleCircle=k,o.testPolygonCircle=l,o.testCirclePolygon=m,o.testPolygonPolygon=n,o});var Kibo=function(a,b){this.element=a||window.document,this.context=b||this,this.initialize()};Kibo.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",33:"page_up",34:"page_down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num_lock",188:"comma",189:"dash",190:"dot",191:"slash"},Kibo.KEY_CODES_BY_NAME={},function(){for(var a in Kibo.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(Kibo.KEY_NAMES_BY_CODE,a)&&(Kibo.KEY_CODES_BY_NAME[Kibo.KEY_NAMES_BY_CODE[a]]=+a)}(),Kibo.MODIFIERS=["shift","ctrl","alt"],Kibo.WILDCARD_TYPES=["arrow","number","letter","f","symbols","decimals"],Kibo.WILDCARDS={arrow:[37,38,39,40],number:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],letter:[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90],f:[112,113,114,115,116,117,118,119,120,121,122,123],symbols:[59,61,173,186,187,188,189,190,191,192,106,107,108,109,110,111,219,220,221,222],decimals:[110,190]},Kibo.registerEvent=function(){return document.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:document.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:void 0}(),Kibo.unregisterEvent=function(){return document.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:document.detachEvent?function(a,b,c){a.detachEvent("on"+b,c)}:void 0}(),Kibo.stringContains=function(a,b){return-1!==a.indexOf(b)},Kibo.neatString=function(a){return a.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")},Kibo.capitalize=function(a){return a.toLowerCase().replace(/^./,function(a){return a.toUpperCase()})},Kibo.isString=function(a){return Kibo.stringContains(Object.prototype.toString.call(a),"String")},Kibo.arrayIncludes=function(){return Array.prototype.indexOf?function(a,b){return-1!==a.indexOf(b)}:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}}(),Kibo.extractModifiers=function(a){var b,c;for(b=[],c=0;c<Kibo.MODIFIERS.length;c++)Kibo.stringContains(a,Kibo.MODIFIERS[c])&&b.push(Kibo.MODIFIERS[c]);return b},Kibo.extractKey=function(a){var b,c;for(b=Kibo.neatString(a).split(" "),c=0;c<b.length;c++)if(!Kibo.arrayIncludes(Kibo.MODIFIERS,b[c]))return b[c]},Kibo.modifiersAndKey=function(a){var b,c;return Kibo.stringContains(a,"any")?Kibo.neatString(a).split(" ").slice(0,2).join(" "):(b=Kibo.extractModifiers(a),c=Kibo.extractKey(a),c&&!Kibo.arrayIncludes(Kibo.MODIFIERS,c)&&b.push(c),b.join(" "))},Kibo.keyName=function(a){return Kibo.KEY_NAMES_BY_CODE[a+""]},Kibo.keyCode=function(a){return+Kibo.KEY_CODES_BY_NAME[a]},Kibo.prototype.initialize=function(){var a,b=this;for(this.lastKeyCode=-1,this.lastModifiers={},a=0;a<Kibo.MODIFIERS.length;a++)this.lastModifiers[Kibo.MODIFIERS[a]]=!1;for(this.keysDown={any:[]},this.keysUp={any:[]},a=0;a<Kibo.WILDCARD_TYPES.length;a++)this.keysDown["any "+Kibo.WILDCARD_TYPES[a]]=[],this.keysUp["any "+Kibo.WILDCARD_TYPES[a]]=[];this.downHandler=this.handler("down"),this.upHandler=this.handler("up"),Kibo.registerEvent(this.element,"keydown",this.downHandler),Kibo.registerEvent(this.element,"keyup",this.upHandler),Kibo.registerEvent(window,"unload",function a(){Kibo.unregisterEvent(b.element,"keydown",b.downHandler),Kibo.unregisterEvent(b.element,"keyup",b.upHandler),Kibo.unregisterEvent(window,"unload",a)})},Kibo.prototype.handler=function(a){var b=this;return function(c){var d,e,f,g;for(c=c||window.event,c.keyIdentifier&&(c.keyCode=parseInt(c.keyIdentifier,16),c.key=String.fromCharCode(c.keyCode)),b.lastKeyCode=c.keyCode,d=0;d<Kibo.MODIFIERS.length;d++)b.lastModifiers[Kibo.MODIFIERS[d]]=c[Kibo.MODIFIERS[d]+"Key"];for(Kibo.arrayIncludes(Kibo.MODIFIERS,Kibo.keyName(b.lastKeyCode))&&(b.lastModifiers[Kibo.keyName(b.lastKeyCode)]=!0),f=b["keys"+Kibo.capitalize(a)],d=0;d<f.any.length;d++){var h=f.any[d],i=h.call(b.context,c);!1===i&&c.preventDefault&&c.preventDefault()}for(d=0;d<Kibo.WILDCARD_TYPES.length;d++)if(Kibo.arrayIncludes(Kibo.WILDCARDS[Kibo.WILDCARD_TYPES[d]],b.lastKeyCode))for(e=0;e<f["any "+Kibo.WILDCARD_TYPES[d]].length;e++){var h=f["any "+Kibo.WILDCARD_TYPES[d]][e],i=h.call(b.context,c);!1===i&&c.preventDefault&&c.preventDefault()}if(g=b.lastModifiersAndKey(),f[g])for(d=0;d<f[g].length;d++){var h=f[g][d];!1===h.call(b.context,c)&&c.preventDefault&&c.preventDefault()}}},Kibo.prototype.registerKeys=function(a,b,c){var d,e,f=this["keys"+Kibo.capitalize(a)];for(Kibo.isString(b)&&(b=[b]),d=0;d<b.length;d++)e=b[d],e=Kibo.modifiersAndKey(e+""),f[e]?f[e].push(c):f[e]=[c];return this},Kibo.prototype.unregisterKeys=function(a,b,c){var d,e,f,g=this["keys"+Kibo.capitalize(a)];for(Kibo.isString(b)&&(b=[b]),d=0;d<b.length;d++)if(f=b[d],f=Kibo.modifiersAndKey(f+""),null===c)delete g[f];else if(g[f])for(e=0;e<g[f].length;e++)if(String(g[f][e])===String(c)){g[f].splice(e,1);break}return this},Kibo.prototype.unregisterAll=function(){this.unregisterByKey("keysUp"),this.unregisterByKey("keysDown")},Kibo.prototype.unregisterByKey=function(a){var b=this[a];for(var c in b)b.hasOwnProperty(c)&&(b[c]=[])},Kibo.prototype.delegate=function(a,b,c){return null!==c?this.registerKeys(a,b,c):this.unregisterKeys(a,b,c)},Kibo.prototype.down=function(a,b){return this.delegate("down",a,b)},Kibo.prototype.up=function(a,b){return this.delegate("up",a,b)},Kibo.prototype.lastKey=function(a){return a?this.lastModifiers[a]:Kibo.keyName(this.lastKeyCode)},Kibo.prototype.lastModifiersAndKey=function(){var a,b;for(a=[],b=0;b<Kibo.MODIFIERS.length;b++)this.lastKey(Kibo.MODIFIERS[b])&&a.push(Kibo.MODIFIERS[b]);return Kibo.arrayIncludes(a,this.lastKey())||a.push(this.lastKey()),a.join(" ")},function(a){"use strict";var b=-1,c={onVisible:function(a){var b=c.isSupported();if(!b||!c.hidden())return a(),b;var d=c.change(function(b,e){c.hidden()||(c.unbind(d),a())});return d},change:function(a){if(!c.isSupported())return!1;b+=1;var d=b;return c._callbacks[d]=a,c._listen(),d},unbind:function(a){delete c._callbacks[a]},afterPrerendering:function(a){var b=c.isSupported(),d="prerender";if(!b||d!=c.state())return a(),b;var e=c.change(function(b,f){d!=f&&(c.unbind(e),a())});return e},hidden:function(){return!(!c._doc.hidden&&!c._doc.webkitHidden)},state:function(){return c._doc.visibilityState||c._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!c._doc.visibilityState&&!c._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(a){var b=c.state();for(var d in c._callbacks)c._callbacks[d].call(c._doc,a,b)},_listen:function(){if(!c._init){var a="visibilitychange";c._doc.webkitVisibilityState&&(a="webkit"+a);var b=function(){c._change.apply(c,arguments)};c._doc.addEventListener?c._doc.addEventListener(a,b):c._doc.attachEvent(a,b),c._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=c:a.Visibility=c}(this),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.store=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){"use strict";b.exports=function(){function b(){try{return g in e&&e[g]}catch(a){return!1}}var c,d={},e="undefined"!=typeof window?window:a,f=e.document,g="localStorage",h="script";if(d.disabled=!1,d.version="1.3.20",d.set=function(a,b){},d.get=function(a,b){},d.has=function(a){return void 0!==d.get(a)},d.remove=function(a){},d.clear=function(){},d.transact=function(a,b,c){null==c&&(c=b,b=null),null==b&&(b={});var e=d.get(a,b);c(e),d.set(a,e)},d.getAll=function(){},d.forEach=function(){},d.serialize=function(a){return JSON.stringify(a)},d.deserialize=function(a){if("string"==typeof a)try{return JSON.parse(a)}catch(b){return a||void 0}},b())c=e[g],d.set=function(a,b){return void 0===b?d.remove(a):(c.setItem(a,d.serialize(b)),b)},d.get=function(a,b){var e=d.deserialize(c.getItem(a));return void 0===e?b:e},d.remove=function(a){c.removeItem(a)},d.clear=function(){c.clear()},d.getAll=function(){var a={};return d.forEach(function(b,c){a[b]=c}),a},d.forEach=function(a){for(var b=0;b<c.length;b++){var e=c.key(b);a(e,d.get(e))}};else if(f&&f.documentElement.addBehavior){var i,j;try{j=new ActiveXObject("htmlfile"),j.open(),j.write("<"+h+">document.w=window</"+h+'><iframe src="/favicon.ico"></iframe>'),j.close(),i=j.w.frames[0].document,c=i.createElement("div")}catch(a){c=f.createElement("div"),i=f.body}var k=function(a){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(c),i.appendChild(c),c.addBehavior("#default#userData"),c.load(g);var e=a.apply(d,b);return i.removeChild(c),e}},l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),m=function(a){return a.replace(/^d/,"___$&").replace(l,"___")};d.set=k(function(a,b,c){return b=m(b),void 0===c?d.remove(b):(a.setAttribute(b,d.serialize(c)),a.save(g),c)}),d.get=k(function(a,b,c){b=m(b);var e=d.deserialize(a.getAttribute(b));return void 0===e?c:e}),d.remove=k(function(a,b){b=m(b),a.removeAttribute(b),a.save(g)}),d.clear=k(function(a){var b=a.XMLDocument.documentElement.attributes;a.load(g);for(var c=b.length-1;c>=0;c--)a.removeAttribute(b[c].name);a.save(g)}),d.getAll=function(a){var b={};return d.forEach(function(a,c){b[a]=c}),b},d.forEach=k(function(a,b){for(var c,e=a.XMLDocument.documentElement.attributes,f=0;c=e[f];++f)b(c.name,d.deserialize(a.getAttribute(c.name)))})}try{var n="__storejs__";d.set(n,n),d.get(n)!=n&&(d.disabled=!0),d.remove(n)}catch(a){d.disabled=!0}return d.enabled=!d.disabled,d}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});var OP=PIXI.ObservablePoint,P=PIXI.Point;PIXI.DisplayObject.prototype.sensor=null,PIXI.DisplayObject.prototype._width=0,PIXI.DisplayObject.prototype._height=0,PIXI.DisplayObject.prototype.zIndex=0,PIXI.DisplayObject.prototype.tag=0,PIXI.DisplayObject.prototype.priority=0,PIXI.DisplayObject.prototype.sumAllAngles=function(){return this.parent?this.rotation+this.parent.sumAllAngles():this.rotation},PIXI.DisplayObject.prototype.absoluteScale=function(){return this.parent?this.scale.x*this.parent.absoluteScale():this.scale.x},PIXI.DisplayObject.prototype.absoluteScaleY=function(){return this.parent?this.scale.y*this.parent.absoluteScaleY():this.scale.y},PIXI.DisplayObject.prototype.setCustomSensor=function(a){this.sensor=a},PIXI.DisplayObject.prototype.enableSensor=function(){this.sensor||(this.texture?(this._width=this.texture.width,this._height=this.texture.height):(this._width=1,this._height=1),this.sensor=new SAT.Box(new SAT.V(this.x,this.y),this._width,this._height).toPolygon(),this._sensorTranslationX=0,this._sensorTranslationY=0,this._sensorRotation=0,this.eventIdx=-1,this.isMouseDown=!1,this.isTouchable=!0)},PIXI.DisplayObject.prototype.updateSensor=function(){this.sensor||this.enableSensor();var a=this.absoluteScale(),b=this.absoluteScaleY();this.sensor=new SAT.Box(new SAT.V(this.x,this.y),this._width*a,this._height*b).toPolygon(),this.sensor.translate(-this._sensorTranslationX,-this._sensorTranslationY),this.sensor.rotate(this._sensorRotation)},PIXI.DisplayObject.prototype.setSensorSize=function(a,b){this.sensor||this.enableSensor(),this._width=a,this._height=b,this.updateSensor()},PIXI.DisplayObject.prototype.adjustTranslation=function(){var a=this.pivot?this.pivot.x:0,b=this.pivot?this.pivot.y:0,c=this.anchor?this.anchor.x:0,d=this.anchor?this.anchor.y:0,e=this.absoluteScale(),f=this.absoluteScaleY(),g=a+this._width*c*e,h=b+this._height*d*f,i=this._sensorTranslationX-g,j=this._sensorTranslationY-h;(i||j)&&(this.sensor.translate(i,j),this._sensorTranslationX=g,this._sensorTranslationY=h)},PIXI.DisplayObject.prototype.getSensor=function(){if(this.sensor){var a=this.getGlobalPosition();return this.sensor.pos.copy(a),this.adjustTranslation(),this.adjustRotation(),this.sensor}return null},PIXI.DisplayObject.prototype.adjustRotation=function(){var a=this.sumAllAngles(),b=a-this._sensorRotation;b&&(this.sensor.rotate(b),this._sensorRotation=a)},PIXI.DisplayObject.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},PIXI.DisplayObject.prototype._check=function(a){var b=this.getSensor();return!!SAT.pointInPolygon(a,b)},PIXI.DisplayObject.prototype.stretch=function(a,b){this.width=a,this.height=b},PIXI.DisplayObject.prototype.centered=function(){this.anchor.set(.5,.5)},PIXI.DisplayObject.prototype.update=function(a){},PIXI.DisplayObject.prototype.postUpdate=function(a){},PIXI.DisplayObject.prototype.onMouseDown=function(a,b){},PIXI.DisplayObject.prototype.onMouseMove=function(a,b){},PIXI.DisplayObject.prototype.onMouseUp=function(a,b){},PIXI.DisplayObject.prototype.onMouseCancel=function(a,b){},PIXI.DisplayObject.prototype.onRightMouseDown=function(a,b){},PIXI.DisplayObject.prototype.onRightMouseMove=function(a,b){},PIXI.DisplayObject.prototype.onRightMouseUp=function(a,b){},PIXI.DisplayObject.prototype.onWheel=function(a,b){},PIXI.DisplayObject.prototype.onInputAdded=function(){},PIXI.DisplayObject.prototype.onInputRemoved=function(){},PIXI.Sprite.prototype.findTexture=function(a){return Images[a]?Images[a].texture:a?PIXI.Texture.fromFrame(a):PIXI.Texture.EMPTY},PIXI.Sprite.prototype.setTexture=function(a){this.texture=this.findTexture(a),this.imageName=a};var Plane=function(a){function b(c,d,e,f){_classCallCheck(this,b,e,f);var g=_possibleConstructorReturn(this,a.call(this,c));return g.originalPoints=d,g._anchor=new OP(g.onAnchorUpdate,g),g.sx=e||2,g.sy=f||2,g.initPoints(),g.drawMode=PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES,g._ready=!0,g.refresh(),g}return _inherits(b,a),b.prototype.initPoints=function(){this.points=[];for(var a=this._texture,b=this.sx-1,c=this.sy-1,d=a.width/b,e=a.height/c,f=0;f<this.sx;f++)for(var g=0;g<this.sy;g++)if(0===f||f===b||0===g||g===c){var h=new OV(f*d,g*e);this.points.push(h)}for(var f=0;f<this.originalPoints.length;f++)this.points.push(this.originalPoints[f]);for(var f=0;f<this.points.length;f++){var h=this.points[f];h.index=f,h.callback=function(a){this.vertices[2*a.index]=a.x,this.vertices[2*a.index+1]=a.y},h.context=this}},b.prototype._refresh=function(){for(var a=this._texture,b=[],c=[],d=[],e=0;e<this.points.length;e++){var f=this.points[e];b.push(f.x,f.y),d.push(Math.normalize(f.x,0,a.width),Math.normalize(f.y,0,a.height))}for(var g=[],e=0;e<this.points.length;e++)g.push([this.points[e].x,this.points[e].y]);var h=new Delaunator(g);this.vertices=new Float32Array(b),this.uvs=new Float32Array(d),this.colors=new Float32Array(c),this.indices=new Uint16Array(h.triangles),this.dirty++,this.indexDirty++,this.multiplyUvs()},b.prototype.onAnchorUpdate=function(){this._transformID=-1,this._ready&&this.refresh()},b.prototype._onTextureUpdate=function(){PIXI.mesh.Mesh.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},b}(PIXI.mesh.Mesh),V=SAT.V;V.prototype.setLength=function(a){var b=this.getAngle();this.x=Math.cos(b)*a,this.y=Math.sin(b)*a},V.prototype.getLength=function(){return Math.sqrt(this.len2())},V.prototype.setAngle=function(a){var b=this.len();return this.x=Math.cos(a)*b,this.y=Math.sin(a)*b,this},V.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},V.prototype.set=function(a,b){this.x=a,this.y=b},V.addition=function(a,b){return new V(a.x+b.x,a.y+b.y)},V.substruction=function(a,b){return new V(a.x-b.x,a.y-b.y)},function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.prototype=new V,c.prototype.initialize=function(a,b,c,d){this._x=a,this._y=b,this.callback=c||function(){},this.context=d||this,this.originalX=a,this.originalY=b,this.index=-1},c.prototype.set=function(a,b){var c=a||0,d=b||(0!==b?c:0);this._x===c&&this._y===d||(this._x=c,this._y=d,this.callback.call(this.context,this))},Object.defineProperty(c.prototype,"x",{get:function(){return this._x},set:function(a){var b=this._x;this._x=a,b!==a&&this.callback.call(this.context,this)}}),Object.defineProperty(c.prototype,"y",{get:function(){return this._y},set:function(a){var b=this._y;this._y=a,b!==a&&this.callback.call(this.context,this)}}),a.ObservableVector=c}(window);var OV=ObservableVector,BEZIER={};!function(a,b){"use strict";var c=Math.abs,d=Math.cos,e=Math.sin,f=Math.acos,g=Math.atan2,h=Math.sqrt,i=Math.pow,j=function(a){return a<0?-i(-a,1/3):i(a,1/3)},k=Math.PI,l=2*k,m=k/2,n=1e-6,o=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,q={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(a,b){var c=b(a),d=c.x*c.x+c.y*c.y;return void 0!==c.z&&(d+=c.z*c.z),h(d)},between:function(a,b,c){return b<=a&&a<=c||q.approximately(a,b)||q.approximately(a,c)},approximately:function(a,b,d){return c(a-b)<=(d||n)},length:function(a){var b,c,d=.5,e=0,f=q.Tvalues.length;for(b=0;b<f;b++)c=d*q.Tvalues[b]+d,e+=q.Cvalues[b]*q.arcfn(c,a);return d*e},map:function(a,b,c,d,e){return d+(a-b)/(c-b)*(e-d)},lerp:function(a,b,c){var d={x:b.x+a*(c.x-b.x),y:b.y+a*(c.y-b.y)};return b.z&&c.z&&(d.z=b.z+a*(c.z-b.z)),d},pointToString:function(a){var b=a.x+"/"+a.y;return void 0!==a.z&&(b+="/"+a.z),b},pointsToString:function(a){return"["+a.map(q.pointToString).join(", ")+"]"},copy:function(a){return JSON.parse(JSON.stringify(a))},angle:function(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=c.x-a.x,h=c.y-a.y;return g(d*h-e*f,d*f+e*h)},round:function(a,b){var c=""+a,d=c.indexOf(".");return parseFloat(c.substring(0,d+1+b))},dist:function(a,b){var c=a.x-b.x,d=a.y-b.y;return h(c*c+d*d)},closest:function(a,b){var c,d,e=i(2,63);return a.forEach(function(a,f){(d=q.dist(b,a))<e&&(e=d,c=f)}),{mdist:e,mpos:c}},abcratio:function(a,b){if(2!==b&&3!==b)return!1;if(void 0===a)a=.5;else if(0===a||1===a)return a;var d=i(a,b)+i(1-a,b);return c((d-1)/d)},projectionratio:function(a,b){if(2!==b&&3!==b)return!1;if(void 0===a)a=.5;else if(0===a||1===a)return a;var c=i(1-a,b);return c/(i(a,b)+c)},lli8:function(a,b,c,d,e,f,g,h){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);return 0!=k&&{x:i/k,y:j/k}},lli4:function(a,b,c,d){var e=a.x,f=a.y,g=b.x,h=b.y,i=c.x,j=c.y,k=d.x,l=d.y;return q.lli8(e,f,g,h,i,j,k,l)},lli:function(a,b){return q.lli4(a,a.c,b,b.c)},makeline:function(b,c){var d=a.Bezier,e=b.x,f=b.y,g=c.x,h=c.y,i=(g-e)/3,j=(h-f)/3;return new d(e,f,e+i,f+j,e+2*i,f+2*j,g,h)},findbbox:function(a){var b=o,c=o,d=p,e=p;return a.forEach(function(a){var f=a.bbox();b>f.x.min&&(b=f.x.min),c>f.y.min&&(c=f.y.min),d<f.x.max&&(d=f.x.max),e<f.y.max&&(e=f.y.max)}),{x:{min:b,mid:(b+d)/2,max:d,size:d-b},y:{min:c,mid:(c+e)/2,max:e,size:e-c}}},shapeintersections:function(a,b,c,d,e){if(!q.bboxoverlap(b,d))return[];var f=[],g=[a.startcap,a.forward,a.back,a.endcap],h=[c.startcap,c.forward,c.back,c.endcap];return g.forEach(function(b){b.virtual||h.forEach(function(d){if(!d.virtual){var g=b.intersects(d,e);g.length>0&&(g.c1=b,g.c2=d,g.s1=a,g.s2=c,f.push(g))}})}),f},makeshape:function(a,b,c){var d=b.points.length,e=a.points.length,f=q.makeline(b.points[d-1],a.points[0]),g=q.makeline(a.points[e-1],b.points[0]),h={startcap:f,forward:a,back:b,endcap:g,bbox:q.findbbox([f,a,b,g])},i=q;return h.intersections=function(a){return i.shapeintersections(h,h.bbox,a,a.bbox,c)},h},getminmax:function(a,b,c){if(!c)return{min:0,max:0};var d,e,f=o,g=p;-1===c.indexOf(0)&&(c=[0].concat(c)),-1===c.indexOf(1)&&c.push(1);for(var h=0,i=c.length;h<i;h++)d=c[h],e=a.get(d),e[b]<f&&(f=e[b]),e[b]>g&&(g=e[b]);return{min:f,mid:(f+g)/2,max:g,size:g-f}},align:function(a,b){var c=b.p1.x,f=b.p1.y,h=-g(b.p2.y-f,b.p2.x-c),i=function(a){return{x:(a.x-c)*d(h)-(a.y-f)*e(h),y:(a.x-c)*e(h)+(a.y-f)*d(h)}};return a.map(i)},roots:function(a,b){b=b||{p1:{x:0,y:0},p2:{x:1,y:0}};var c=a.length-1,e=q.align(a,b),g=function(a){return 0<=a&&a<=1};if(2===c){var i=e[0].y,k=e[1].y,m=e[2].y,n=i-2*k+m;if(0!==n){var o=-h(k*k-i*m),p=-i+k,r=-(o+p)/n;return[r,-(-o+p)/n].filter(g)}return k!==m&&0===n?[(2*k-m)/2*(k-m)].filter(g):[]}var s,r,t,u,v,w=e[0].y,x=e[1].y,y=e[2].y,z=e[3].y,n=3*x-w-3*y+z,i=(3*w-6*x+3*y)/n,k=(-3*w+3*x)/n,m=w/n,e=(3*k-i*i)/3,A=e/3,B=(2*i*i*i-9*i*k+27*m)/27,C=B/2,D=C*C+A*A*A;if(D<0){var E=-e/3,F=E*E*E,G=h(F),H=-B/(2*G),I=H<-1?-1:H>1?1:H,J=f(I),K=j(G),L=2*K;return t=L*d(J/3)-i/3,u=L*d((J+l)/3)-i/3,v=L*d((J+2*l)/3)-i/3,[t,u,v].filter(g)}if(0===D)return s=C<0?j(-C):-j(C),t=2*s-i/3,u=-s-i/3,[t,u].filter(g);var M=h(D);return s=j(-C+M),r=j(C+M),[s-r-i/3].filter(g)},droots:function(a){if(3===a.length){var b=a[0],c=a[1],d=a[2],e=b-2*c+d;if(0!==e){var f=-h(c*c-b*d),g=-b+c;return[-(f+g)/e,-(-f+g)/e]}return c!==d&&0===e?[(2*c-d)/(2*(c-d))]:[]}if(2===a.length){var b=a[0],c=a[1];return b!==c?[b/(b-c)]:[]}},inflections:function(a){if(a.length<4)return[];var b=q.align(a,{p1:a[0],p2:a.slice(-1)[0]}),c=b[2].x*b[1].y,d=b[3].x*b[1].y,e=b[1].x*b[2].y,f=b[3].x*b[2].y,g=18*(-3*c+2*d+3*e-f),h=18*(3*c-d-3*e),i=18*(e-c);if(q.approximately(g,0)){if(!q.approximately(h,0)){var j=-i/h;if(0<=j&&j<=1)return[j]}return[]}var k=h*h-4*g*i,l=Math.sqrt(k),f=2*g;return q.approximately(f,0)?[]:[(l-h)/f,-(h+l)/f].filter(function(a){return 0<=a&&a<=1})},bboxoverlap:function(a,b){var d,e,f,g,h,i=["x","y"],j=i.length;for(d=0;d<j;d++)if(e=i[d],f=a[e].mid,g=b[e].mid,h=(a[e].size+b[e].size)/2,c(f-g)>=h)return!1;return!0},expandbox:function(a,b){b.x.min<a.x.min&&(a.x.min=b.x.min),b.y.min<a.y.min&&(a.y.min=b.y.min),b.z&&b.z.min<a.z.min&&(a.z.min=b.z.min),b.x.max>a.x.max&&(a.x.max=b.x.max),b.y.max>a.y.max&&(a.y.max=b.y.max),b.z&&b.z.max>a.z.max&&(a.z.max=b.z.max),a.x.mid=(a.x.min+a.x.max)/2,a.y.mid=(a.y.min+a.y.max)/2,a.z&&(a.z.mid=(a.z.min+a.z.max)/2),a.x.size=a.x.max-a.x.min,a.y.size=a.y.max-a.y.min,a.z&&(a.z.size=a.z.max-a.z.min)},pairiteration:function(a,b,c){var d=a.bbox(),e=b.bbox(),f=1e5,g=c||.5;if(d.x.size+d.y.size<g&&e.x.size+e.y.size<g)return[(f*(a._t1+a._t2)/2|0)/f+"/"+(f*(b._t1+b._t2)/2|0)/f];var h=a.split(.5),i=b.split(.5),j=[{left:h.left,right:i.left},{left:h.left,right:i.right},{left:h.right,right:i.right},{left:h.right,right:i.left}];j=j.filter(function(a){return q.bboxoverlap(a.left.bbox(),a.right.bbox())});var k=[];return 0===j.length?k:(j.forEach(function(a){k=k.concat(q.pairiteration(a.left,a.right,g))}),k=k.filter(function(a,b){return k.indexOf(a)===b}))},getccenter:function(a,b,c){var f,h=b.x-a.x,i=b.y-a.y,j=c.x-b.x,k=c.y-b.y,n=h*d(m)-i*e(m),o=h*e(m)+i*d(m),p=j*d(m)-k*e(m),r=j*e(m)+k*d(m),s=(a.x+b.x)/2,t=(a.y+b.y)/2,u=(b.x+c.x)/2,v=(b.y+c.y)/2,w=s+n,x=t+o,y=u+p,z=v+r,A=q.lli8(s,t,w,x,u,v,y,z),B=q.dist(A,a),C=g(a.y-A.y,a.x-A.x),D=g(b.y-A.y,b.x-A.x),E=g(c.y-A.y,c.x-A.x);return C<E?((C>D||D>E)&&(C+=l),C>E&&(f=E,E=C,C=f)):E<D&&D<C?(f=E,E=C,C=f):E+=l,A.s=C,A.e=E,A.r=B,A}};a.utils=q}(BEZIER),function(a,b){"use strict";function c(a,b,c,d,e){void 0===e&&(e=.5);var f=k.projectionratio(e,a),g=1-f,h={x:f*b.x+g*d.x,y:f*b.y+g*d.y},i=k.abcratio(e,a);return{A:{x:c.x+(c.x-h.x)/i,y:c.y+(c.y-h.y)/i},B:c,C:h}}var d=Math.abs,e=Math.min,f=Math.max,g=Math.acos,h=Math.sqrt,i=Math.PI,j={x:0,y:0,z:0},k=a.utils,l=a.PolyBezier,m=function(a){var b=a&&a.forEach?a:[].slice.call(arguments),c=!1;if(this.points=[],this.a=b[0],this.b=b[1],this.c=b[2],this.d=b[3],this.precision=100,this.calculateArcs(),"object"==typeof b[0]){c=b.length;var e=[],f=[];b.forEach(function(a){["x","y","z"].forEach(function(b){void 0!==a[b]&&e.push(a[b])}),f.push(a)}),b=e,this.points=f}var g=!1,h=b.length;if(c){if(c>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");g=!0}}else if(6!==h&&8!==h&&9!==h&&12!==h&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var i=!g&&(9===h||12===h)||a&&a[0]&&void 0!==a[0].z;this._3d=i,this.order=this.points.length-1;var j=["x","y"];i&&j.push("z"),this.dims=j,this.dimlen=j.length,function(a){for(var b=a.order,c=a.points,e=k.align(c,{p1:c[0],p2:c[b]}),f=0;f<e.length;f++)if(d(e[f].y)>1e-4)return void(a._linear=!1);a._linear=!0}(this),this._t1=0,this._t2=1,this.update()};m.fromSVG=function(a){var b=a.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat);return/[cq]/.test(a)?(b=b.map(function(a,c){return c<2?a:a+b[c%2]}),new m(b)):new m(b)},m.quadraticFromPoints=function(a,b,d,e){if(void 0===e&&(e=.5),0===e)return new m(b,b,d);if(1===e)return new m(a,b,b);var f=c(2,a,b,d,e);return new m(a,f.A,d)},m.cubicFromPoints=function(a,b,d,e,f){void 0===e&&(e=.5);var g=c(3,a,b,d,e);void 0===f&&(f=k.dist(b,g.C));var h=f*(1-e)/e,i=k.dist(a,d),j=(d.x-a.x)/i,l=(d.y-a.y)/i,n=f*j,o=f*l,p=h*j,q=h*l,r={x:b.x-n,y:b.y-o},s={x:b.x+p,y:b.y+q},t=g.A,u={x:t.x+(r.x-t.x)/(1-e),y:t.y+(r.y-t.y)/(1-e)},v={x:t.x+(s.x-t.x)/e,y:t.y+(s.y-t.y)/e},w={x:a.x+(u.x-a.x)/e,y:a.y+(u.y-a.y)/e},x={x:d.x+(v.x-d.x)/(1-e),y:d.y+(v.y-d.y)/(1-e)};return new m(a,w,x,d)};var n=function(){return k};m.getUtils=n,m.prototype={getUtils:n,valueOf:function(){return this.toString()},toString:function(){return k.pointsToString(this.points)},toSVG:function(a){if(this._3d)return!1;for(var b=this.points,c=b[0].x,d=b[0].y,e=["M",c,d,2===this.order?"Q":"C"],f=1,g=b.length;f<g;f++)e.push(b[f].x),e.push(b[f].y);return e.join(" ")},update:function(){this.dpoints=[];for(var a=this.points,b=a.length,c=b-1;b>1;b--,c--){for(var d,e=[],f=0;f<c;f++)d={x:c*(a[f+1].x-a[f].x),y:c*(a[f+1].y-a[f].y)},this._3d&&(d.z=c*(a[f+1].z-a[f].z)),e.push(d);this.dpoints.push(e),a=e}this.computedirection(),this.calculateArcs()},computedirection:function(){var a=this.points,b=k.angle(a[0],a[this.order],a[1]);this.clockwise=b>0},length:function(){return k.length(this.derivative.bind(this))},_lut:[],getLUT:function(a){if(a=a||100,this._lut.length===a)return this._lut;this._lut=[];for(var b=0;b<=a;b++)this._lut.push(this.compute(b/a));return this._lut},on:function(a,b){b=b||5;for(var c,d=this.getLUT(),e=[],f=0,g=0;g<d.length;g++)c=d[g],k.dist(c,a)<b&&(e.push(c),f+=g/d.length);return!!e.length&&(f/=e.length)},project:function(a){var b=this.getLUT(),c=b.length-1,d=k.closest(b,a),e=d.mdist,f=d.mpos;if(0===f||f===c){var g=f/c,h=this.compute(g);return h.t=g,h.d=e,h}var i,g,j,l,m=(f-1)/c,n=(f+1)/c,o=.1/c;for(e+=1,g=m,i=g;g<n+o;g+=o)j=this.compute(g),(l=k.dist(a,j))<e&&(e=l,i=g);return j=this.compute(i),j.t=i,j.d=e,j},get:function(a){return this.compute(a)},point:function(a){return this.points[a]},compute:function(a){if(0===a)return this.points[0];if(1===a)return this.points[this.order];var b=this.points,c=1-a;if(1===this.order)return k={x:c*b[0].x+a*b[1].x,y:c*b[0].y+a*b[1].y},this._3d&&(k.z=c*b[0].z+a*b[1].z),k;if(this.order<4){var d,e,f,g=c*c,h=a*a,i=0;2===this.order?(b=[b[0],b[1],b[2],j],d=g,e=c*a*2,f=h):3===this.order&&(d=g*c,e=g*a*3,f=c*h*3,i=a*h);var k={x:d*b[0].x+e*b[1].x+f*b[2].x+i*b[3].x,y:d*b[0].y+e*b[1].y+f*b[2].y+i*b[3].y};return this._3d&&(k.z=d*b[0].z+e*b[1].z+f*b[2].z+i*b[3].z),k}for(var l=JSON.parse(JSON.stringify(this.points));l.length>1;){for(var m=0;m<l.length-1;m++)l[m]={x:l[m].x+(l[m+1].x-l[m].x)*a,y:l[m].y+(l[m+1].y-l[m].y)*a},void 0!==l[m].z&&(l[m]=l[m].z+(l[m+1].z-l[m].z)*a);l.splice(l.length-1,1)}return l[0]},raise:function(){for(var a,b,c,d=this.points,e=[d[0]],f=d.length,a=1;a<f;a++)b=d[a],c=d[a-1],e[a]={x:(f-a)/f*b.x+a/f*c.x,y:(f-a)/f*b.y+a/f*c.y};return e[f]=d[f-1],new m(e)},derivative:function(a){var b,c,d=1-a,e=0,f=this.dpoints[0];2===this.order&&(f=[f[0],f[1],j],b=d,c=a),3===this.order&&(b=d*d,c=d*a*2,e=a*a);var g={x:b*f[0].x+c*f[1].x+e*f[2].x,y:b*f[0].y+c*f[1].y+e*f[2].y};return this._3d&&(g.z=b*f[0].z+c*f[1].z+e*f[2].z),g},inflections:function(){return k.inflections(this.points)},normal:function(a){return this._3d?this.__normal3(a):this.__normal2(a)},__normal2:function(a){var b=this.derivative(a),c=h(b.x*b.x+b.y*b.y);return{x:-b.y/c,y:b.x/c}},__normal3:function(a){var b=this.derivative(a),c=this.derivative(a+.01),d=h(b.x*b.x+b.y*b.y+b.z*b.z),e=h(c.x*c.x+c.y*c.y+c.z*c.z);b.x/=d,b.y/=d,b.z/=d,c.x/=e,c.y/=e,c.z/=e;var f={x:c.y*b.z-c.z*b.y,y:c.z*b.x-c.x*b.z,z:c.x*b.y-c.y*b.x},g=h(f.x*f.x+f.y*f.y+f.z*f.z);f.x/=g,f.y/=g,f.z/=g;var i=[f.x*f.x,f.x*f.y-f.z,f.x*f.z+f.y,f.x*f.y+f.z,f.y*f.y,f.y*f.z-f.x,f.x*f.z-f.y,f.y*f.z+f.x,f.z*f.z];return{x:i[0]*b.x+i[1]*b.y+i[2]*b.z,y:i[3]*b.x+i[4]*b.y+i[5]*b.z,z:i[6]*b.x+i[7]*b.y+i[8]*b.z}},hull:function(a){var b,c=this.points,d=[],e=[],f=0,g=0,h=0;for(e[f++]=c[0],e[f++]=c[1],e[f++]=c[2],3===this.order&&(e[f++]=c[3]);c.length>1;){for(d=[],g=0,h=c.length-1;g<h;g++)b=k.lerp(a,c[g],c[g+1]),e[f++]=b,d.push(b);c=d}return e},split:function(a,b){if(0===a&&b)return this.split(b).left;if(1===b)return this.split(a).right;var c=this.hull(a),d={left:new m(2===this.order?[c[0],c[3],c[5]]:[c[0],c[4],c[7],c[9]]),right:new m(2===this.order?[c[5],c[4],c[2]]:[c[9],c[8],c[6],c[3]]),span:c};return d.left._t1=k.map(0,0,1,this._t1,this._t2),d.left._t2=k.map(a,0,1,this._t1,this._t2),d.right._t1=k.map(a,0,1,this._t1,this._t2),d.right._t2=k.map(1,0,1,this._t1,this._t2),b?(b=k.map(b,a,1,0,1),d.right.split(b).left):d},extrema:function(){var a,b,c=this.dims,d={},e=[];return c.forEach(function(c){b=function(a){return a[c]},a=this.dpoints[0].map(b),d[c]=k.droots(a),3===this.order&&(a=this.dpoints[1].map(b),d[c]=d[c].concat(k.droots(a))),d[c]=d[c].filter(function(a){return a>=0&&a<=1}),e=e.concat(d[c].sort())}.bind(this)),e=e.sort().filter(function(a,b){return e.indexOf(a)===b}),d.values=e,d},bbox:function(){var a=this.extrema(),b={};return this.dims.forEach(function(c){b[c]=k.getminmax(this,c,a[c])}.bind(this)),b},overlaps:function(a){var b=this.bbox(),c=a.bbox();return k.bboxoverlap(b,c)},offset:function(a,b){if(void 0!==b){var c=this.get(a),d=this.normal(a),e={c:c,n:d,x:c.x+d.x*b,y:c.y+d.y*b};return this._3d&&(e.z=c.z+d.z*b),e}if(this._linear){var f=this.normal(0),g=this.points.map(function(b){var c={x:b.x+a*f.x,y:b.y+a*f.y};return b.z&&d.z&&(c.z=b.z+a*f.z),c});return[new m(g)]}return this.reduce().map(function(b){return b.scale(a)})},simple:function(){if(3===this.order){var a=k.angle(this.points[0],this.points[3],this.points[1]),b=k.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&b<0||a<0&&b>0)return!1}var c=this.normal(0),e=this.normal(1),f=c.x*e.x+c.y*e.y;return this._3d&&(f+=c.z*e.z),d(g(f))<i/3},reduce:function(){var a,b,c=0,e=0,f=.01,g=[],h=[],i=this.extrema().values;for(-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1),c=i[0],a=1;a<i.length;a++)e=i[a],b=this.split(c,e),b._t1=c,b._t2=e,g.push(b),c=e;return g.forEach(function(a){for(c=0,e=0;e<=1;)for(e=c+f;e<=1+f;e+=f)if(b=a.split(c,e),!b.simple()){if(e-=f,d(c-e)<f)return[];b=a.split(c,e),b._t1=k.map(c,0,1,a._t1,a._t2),b._t2=k.map(e,0,1,a._t1,a._t2),h.push(b),c=e;break}c<1&&(b=a.split(c,1),b._t1=k.map(c,0,1,a._t1,a._t2),b._t2=a._t2,h.push(b))}),h},scale:function(a){var b=this.order,c=!1;if("function"==typeof a&&(c=a),c&&2===b)return this.raise().scale(c);var d=this.clockwise,e=c?c(0):a,f=c?c(1):a,g=[this.offset(0,10),this.offset(1,10)],i=k.lli4(g[0],g[0].c,g[1],g[1].c);if(!i)throw new Error("cannot scale this curve. Try reducing it first.");var j=this.points,l=[];return[0,1].forEach(function(a){var c=l[a*b]=k.copy(j[a*b]);c.x+=(a?f:e)*g[a].n.x,c.y+=(a?f:e)*g[a].n.y}.bind(this)),c?([0,1].forEach(function(e){if(2!==this.order||!e){var f=j[e+1],g={x:f.x-i.x,y:f.y-i.y},k=c?c((e+1)/b):a;c&&!d&&(k=-k);var m=h(g.x*g.x+g.y*g.y);g.x/=m,g.y/=m,l[e+1]={x:f.x+k*g.x,y:f.y+k*g.y}}}.bind(this)),new m(l)):([0,1].forEach(function(a){if(2!==this.order||!a){var c=l[a*b],d=this.derivative(a),e={x:c.x+d.x,y:c.y+d.y};l[a+1]=k.lli4(c,e,i,j[a+1])}}.bind(this)),new m(l))},outline:function(a,b,c,d){function e(a,b,c,d,e){return function(f){var g=d/c,h=(d+e)/c,i=b-a;return k.map(f,0,1,a+g*i,a+h*i)}}b=void 0===b?a:b;var f,g=this.reduce(),h=g.length,i=[],j=[],m=0,n=this.length(),o=void 0!==c&&void 0!==d;g.forEach(function(f){w=f.length(),o?(i.push(f.scale(e(a,c,n,m,w))),j.push(f.scale(e(-b,-d,n,m,w)))):(i.push(f.scale(a)),j.push(f.scale(-b))),m+=w}),j=j.map(function(a){return f=a.points,f[3]?a.points=[f[3],f[2],f[1],f[0]]:a.points=[f[2],f[1],f[0]],a}).reverse();var p=i[0].points[0],q=i[h-1].points[i[h-1].points.length-1],r=j[h-1].points[j[h-1].points.length-1],s=j[0].points[0],t=k.makeline(r,p),u=k.makeline(q,s),v=[t].concat(i).concat([u]).concat(j),w=v.length;return new l(v)},outlineshapes:function(a,b,c){b=b||a;for(var d=this.outline(a,b).curves,e=[],f=1,g=d.length;f<g/2;f++){var h=k.makeshape(d[f],d[g-f],c);h.startcap.virtual=f>1,h.endcap.virtual=f<g/2-1,e.push(h)}return e},intersects:function(a,b){return a?a.p1&&a.p2?this.lineIntersects(a):(a instanceof m&&(a=a.reduce()),this.curveintersects(this.reduce(),a,b)):this.selfintersects(b)},lineIntersects:function(a){var b=e(a.p1.x,a.p2.x),c=e(a.p1.y,a.p2.y),d=f(a.p1.x,a.p2.x),g=f(a.p1.y,a.p2.y),h=this;return k.roots(this.points,a).filter(function(a){var e=h.get(a);return k.between(e.x,b,d)&&k.between(e.y,c,g)})},selfintersects:function(a){var b,c,d,e,f=this.reduce(),g=f.length-2,h=[];for(b=0;b<g;b++)d=f.slice(b,b+1),e=f.slice(b+2),c=this.curveintersects(d,e,a),h=h.concat(c);return h},curveintersects:function(a,b,c){var d=[];a.forEach(function(a){b.forEach(function(b){a.overlaps(b)&&d.push({left:a,right:b})})});var e=[];return d.forEach(function(a){var b=k.pairiteration(a.left,a.right,c);b.length>0&&(e=e.concat(b))}),e},arcs:function(a){a=a||.5;var b=[];return this._iterate(a,b)},_error:function(a,b,c,e){var f=(e-c)/4,g=this.get(c+f),h=this.get(e-f),i=k.dist(a,b),j=k.dist(a,g),l=k.dist(a,h);return d(j-i)+d(l-i)},_iterate:function(a,b){var c,d=0,e=1;do{c=0,e=1;var f,g,h,i,j,l=this.get(d),m=!1,n=!1,o=e,p=1,q=0;do{n=m,i=h,o=(d+e)/2,q++,f=this.get(o),g=this.get(e),h=k.getccenter(l,f,g),h.interval={start:d,end:e};if(m=this._error(h,l,d,e)<=a,j=n&&!m,j||(p=e),m){if(e>=1){h.interval.end=p=1,i=h;break}e+=(e-d)/2}else e=o}while(!j&&c<100);if(++c>=100)break;i=i||h,b.push(i),d=p}while(e<1);return b},map:function(a){for(var b=a*this.arcLengths[this.precision],c=0,d=this.precision,e=0;c<d;)e=c+((d-c)/2|0),this.arcLengths[e]<b?c=e+1:d=e;this.arcLengths[e]>b&&e--;var f=this.arcLengths[e];return f===b?e/this.precision:(e+(b-f)/(this.arcLengths[e+1]-f))/this.precision},mx:function(a){return this.x(this.map(a))},my:function(a){return this.y(this.map(a))},x:function(a){return(1-a)*(1-a)*(1-a)*this.a.x+(1-a)*(1-a)*3*a*this.b.x+3*(1-a)*(a*a)*this.c.x+a*a*a*this.d.x},y:function(a){return(1-a)*(1-a)*(1-a)*this.a.y+(1-a)*(1-a)*3*a*this.b.y+3*(1-a)*(a*a)*this.c.y+a*a*a*this.d.y},getEqual:function(a){return{x:this.mx(a),y:this.my(a)}},calculateArcs:function(){this.arcLengths=new Array(this.precision+1),this.arcLengths[0]=0;for(var a=this.x(0),b=this.y(0),c=0,d=1;d<=this.precision;d+=1){var e=this.x(.01*d),f=this.y(.01*d),g=a-e,h=b-f;c+=Math.sqrt(g*g+h*h),this.arcLengths[d]=c,a=e,b=f}this.totalLength=c}},a.Bezier=m}(BEZIER),function(a,b){"use strict";var c=a.utils,d=function(a){this.curves=[],this._3d=!1,a&&(this.curves=a,this._3d=this.curves[0]._3d)};d.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(a){return c.pointsToString(a.points)}).join(", ")+"]"},addCurve:function(a){this.curves.push(a),this._3d=this._3d||a._3d},length:function(){return this.curves.map(function(a){return a.length()}).reduce(function(a,b){return a+b})},curve:function(a){return this.curves[a]},bbox:function(){for(var a=this.curves,b=a[0].bbox(),d=1;d<a.length;d++)c.expandbox(b,a[d].bbox());return b},offset:function(a){var b=[];return this.curves.forEach(function(c){b=b.concat(c.offset(a))}),new d(b)}},a.PolyBezier=d}(BEZIER),function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(a){this.hex_code=a,a>16777215?(this.alpha=a>>>24,this.a=a>>>24):(this.alpha=255,this.a=a>>>255),this.red=a>>16&255,this.green=a>>8&255,this.blue=255&a,this.r=a>>16&255,this.g=a>>8&255,this.b=255&a},c.hex_to_color_32=function(a){return(a>16777215?a>>>24:a>>>255)<<24|(a>>16&255)<<16|(a>>8&255)<<8|255&a},c.get_color_32=function(a,b,c,d){return a<<24|b<<16|c<<8|d},c.hex_to_number=function(a){var a=a.replace("#","0x");return a=PIXI.utils.hex2rgb(a),a=c.get_color_32(1,255*a[0],255*a[1],255*a[2])},a.Color=c}(window),function(window,undefined){function Constraint(a,b,c){this.initialize(a,b,c)}Constraint.prototype.initialize=function(a,b,c){this.value=c||"",this.isValid=!1,this.parent=null,this.parentID=null,this.propertyName=b,this._originalParentID=null,this.children=[],this.evaluatedValue=null,this.object=a,this._isRoot=!0,this.parse(this.value)},Constraint.prototype.parse=function(a){if(this.value=a,this.value){var b=!1,c="";this.isValid=!0;for(var d=0;d<this.value.length;d++){var e=this.value[d];"["===e?(b=!0,c=""):"]"===e?(b=!1,this.parentID=c,this._originalParentID=this.parentID.replace(/\s\s+/g,"")):b&&(c+=e)}}else this.isValid=!1},Constraint.prototype.resolve=function(){var evalString=this.value||"";if(this.parent){var rx=new RegExp("\\["+this._originalParentID+"\\]","g");evalString=evalString.replace(rx,"this.parent")}evalString=evalString.replace(/\.width/g,".w_idth"),evalString=evalString.replace(/\.height/g,".h_eight"),evalString=evalString.replace(/width/g,"this.object._width"),evalString=evalString.replace(/height/g,"this.object._height"),evalString=evalString.replace(/\.w_idth/g,".width"),evalString=evalString.replace(/\.h_eight/g,".height");try{var x=eval("'use strict'; "+evalString);return"number"==typeof x&&(!isNaN(x)&&(this.evaluatedValue=x,!0))}catch(a){return!1}},window.Constraint=Constraint}(window),function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(a){this.screen=a,this.constraints=[],this._import(),this.rebuildDependencyTree(),this.applyValues()},c.prototype._import=function(a){a=a||this.screen.children;for(var b=0;b<a.length;b++){var c=a[b];this.add(c.constraintX),this.add(c.constraintY),this._import(c.children)}},c.prototype.add=function(a){if(a){for(var b=0;b<this.constraints.length;b++){var c=this.constraints[b];if(c.object.id===a.object.id&&c.propertyName===a.propertyName){c.parse(a.value);break}}this.constraints.push(a)}},c.prototype.remove=function(a){for(var b=this.constraints.length-1;b>=0;b--){var c=this.constraints[b];c.object.id===a.object.id&&c.propertyName===a.propertyName&&this.constraints.removeElement(a)}},c.prototype.clear=function(){this.constraints=[]},c.prototype.rebuildDependencyTree=function(){for(var a=0;a<this.constraints.length;a++){var b=this.constraints[a];b.children=[],b.parent=this.screen.findById(b.parentID)}for(var c=0;c<this.constraints.length-1;c++)for(var d=this.constraints[c],a=c+1;a<this.constraints.length;a++){var b=this.constraints[a];d.parent&&d.parent.id===b.object.id&&b.propertyName===d.propertyName?(b.children.push(d),d._isRoot=!1):b.parent&&d.object.id===b.parent.id&&b.propertyName===d.propertyName&&(d.children.push(b),b._isRoot=!1)}},c.prototype.applyValues=function(){for(var a=0;a<this.constraints.length;a++){var b=this.constraints[a];b._isRoot&&(b.resolve(),b.object[b.propertyName]=b.evaluatedValue,this._applyValues(b.children))}},c.prototype._applyValues=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.resolve(),c.object[c.propertyName]=c.evaluatedValue,this._applyValues(c.children)}},a.Constraints=c}(window),function(a,b){function c(){this.initialize()}c.prototype.initialize=function(){},c.set=function(a,b,c){c=c||90;var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toUTCString();document.cookie=a+"="+JSON.stringify(b)+"; "+e},c.get=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return JSON.parse(e.substring(b.length,e.length))}return null},c.delete=function(a){c.set(a,"",-100)},a.Cookies=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(b){this.app=b,this.isMobile=PIXI.utils.isMobile,this.isTouch=!1,this.isIE=!1,this.isFullScreen=!1,this.readTouchDevice(),this.readIE(),this.calculateSizes();var c=this;a.addEventListener("webkitfullscreenchange",function(a){c.fullscreenCallback()}),a.addEventListener("mozfullscreenchange",function(a){c.fullscreenCallback()}),a.addEventListener("fullscreenchange",function(a){c.fullscreenCallback()}),a.addEventListener("MSFullscreenChange",function(a){c.fullscreenCallback()}),a.addEventListener("resize",function(a){c.app.resize()})},c.prototype.readTouchDevice=function(){this.isTouch="ontouchstart"in a||navigator.maxTouchPoints},c.prototype.calculateSizes=function(){var a=Config.game_width,b=Config.game_height,c=Config.window_mode,d=this.windowSize();this.app.windowWidth=d.width,this.app.windowHeight=d.height,this.app.canvasWidth=Math.ceil(d.width),this.app.canvasHeight=Math.ceil(d.height);var e=d.width/d.height;if(c===Config.MODE_FLEXIBLE_WIDTH)this.app.height=b,this.app.width=b*e;else if(c===Config.MODE_FLEXIBLE_HEIGHT)this.app.width=a,this.app.height=a/e;else if(c===Config.MODE_STRETCH)this.app.width=a,this.app.height=b;else if(c===Config.MODE_CENTERED){this.app.width=a,this.app.height=b;var f=a/b;e>=a/b?(this.app.canvasWidth=Math.ceil(d.height*f),this.app.canvasHeight=Math.ceil(d.height)):(this.app.canvasWidth=Math.ceil(d.width),this.app.canvasHeight=Math.ceil(d.width/f))}else if(c===Config.MODE_NONE)this.app.canvasWidth=Math.ceil(a),this.app.canvasHeight=Math.ceil(b),this.app.width=a,this.app.height=b;else if(c===Config.MODE_PADDING){var g=Config.canvas_padding.split(" ");this.app.canvasWidth=d.width-Math.round(g[1])-Math.round(g[3]),this.app.canvasHeight=d.height-Math.round(g[0])-Math.round(g[2]);var h=this.app.canvasWidth/this.app.canvasHeight;this.app.width=b*h,this.app.height=b}},c.prototype.windowSize=function(){var b=a,c="inner";return"innerWidth"in a||(c="client",b=document.documentElement||document.body),{width:b[c+"Width"],height:b[c+"Height"]}},c.prototype.readIE=function(){var b=a.navigator.userAgent,c=b.indexOf("MSIE ");if(c>0)return this.isIE=parseInt(b.substring(c+5,b.indexOf(".",c)),10),this.isIE;if(b.indexOf("Trident/")>0){var d=b.indexOf("rv:");return this.isIE=parseInt(b.substring(d+3,b.indexOf(".",d)),10),this.isIE}var e=b.indexOf("Edge/");return e>0?(this.isIE=parseInt(b.substring(e+5,b.indexOf(".",e)),10),this.isIE):(this.isIE=!1,this.isIE)},c.prototype.goFullScreen=function(){if(!this.isFullScreen){this.isFullScreen=!0;var a=document.body;a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}},c.prototype.canGoFullScreen=function(){var a=document.body;return!!a.requestFullscreen||(!!a.msRequestFullscreen||(!!a.mozRequestFullScreen||!!a.webkitRequestFullscreen))},c.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},c.prototype.fullscreenCallback=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?this.isFullScreen=!0:this.isFullScreen=!1},a.Device=c}(window),function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.prototype.initialize=function(a,b,c,d){this.emissionPoint=a,this.layer=b,this.particleClass=c,this.frequency=d,this.timePassed=0,this.particlesCount=0,this.freeParticles=[],this.isRunning=!1},c.prototype.reset=function(){this.timePassed=0,this.particlesCount=0},c.prototype.getParticle=function(){if(0===this.freeParticles.length){var a=new this.particleClass;a.emitter=this,this.freeParticles.push(a)}return this.freeParticles.pop()},c.prototype.recycleParticle=function(a){a.removeFromParent(),this.freeParticles.push(a)},c.prototype.start=function(){this.isRunning||(this.isRunning=!0,Actions.add(this))},c.prototype.run=function(){this.isRunning||(this.isRunning=!0,Actions.add(this))},c.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,Actions.remove(this))},c.prototype.step=function(a){this.timePassed+=a;var b=Math.round(this.timePassed*this.frequency),c=b-this.particlesCount;this.particlesCount=b;for(var d=0;d<c;d++){var e=this.getParticle();if(e.reset(),e.position.set(this.emissionPoint.x,this.emissionPoint.y),!this.layer)throw"Please set the layer for the particle engine,better do that in the 'on_added_to_parent()' method";this.layer.addChild(e),e.onEmmitted(this.layer)}},a.Emitter=c}(window),Array.matrix=function(a,b,c){var d,e,f,g=[];for(e=0;e<a;e+=1){for(d=[],f=0;f<b;f+=1)d[f]=c;g[e]=d}return g},Math.getDistance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))},Math.getAngle=function(a,b){return null===a||null===b?0:Math.atan2(b.y-a.y,b.x-a.x)},Math.getAngleBetween3Points=function(a,b,c){var d=a.x-b.x,e=a.y-b.y,f=c.x-b.x,g=c.y-b.y,h=Math.atan2(e,d);return Math.atan2(g,f)-h},Math.findAngleBetween3Points=function(a,b,c){var d=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)),e=Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2)),f=Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2));return Math.acos((e*e+d*d-f*f)/(2*e*d))},Math.getNextPoint=function(a,b,c){return{x:Math.cos(c*Math.PI/180)*b+a.x,y:Math.sin(c*Math.PI/180)*b+a.y}},Math.isPointInSegment=function(a,b,c){return((c.y-a.y)*(b.x-a.x)).toFixed(0)===((b.y-a.y)*(c.x-a.x)).toFixed(0)&&(a.x>b.x&&b.x>c.x||a.x<b.x&&b.x<c.x)&&(a.y>=b.y&&b.y>=c.y||a.y<=b.y&&b.y<=c.y)},Math.findShortestDistanceToSegment=function(a,b,c){return distToSegment(a,b,c)},Math.findPerpendicularPoint=function(a,b,c){var d=(c.y-b.y)*(a.x-b.x)-(c.x-b.x)*(a.y-b.y),e=Math.pow(c.y-b.y,2)+Math.pow(c.x-b.x,2),f=d/e,g=a.x-f*(c.y-b.y),h=a.y+f*(c.x-b.x);return new V(g,h)},Math.insertionSort=function(a,b){for(var c,d,e=0;e<a.length;++e){for(d=a[e],c=e-1;c>=0&&b(a[c],d);--c)a[c+1]=a[c];a[c+1]=d}},Math.bubbleSort=function(a,b){var c;do{c=!1;for(var d=0;d<a.length-1;d++)if(b(a[d],a[d+1])){var e=a[d];a[d]=a[d+1],a[d+1]=e,c=!0}}while(c)},String.prototype.hashCode=function(){if(Array.prototype.reduce)return"hash"+this.split("").reduce(function(a,b){return(a=(a<<5)-a+b.charCodeAt(0))&a},0);var a=0;if(0===this.length)return a;for(var b=0;b<this.length;b++){a=(a<<5)-a+this.charCodeAt(b),a&=a}return"hash"+a},Math.degreesToRadians=function(a){return a/180*Math.PI},Math.radiansToDegrees=function(a){return 180*a/Math.PI},Math.randomFloat=function(a,b){return a+Math.random()*(b-a)},Math.randomInt=function(a,b){return Math.floor(a+Math.random()*(b-a+1))},Math.inRange=function(a,b,c){return a>=Math.min(b,c)&&a<=Math.max(b,c)},Math.normalize=function(a,b,c){return(a-b)/(c-b)},Math.lerp=function(a,b,c){return(c-b)*a+b},Math.map=function(a,b,c,d,e){return Math.lerp(Math.normalize(a,b,c),d,e)},Math.clamp=function(a,b,c){return Math.min(Math.max(a,Math.min(b,c)),Math.max(b,c))},Math.roundDecimal=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)},String.prototype.startsWith=function(a){return 0===this.indexOf(a)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Math.getLineIntersectionWithPolygon=function(a,b,c,d){void 0===d&&(d=SAT.pool.get());for(var e=c.points.length,f=SAT.pool.get(),g=SAT.pool.get(),h=[],i=0;i<e;i++){i===e-1?(f.copy(c.points[i]),g.copy(c.points[0])):(f.copy(c.points[i]),g.copy(c.points[i+1])),f.add(c.pos),g.add(c.pos);var j=SAT.pool.get();Math.getLineIntersection(a,b,f,g,!0,j)&&h.push(j)}for(var k=-1,l=9999999,i=0;i<h.length;i++){var m=h[i],n=Math.getDistance(a,m);n<l&&(l=n,k=i)}if(k>-1)return d.copy(h[k]),!0},Math.getLineIntersection=function(a,b,c,d,e,f){void 0===e&&(e=!0),void 0===f&&(f=new V);var g=b.y-a.y,h=d.y-c.y,i=a.x-b.x,j=c.x-d.x,k=b.x*a.y-a.x*b.y,l=d.x*c.y-c.x*d.y,m=g*j-h*i;if(0===m)return null;if(f.x=(i*l-j*k)/m,f.y=(h*k-g*l)/m,e){var n=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y),o=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/n,p=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/n;return o>=0&&o<=1&&p>=0&&p<=1?f:null}return f},Object.defineProperty(Array.prototype,"removeElement",{enumerable:!1,value:function(a){for(var b=0,c=0;c<this.length;c++)this[c]===a&&(this.splice(c,1),b++,c--);return b}}),Object.defineProperty(Array.prototype,"getRandom",{enumerable:!1,value:function(){return this[Math.randomInt(0,this.length-1)]}});var serialize=function(a,b){var c=[];for(var d in a)if(a.hasOwnProperty(d)){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"==typeof f?serialize(f,e):encodeURIComponent(e)+"="+encodeURIComponent(f))}return c.join("&")};String.prototype.supplant=function(a){return this.replace(/{([^{}]*)}/g,function(b,c){var d=a[c];return"string"==typeof d||"number"==typeof d?d:b})},String.prototype.smartShort=function(a,b){if(b=b||20,0===a)return this.substr(0,b-3)+"...";var c=shorten(this,a,b);return c.length>b?this.smartShort(a-1,b):c},Math.normalizeValue=function(a,b,c){if(a-=b,0===(c-=b))return b;for(a%=c,a+=b;a<b;)a+=c;return a},function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(a){this.inputs=[],this.screen=a,this.content=null},c.prototype.importObjects=function(a,b){this.content=b;for(var c=0;c<a.length;c++){var d=a[c],e=this.unwrapObject(d);e&&b.addChild(e),d.children.length&&this.importChildren(e,d.children)}this.screen.constraints.rebuildDependencyTree(),this.screen.constraints.applyValues();for(var c=0;c<this.inputs.length;c++)this.screen.addTouchable(this.inputs[c])},c.prototype.importChildren=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=this.unwrapObject(e);f instanceof InputField&&this.addInputToParent(f,a),a.addChild(f),e.children.length&&this.importChildren(f,e.children),c.push(f)}return c},c.prototype.addInputToParent=function(a,b){b instanceof InputContent?b.addInput(a):b.parent&&this.addInputToParent(a,b.parent)},c.prototype.unwrapObject=function(a){var b=null;if("ImageObject"===a.type)b=new Sprite(a.imageName),b.enableSensor();else if("LabelObject"===a.type){var c=a.style;b=new Label(c),b.txt=a.txt}else if("ButtonObject"===a.type){var c=a.style;c.imageNormal=a.backgroundName,c.imageSelected=a.backgroundName,c.offsetX=a.properties.offsetX,c.offsetY=a.properties.offsetY,b=new Button(a.txt,c,Button.TYPE_NINE_SLICE),b.background.setSize(a.properties.width,a.properties.height),0===Math.round(a.properties.sensorWidth)?b.setSensorSize(a.properties.width,a.properties.height):b.setSensorSize(a.properties.sensorWidth,a.properties.sensorHeight),b.label.rotation=a.properties.labelRotation,this.inputs.push(b)}else if("Layer"===a.type)a.isInputContent?(b=new InputContent(this.screen),this.inputs.push(b)):b=new Layer,b.name=a.name,b.factor=Number(a.factor);else if("InputObject"===a.type){var c=a.style;c.background=a.backgroundName,b=new InputField(c,InputField.TYPE_ALL),b.setSize(a.properties.width,a.properties.height),b.hasNext=a.properties.hasNext,a.properties.hasPlaceholder&&b.setPlaceholder(a.txt)}else"GenericObject"===a.type?(b=new Sprite,b.enableSensor()):"ContainerObject"===a.type&&(b=new Sprite,b.enableSensor());return b.position.set(a.position.x,a.position.y),b.anchor&&b.anchor.set(a.anchor.x,a.anchor.y),b.scale.set(a.scale.x,a.scale.y),b.tag=a.tag,b.zIndex=a.zIndex,b.rotation=a.rotation,b.alpha=a.alpha,b.id=a.id,a.constraintX&&(b.constraintX=new Constraint(b,"x",a.constraintX),this.screen.constraints.add(b.constraintX)),a.constraintY&&(b.constraintY=new Constraint(b,"y",a.constraintY),this.screen.constraints.add(b.constraintY)),b},a.Importer=c}(window),function(a,b){function c(){throw"can't initialize Layout"}c.hbox=function(a,b,c,d,e,f,g,h,i){e=e||10,f=f||"bottom",c=c||0,d=d||0,g=void 0===g||g,b=b||800,h=h||e;for(var j=e,k=e,l=0,m=0,n=0;n<a.length;n++)l=Math.max(l,a[n].__height);for(var o=0,n=0;n<a.length;n++){var p=a[n];g&&j+p.__width+e>b&&(j=e,k+=l+h),"bottom"===f?m=l-p.__height:"center"===f&&(m=(l-p.__height)/2);var q=null;i&&(q=i(p)),q&&q.spacing&&(j+=q.spacing),p.position.set(j+c,k+m+d),j+=p.__width+e,o=j>o?j:o,q&&q.is_break&&(j=e,k+=l+h)}return{width:o,height:k+m+l+h}},a.Layout=c}(window),function(a,b){function c(){this.initialize()}var d=null;c.prototype.initialize=function(){this.text={},this.load()},c.prototype.load=function(){var a=ContentManager.files[Config.lang];if(a)for(var b=a.split("\n"),c=0;c<b.length;c++){var d=b[c],e=d.match(/"(?:[^"\\]|\\.)*"/g);if(e&&2===e.length){var f=e[0].replace(/\"/g,""),g=e[1].replace(/\\"/g,"secrtquots");g=g.replace(/\"/g,""),g=g.replace(/secrtquots/g,'"'),g=g.replace(/\\n/g,"\n"),this.text[f]=g}}},c.instance=function(){return null===d&&(d=new c),d},a.Localization=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(a){this.playlist=a||[],this.now_playing=null,this.randomize=!1,this.current_playing_index=-1,this.is_paused=!1,this.is_stoped=!0},c.prototype.add=function(a,b){b=b||1,this.playlist.push({song:a,volume:b})},c.prototype.play=function(){if(this.is_stoped||this.is_paused){if(this.now_playing){this.now_playing.play();var a=this.playlist[this.current_playing_index];return this.now_playing.fade(0,a.volume,200),this.is_paused=!1,void(this.is_stoped=!1)}var b=0;this.stop(),b=this.randomize?Math.randomInt(0,this.playlist.length-1):++this.current_playing_index%this.playlist.length,this.current_playing_index=b;var a=this.playlist[b];a.song.volume(a.volume).play(),this.now_playing=a.song;var c=this;this.now_playing.once("end",function(){timeout(function(a){a.next()},100,c)}),this.is_paused=!1,this.is_stoped=!1}},c.prototype.next=function(){if(this.now_playing){var a=0;this.stop(),a=this.randomize?Math.randomInt(0,this.playlist.length-1):++this.current_playing_index%this.playlist.length,this.current_playing_index=a;var b=this.playlist[a];b.song.volume(b.volume).play(),this.now_playing=b.song;var c=this;this.now_playing.once("end",function(){c.next()}),this.is_paused=!1,this.is_stoped=!1}else this.play()},c.prototype.stop=function(){this.now_playing&&(this.now_playing.stop(),this.now_playing=null),this.is_stoped=!0,this.is_paused=!1},c.prototype.pause=function(){this.now_playing&&this.now_playing.pause(),this.is_paused=!0,this.is_stoped=!1},a.Playlist=c}(window),function(a,b){function c(){throw"can't initialize Action"}c.actions=[],c.isPaused=!1,c.add=function(a){-1===this.actions.indexOf(a)&&(this.actions.push(a),a.step(0))},c.remove=function(a){this.actions.removeElement(a)},c.pause=function(){c.isPaused=!0},c.resume=function(){c.isPaused=!1},c.stopAll=function(){c.actions=[]},c.stopByTag=function(a){for(var b=c.actions.length-1;b>=0;b--)c.actions[b]&&a===c.actions[b].tag&&c.actions[b].stop()},c.isRunning=function(a){for(var b=c.actions.length;b>=0;b--)if(c.actions[b]&&a===c.actions[b].tag)return!0;return!1},c.update=function(a){if(!c.isPaused)for(var b=this.actions.length,d=b-1;d>=0;d--)this.actions[d].isPaused||this.actions[d].step(a)},a.Actions=c}(window),function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.prototype.initialize=function(a,b,c,d){this.mX1=a,this.mY1=b,this.mX2=c,this.mY2=d},c.prototype.A=function(a,b){return 1-3*b+3*a},c.prototype.B=function(a,b){return 3*b-6*a},c.prototype.C=function(a){return 3*a},c.prototype.GetSlope=function(a,b,c){return 3*this.A(b,c)*a*a+2*this.B(b,c)*a+this.C(b)},c.prototype.CalcBezier=function(a,b,c){return((this.A(b,c)*a+this.B(b,c))*a+this.C(b))*a},c.prototype.get=function(a){return this.mX1===this.mY1&&this.mX2===this.mY2?a:this.CalcBezier(this.GetTForX(a),this.mY1,this.mY2)},c.prototype.GetTForX=function(a){for(var b=a,c=0;c<4;++c){var d=this.GetSlope(b,this.mX1,this.mX2);if(0===d)return b;b-=(this.CalcBezier(b,this.mX1,this.mX2)-a)/d}return b},a.Bezier=c}(window),function(a,b){function c(){this.initialize()}c.prototype.initialize=function(a,b,c,d,e,f){this.object=a,this.to=b,this.bezier=c,this.duration=d,this.callback=e||function(){},this._cycleCallback=function(){},this.context=f||this,this.timePassed=0,this.ticks=0,this.isFinished=!1,this._delay=0,this._name="",this.tag=0,this._repeat=1,this._cycles=0},c.prototype.cycleCallback=function(a,b){return this.context=b||this,this._cycleCallback=a,this},c.prototype.repeat=function(a){return this._repeat=a,this},c.prototype.name=function(a){return this._name=a,this},c.prototype.delay=function(a){return this._delay=a||100,this},c.prototype.start=function(a){return this.run(a)},c.prototype.run=function(a){return this.tag=a,this.isFinished=!1,this._delay?timeout(function(){Actions.add(this)},this._delay,this,this.tag):Actions.add(this),this},c.prototype.stop=function(){return Actions.remove(this),this.timePassed=0,this.ticks=0,this.isFinished=!0,this},c.prototype.pause=function(){return this.isPaused=!0,this},c.prototype.resume=function(){return this.isPaused=!1,this},c.prototype.invokeCallback=function(){this.onCallbackInvoked(this.object,this,this.tag),this.callback.call(this.context,this.object)},c.prototype.onCallbackInvoked=function(a,b,c){},c.prototype.applyValues=function(){},a.Tween=c}(window),function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d){this.parentInitialize(null,null,b,c,d),this.start_value=Config.slow_motion_factor,this.difference=a-this.start_value,this.timePassed=0,this.ticks=0},c.prototype.step=function(a){this.timePassed=this.timePassed+Ticker.step,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;Config.slow_motion_factor=this.start_value+c*this.difference,1===b&&this.ticks>1&&(this.callback(this.object),this.stop())},a.TweenTime=c}(window),function(a,b){function c(a){this.initialize(a)}c.EASE_IN_ELASTIC=0,c.EASE_OUT_ELASTIC=1,c.EASE_IN_OUT_ELASTIC=2,c.EASE_IN_BOUNCE=3,c.EASE_OUT_BOUNCE=4,c.EASE_IN_OUT_BOUNCE=5,c.prototype.initialize=function(a){this.easingFunction=null,this.elasticity=10,a===c.EASE_IN_BOUNCE?this.easingFunction=this.easeInBounce:a===c.EASE_IN_ELASTIC?this.easingFunction=this.easeInElastic:a===c.EASE_IN_OUT_BOUNCE?this.easingFunction=this.easeInOutBounce:a===c.EASE_IN_OUT_ELASTIC?this.easingFunction=this.easeInOutElastic:a===c.EASE_OUT_BOUNCE?this.easingFunction=this.easeOutBounce:a===c.EASE_OUT_ELASTIC&&(this.easingFunction=this.easeOutElastic)},c.prototype.get=function(a){return this.easingFunction(a,0,1,1)},c.prototype.easeInElastic=function(a,b,c,d){var e=0,f=c,g=0;return 0===a?b:1==(a/=d)?b+c:(e||(e=.3*d),f<Math.abs(c)?(f=c,g=e/4):g=e/(2*Math.PI)*Math.asin(c/f),-f*Math.pow(2,this.elasticity*(a-=1))*Math.sin((a*d-g)*(2*Math.PI)/e)+b)},c.prototype.easeOutElastic=function(a,b,c,d){var e=0,f=c,g=0;return 0===a?b:1==(a/=d)?b+c:(e||(e=.3*d),f<Math.abs(c)?(f=c,g=e/4):g=e/(2*Math.PI)*Math.asin(c/f),f*Math.pow(2,-this.elasticity*a)*Math.sin((a*d-g)*(2*Math.PI)/e)+c+b)},c.prototype.easeInOutElastic=function(a,b,c,d){var e=1.70158,f=0,g=c,e=0;return 0===a?b:2==(a/=d/2)?b+c:(f||(f=d*(.3*1.5)),g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g),a<1?g*Math.pow(2,this.elasticity*(a-=1))*Math.sin((a*d-e)*(2*Math.PI)/f)*-.5+b:g*Math.pow(2,-this.elasticity*(a-=1))*Math.sin((a*d-e)*(2*Math.PI)/f)*.5+c+b)},c.prototype.easeInBounce=function(a,b,c,d){return c-this.easeOutBounce(d-a,0,c,d)+b},c.prototype.easeOutBounce=function(a,b,c,d){return(a/=d)<1/2.75?c*(7.5625*a*a)+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},c.prototype.easeInOutBounce=function(a,b,c,d){return a<d/2?.5*this.easeInBounce(2*a,0,c,d)+b:.5*this.easeOutBounce(2*a-d,0,c,d)+.5*c+b},a.Easing=c}(window),function(a,b){function c(a){this.initialize(a)}var d=0;c.prototype.initialize=function(a){this.threads=[],this.isRunning=!1,this.delegate=a,this._countFinishedThreads=0,this.tag=0,this.context=null},c.prototype.setGlobalContext=function(a){this.context=a;for(var b=0;b<this.threads.length;b++)for(var c=this.threads[b],d=0;d<c.length;d++){var e=c[d];e.context=a}},c.prototype.addThread=function(a,e){e=e||"_thread"+d++;for(var f=0,g=[],h=0;h<a.length;h++){var i=a[h];i.length===b?g.push([i]):g.push(i)}for(var h=0;h<g.length;h++){for(var j=0,k=-1,l=0;l<g[h].length;l++){var i=g[h][l];i.duration>j&&(j=i.duration,k=l),i.onCallbackInvoked=c.prototype.delgateCallback.bind(this)}var i=g[h][k];if(i.onCallbackInvoked=c.prototype.onCallback.bind(this),0===i._repeat)throw"You can't run infinite tweens into Sequencer \n(They will never finish and call the next!)";f+=i.duration}var m={tweens:g,tag:e,index:-1,duration:f};return this.threads.push(m),m},c.prototype.delgateCallback=function(a,b,c){this.delegate&&this.delegate.onTweenEnded&&this.delegate.onTweenEnded(b,b._name,c,this)},c.prototype.onCallback=function(a,b,c){this.delgateCallback(a,b,c),this.next(c)},c.prototype.run=function(){this.isRunning||(this.isRunning=!0,this.delegate&&this.delegate.onSequencerStarted&&this.delegate.onSequencerStarted(this));for(var a=0;a<this.threads.length;a++){var b=this.threads[a];b.index++;for(var c=0;c<b.tweens.length;c++)if(b.index===c)for(var d=0;d<b.tweens[c].length;d++){var e=b.tweens[c][d];e.applyValues(),this.delegate&&this.delegate.onTweenStarted&&this.delegate.onTweenStarted(e,e._name,b.tag,this),e.run(b.tag)}}},c.prototype.next=function(a){if(!this.isFinished)for(var b=0;b<this.threads.length;b++){var c=this.threads[b];if(c.tag===a)if(++c.index>=c.tweens.length)this._countFinishedThreads++,this.delegate&&this.delegate.onThreadFinished&&this.delegate.onThreadFinished(c),this._countFinishedThreads===this.threads.length&&this.delegate&&this.delegate.onSequencerFinished&&this.delegate.onSequencerFinished(this);else for(var d=0;d<c.tweens.length;d++)for(var e=0;e<c.tweens[d].length;e++){var f=c.tweens[d][e];c.index===d&&(f.applyValues(),this.delegate&&this.delegate.onTweenStarted&&this.delegate.onTweenStarted(f,f._name,c.tag,this),f.run(c.tag))}}},c.prototype.stop=function(){this.isRunning=!1,this.isFinished=!0;for(var a=0;a<this.threads.length;a++){var b=this.threads[a];Actions.stopByTag(b.tag)}},c.prototype.reset=function(){this.isFinished=!1,this._countFinishedThreads=0;for(var a=0;a<this.threads.length;a++){this.threads[a].index=-1}},a.Sequencer=c}(window),function(a,b){function c(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e,f){this.parentInitialize(c,null,d,b,e,f),this.stepCallback=a},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;1===b&&this.ticks>1?(this.stepCallback.call(this.context,c,this.object,a),this.invokeCallback(),this.stop()):this.stepCallback.call(this.context,c,this.object,a)},a.Stepper=c}(window),function(a,b){function c(a,b,c){this.initialize(a,b,c)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c){this.parentInitialize(null,null,null,b,a,c)},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;1===(b=b>=1?1:b)&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.Timer=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.timePassed=0,this.applyValues()},c.prototype.applyValues=function(){this.startAlpha=this.object.alpha,this.difference=this.to-this.startAlpha},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.alpha=this.startAlpha+c*this.difference,1===b&&(this.invokeCallback(),this.stop())},a.TweenAlpha=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.half=(new V).copy(b).scale(.5),this.begin=(new V).copy(a.position),this._repeat=0},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=new V;b<.25?(c.copy(this.half),c.scale(b/.25),c=V.addition(this.begin,c)):b<.5?(c.copy(this.half),c.reverse(),c.scale((b-.25)/.25),c=V.addition(this.begin,c),c.add(this.half)):b<.75?(c.copy(this.half),c.reverse(),c.scale((b-.5)/.25),c=V.addition(this.begin,c)):(c.copy(this.half),c.scale((b-.75)/.25),c=V.addition(this.begin,c),c.sub(this.half)),this.object.position.set(c.x,c.y),1===b&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenBackForth=c}(window),function(a,b){function c(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e,f){c=c||new Bezier(.26,.66,.32,1.01),this.parentInitialize(a,b,c,d,e,f),this._originalAlpha=a.alpha,this.startAlpha=a.alpha,this.difference=b-this.startAlpha,this._repeat=0},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=0;if(b<.5){var d=b/.5,e=this.bezier?this.bezier.get(d):d;c=this.startAlpha+(this.to-this._originalAlpha)*e}else{var d=(b-.5)/.5,e=this.bezier?this.bezier.get(d):d;c=this.to-(this.to-this._originalAlpha)*e}this.object.alpha=c,1===b&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenBlink=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.magnitude=b,this._repeat=0,this.applyValues()},c.prototype.applyValues=function(){var a=this.object.position;this.startPosition=new V(a.x,a.y)},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b,d=Math.sin(6.283184*c)*this.magnitude;this.object.position.y=d+this.startPosition.y,1===b&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.object.position.y=this.startPosition.y,this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenFloat=c}(window),function(a,b){function c(a,b){this.initialize(a,b)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b){this.parentInitialize(null,null,null,a,b),this.applyValues()},c.prototype.applyValues=function(){},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;1===(b=b>=1?1:b)&&(this.invokeCallback(),this.stop())},a.TweenIdle=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){var a=this.object.position;this.startPosition=new V(a.x,a.y),this.distanceX=this.to.x-a.x,this.distanceY=this.to.y-a.y},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.position.set(this.startPosition.x+this.distanceX*c,this.startPosition.y+this.distanceY*c),1===b&&(this.invokeCallback(),this.stop())},a.TweenMoveTo=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.bezier2=new Easing(Easing.EASE_OUT_ELASTIC),this.nonBouncePercent=.1,this.applyValues()},c.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.startScale-this.to},c.prototype.nonBounce=function(a){return this.nonBouncePercent=a,this},c.prototype.elsticity=function(a){return this.bezier2.elsticity=a,this},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;if((b=b>=1?1:b)<=this.nonBouncePercent){var c=b/this.nonBouncePercent;this.bezier&&(c=this.bezier.get(b/this.nonBouncePercent)),this.object.scale.set(this.startScale+(this.to-this.startScale)*c)}else{var c=(b-this.nonBouncePercent)/(1-this.nonBouncePercent),d=this.bezier2.get(c);this.object.scale.set(this.to+d*this.difference)}1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenPop=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.startScale=a.scale.x,this._repeat=0},c.prototype.step=function(a){this.timePassed+=a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=0;if(b<.5){var d=b/.5,e=this.bezier?this.bezier.get(d):d;c=this.startScale+(this.to-this.startScale)*e}else{var d=(b-.5)/.5,e=this.bezier?this.bezier.get(d):d;c=this.to-(this.to-this.startScale)*e}this.object.scale.set(c),1===b&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenPulsate=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.startAngle=a.rotation,this._repeat=0},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration,c=this.bezier?this.bezier.get(b):b;this.object.rotation=this.startAngle+2*Math.PI*c*this.to,b>=1&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.object.rotation=this.startAngle,this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenRotate=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){this.startAngle=this.object.rotation},c.prototype.step=function(a){this.timePassed+=a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.rotation=this.startAngle+c*this.to,1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenRotateBy=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){this.startAngle=this.object.rotation,this.diffrenece=this.to-this.object.rotation},c.prototype.step=function(a){this.timePassed+=a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.rotation=this.startAngle+c*this.diffrenece,1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenRotateTo=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.to-this.startScale},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.scale.set(this.startScale+c*this.difference),1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenScale=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.to-this.startScale},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.scale.x=this.startScale+c*this.difference,1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenScaleX=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.applyValues()},c.prototype.applyValues=function(){this.startScale=this.object.scale.y,this.difference=this.to-this.startScale},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;this.object.scale.y=this.startScale+c*this.difference,1===b&&this.ticks>1&&(this.invokeCallback(),this.stop())},a.TweenScaleY=c}(window),function(a,b){function c(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e,f){this.parentInitialize(a,null,d,e,f),this.magnitude=b,this.frequency=c||.025,this.applyValues()},c.prototype.applyValues=function(){this.startPoint=(new Vector).copy(this.object.position),this.shakes=0},c.prototype.step=function(a){this.timePassed+=a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=Math.round(this.frequency*this.timePassed)-this.shakes;if(c>0){this.shakes+=c;var d=this.bezier?this.bezier.get(b):1,e=Math.randomInt(0,360),f=SAT.pool.get();f.setLength(this.magnitude*d),f.setAngle(Math.degreesToRadians(e));var g=this.startPoint.clone();g.add(f),this.object.position.set(g.x,g.y)}1===b&&this.ticks>1&&(this.object.position.set(this.startPoint.x,this.startPoint.y),this.invokeCallback(),this.stop())},a.TweenShake=c}(window),function(a,b){function c(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e,f){this.parentInitialize(a,null,d,e,f),this.magnitude=b,this.frequency=c||.025,this.applyValues()},c.prototype.applyValues=function(){this.startPoint=(new V).copy(this.object.position),this.shakes=0,this.isLeft=!1},c.prototype.step=function(a){this.timePassed+=a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=Math.round(this.frequency*this.timePassed)-this.shakes;if(c>0){this.shakes+=c+2e3;var d=0;this.isLeft&&(d=-180),this.isLeft=!this.isLeft;var e=new V;e.setLength(this.magnitude),e.setAngle(Math.degreesToRadians(d));var f=this.startPoint.clone();f.add(e),this.object.position.set(f.x,f.y)}1===b&&this.ticks>1&&(this.object.position.set(this.startPoint.x,this.startPoint.y),this.invokeCallback(),this.stop())},a.TweenShakeX=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.toX=b,this.toY=1-b+1,this.startScale=(new V).copy(a.scale),this._repeat=0},c.prototype.step=function(a){this.timePassed=this.timePassed+a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=1,d=1;if(b<.5){var e=b/.5,f=this.bezier?this.bezier.get(e):e;c=this.startScale.x+(this.toX-this.startScale.x)*f,d=this.startScale.y+(this.toY-this.startScale.y)*f}else{var e=(b-.5)/.5,f=this.bezier?this.bezier.get(e):e;c=this.toX-(this.toX-this.startScale.x)*f,d=this.toY-(this.toY-this.startScale.y)*f}this.object.scale.set(c,d),1===b&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},a.TweenSquashStretch=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){c=c||new Bezier(.34,-.14,.48,.98),this.parentInitialize(a,b,c,d,e),this.duration=d,this.applyValues()},c.prototype.applyValues=function(){this.startScale_x=this.object.scale.x,this.startScale_y=this.object.scale.y},c.prototype.step=function(a){this.timePassed=this.timePassed+a,this.ticks++;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b,d=c-b;this.object.scale.x=this.startScale_x+this.to*d,this.object.scale.y=this.startScale_y-this.to*d,1===b&&(this.invokeCallback(),this.stop())},a.TweenSquashy=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.prototype=new Tween,c.prototype.parentInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d,e){this.parentInitialize(a,b,c,d,e),this.start_tint=new Color(a.tint),this.end_tint=new Color(b),this.timePassed=0},c.prototype.step=function(a){this.timePassed+=a;var b=this.timePassed/this.duration;b=b>=1?1:b;var c=this.bezier?this.bezier.get(b):b;1===b&&(c=.9);var d=(this.end_tint.red-this.start_tint.red)*c+this.start_tint.red,e=(this.end_tint.green-this.start_tint.green)*c+this.start_tint.green,f=(this.end_tint.blue-this.start_tint.blue)*c+this.start_tint.blue;this.object.tint=Color.get_color_32(1,d,e,f),1===b&&(this.callback(this.object),this.stop())},a.TweenTint=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype.initialize=function(a){this.states=a,this.subscribers=[],this.currentState="",this.previousState="",this.initial_state=null,this.indexes={};for(var b=0;b<this.states.length;b++)this.indexes[this.states[b].name]=b,this.states[b].initial&&(this.currentState=this.states[b],this.previousState=this.states[b],this.initial_state=this.currentState);if(!this.initial_state)throw"you must have initial state when configuring a state machine"},c.prototype.go_to_previus_state=function(){this.set(this.previousState.name)},c.prototype.set=function(a,b){if(this.currentState.events[a]){var c=this.currentState;this.previousState=c,this.currentState=this.states[this.indexes[this.currentState.events[a]]];var d=this.subscribers[this.currentState.name];if(d)for(var e=d.length,f=0;f<e;f++)d[f].on_state(c,this.currentState,b)}},c.prototype.get=function(){return this.currentState.name},c.prototype.reset=function(){this.set(this.initial_state.name),this.subscribers=[]},c.prototype.subscribe=function(a,b){if("*"===a)for(var c=0;c<this.states.length;c++){var d=this.states[c].name;this.subscribers[d]||(this.subscribers[d]=[]),this.subscribers[d].push(b)}else this.subscribers[a]||(this.subscribers[a]=[]),this.subscribers[a].push(b)},c.prototype.unsubscribe=function(a,b){var c=this.subscribers[a];if(c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}},c.prototype.get_subscribers=function(){return this.subscribers},c.prototype.unsubscribe_from_all=function(a){for(var b in this.subscribers){var c=this.subscribers[b];if(c){var d=c.indexOf(a);-1!==d&&c.splice(d,1)}}},c.prototype.unsubscribe_all=function(){this.subscribers=[]},a.StateMachine=c}(window),function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.UP=0,c.DOWN=1,c.MOVE=2,c.CANCEL=4,c.UNKNOWN=-1,c.prototype.initialize=function(a,b,c,d){this.propagate=!0,this.isCanceled=!1,this.point=new V(a||0,b||0),this.type=c,this.idx=d},c.prototype.stopPropagation=function(){this.propagate=!1},c.prototype.cancel=function(){this.isCanceled=!0},a.HEvent=c}(window),function(a,b){function c(a,b){this.initialize(a,b)}c.prototype.initialize=function(a,b){this.point={x:0,y:0},this.app=a,this.device=a.device,this.elements=[],this.offset={top:0,left:0},this.element=b,this.lastCursorIcon="",this.addListener(b)},c.prototype.addListener=function(a){this.offset=this.recursiveOffset(a),this.element=a,this.device.isTouch&&!this.device.isMobile?(this.registerTouch(a),this.registerMouse(a)):this.device.isTouch?this.registerTouch(a):this.registerMouse(a)},c.prototype.registerTouch=function(a){var b=this;a.addEventListener("touchmove",function(a){for(var c=0;c<a.changedTouches.length;c++){var d=b.point.x,e=b.point.y;if(b.mapTouchLocation(a.changedTouches[c]),d===b.point.x&&e===b.point.y)return;b.setMouseMove(a.changedTouches[c].identifier)}a.preventDefault(),a.stopPropagation()},!1),a.addEventListener("touchend",function(a){for(var c=0;c<a.changedTouches.length;c++)b.mapTouchLocation(a.changedTouches[c]),b.setMouseUp(a.changedTouches[c].identifier);a.preventDefault(),a.stopPropagation()},!1),a.addEventListener("touchleave",function(a){for(var c=0;c<a.changedTouches.length;c++)b.mapTouchLocation(a.changedTouches[c]),b.setMouseUp(a.changedTouches[c].identifier);a.preventDefault(),a.stopPropagation()},!1),a.addEventListener("touchstart",function(a){for(var c=0;c<a.changedTouches.length;c++)b.mapTouchLocation(a.changedTouches[c]),b.setMouseDown(a.changedTouches[c].identifier);a.preventDefault(),a.stopPropagation()},!1),a.addEventListener("touchcancel",function(a){for(var c=0;c<a.changedTouches.length;c++)b.setMouseCancel(a.changedTouches[c].identifier);a.preventDefault(),a.stopPropagation()},!1)},c.prototype.registerMouse=function(a){var b=this;a.addEventListener("mouseup",function(a){var c=b.getMousePoint(a);b.mapPointLocation(c.x,c.y),1===a.which?b.setMouseUp(1):b.setRightMouseUp()},!1),a.addEventListener("mouseleave",function(a){var c=b.getMousePoint(a);b.mapPointLocation(c.x,c.y),1===a.which?b.setMouseCancel(1):b.setRightMouseUp()},!1),a.addEventListener("mousedown",function(a){var c=b.getMousePoint(a);b.mapPointLocation(c.x,c.y),1===a.which?b.setMouseDown(1):b.setRightMouseDown()},!1),a.addEventListener("mousemove",function(a){var c=b.getMousePoint(a),d=b.point.x,e=b.point.y;b.mapPointLocation(c.x,c.y),d===b.point.x&&e===b.point.y||(1===a.which?b.setMouseMove(1):b.setRightMouseMove())},!1),a.addEventListener("contextmenu",function(a){a.preventDefault()}),a.addEventListener("wheel",function(a){a.preventDefault(),b.setWheel(a.wheelDelta)})},c.prototype.fixWhich=function(a){!a.which&&a.button&&(1&a.button?a.which=1:4&a.button?a.which=2:2&a.button&&(a.which=3))},c.prototype.addElement=function(a){var b=this.elements.indexOf(a);if(!a)throw"can't add undefined value to Input";-1===b&&(this.elements.push(a),a.onInputAdded(),a.enableSensor())},c.prototype.add=function(a){if("[object Array]"===Object.prototype.toString.call(a))for(var b=0;b<a.length;b++){var c=a[b];this.addElement(c)}else this.addElement(a);0!==a._width&&0!==a._height||console.warn("you are trying to add zero size element for a click")},c.prototype.remove=function(a){if("[object Array]"===Object.prototype.toString.call(a))for(var b=0;b<a.length;b++)this.removeElement(a[b]);else this.removeElement(a)},c.prototype.removeElement=function(a){var b=this.elements.indexOf(a);-1!==b&&(this.elements.splice(b,1),a.onInputRemoved())},c.prototype.removeAll=function(){for(var a=0;a<this.elements.length;a++)this.elements[a].onInputRemoved();this.elements=[]},c.prototype.sortInput=function(){Math.insertionSort(this.elements,function(a,b){return a.priority<b.priority})},c.prototype.getMousePoint=function(b){this.fixWhich(b);var c=0,d=0;return b||(b=a.event),b.pageX||b.pageY?(c=b.offsetX?b.offsetX:b.layerX,d=b.offsetY?b.offsetY:b.layerY):(b.clientX||b.clientY)&&(c=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=b.clientY+document.body.scrollTop+document.documentElement.scrollTop),new V(c,d)},c.prototype.mapTouchLocation=function(a){this.mapPointLocation(a.pageX-this.offset.left,a.pageY-this.offset.top)},c.prototype.mapPointLocation=function(a,b){var c=a/this.app.canvasWidth,d=c*this.app.width,e=b/this.app.canvasHeight,f=e*this.app.height;this.point.x=d,this.point.y=f},c.prototype.recalucateOffset=function(){this.offset=this.recursiveOffset(this.element)},c.prototype.recursiveOffset=function(a){for(var b=0,c=0;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{left:b,top:c}},c.prototype.setWheel=function(a){var b=new HEvent(0,a,0,null);this.sortInput();for(var c=0;c<this.elements.length;c++){var d=this.elements[c];if(d){if(!b.propagate)break;d._check(this.point)&&d.onWheel(b,d)}}},c.prototype.setMouseDown=function(a){var b=new HEvent(this.point.x,this.point.y,HEvent.DOWN,a);this.sortInput();for(var c=0;c<this.elements.length;c++){var d=this.elements[c];if(d&&-1===d.eventIdx&&!d.isMouseDown&&d._check(b.point)&&d.isTouchable){if(!b.propagate)break;d.isMouseDown=!0,d.eventIdx=b.idx,d.onMouseDown(b,d),b.isCanceled&&this.setMouseCancel(a)}}},c.prototype.setMouseMove=function(a){for(var b=new HEvent(this.point.x,this.point.y,HEvent.DOWN,a),c=0;c<this.elements.length;c++){var d=this.elements[c];d&&d.eventIdx===a&&d.isMouseDown&&(d.eventIdx=b.idx,d.onMouseMove(b,d),b.isCanceled&&this.setMouseCancel(a))}},c.prototype.setMouseUp=function(a){for(var b=new HEvent(this.point.x,this.point.y,HEvent.UP,a),c=0;c<this.elements.length;c++){var d=this.elements[c];d&&d.eventIdx===a&&d.isMouseDown&&(d._check(b.point)&&b.propagate?(d.isMouseDown=!1,d.eventIdx=-1,d.onMouseUp(b,d)):this.setMouseCancel(a))}},c.prototype.setMouseCancel=function(a){for(var b=0;b<this.elements.length;b++){var c=this.elements[b],d=new HEvent(0,0,HEvent.CANCEL,a);c&&c.eventIdx===a&&(c.eventIdx=-1,c.isMouseDown=!1,c.onMouseCancel(d,c))}},c.prototype.setRightMouseUp=function(a){for(var b=new HEvent(this.point.x,this.point.y,HEvent.UP,a),c=0;c<this.elements.length;c++){var d=this.elements[c];d&&d.eventIdx===a&&d.isMouseDown&&(d._check(b.point)&&b.propagate?(d.isMouseDown=!1,d.eventIdx=-1,d.onRightMouseUp(b,d)):this.setMouseCancel(a))}},c.prototype.setRightMouseDown=function(a){var b=new HEvent(this.point.x,this.point.y,HEvent.DOWN,a);this.sortInput();for(var c=0;c<this.elements.length;c++){var d=this.elements[c];if(d&&-1===d.eventIdx&&!d.isMouseDown&&d._check(b.point)&&d.isTouchable){if(!b.propagate)break;d.isMouseDown=!0,d.eventIdx=b.idx,d.onRightMouseDown(b,d),b.isCanceled&&this.setMouseCancel(a)}}},c.prototype.setRightMouseMove=function(a){for(var b=new HEvent(this.point.x,this.point.y,HEvent.DOWN,a),c=0;c<this.elements.length;c++){var d=this.elements[c];d&&d.eventIdx===a&&d.isMouseDown&&(d.eventIdx=b.idx,d.onRightMouseMove(b,d),b.isCanceled&&this.setMouseCancel(a))}},c.prototype.setCursor=function(a){a!==document.body.style.cursor&&(this.lastCursorIcon=document.body.style.cursor,document.body.style.cursor=a)},c.prototype.restoreCursor=function(){this.lastCursorIcon!==document.body.style.cursor&&(document.body.style.cursor=this.lastCursorIcon)},a.Input=c}(window),function(a,b){function c(a,b,c){this.initialize(a,b,c)}c.prototype.initialize=function(a,b,c){this.queue=[],this.numberOfEvents=0,this.totalTime=0,this.callback=function(){},this.isSingleLoop=b,this.currentTime=c?-c:0,this.currentEventName="",this.previousEventName=null,this.currentPercent=0,this.isFinished=!1,this.delay=c||0;for(var d=0;d<a.length;d++){var e=a[d];"function"==typeof e?this.callback=e:(this.numberOfEvents++,this.totalTime+=e.duration,this.queue.push(e))}},c.prototype.step=function(a){this.update(a)},c.prototype.update=function(a){if(this.isFinished)return!1;this.currentTime+=a,this.currentTime<0&&(null===this.previousEventName?this.previousEventName="":this.previousEventName=this.currentEventName,this.currentEventName="delay",this.currentPercent=(this.delay-Math.abs(this.currentTime))/this.delay);var b=0;if(this.currentTime>this.totalTime){if(this.isSingleLoop)return this.isFinished=!0,void this.callback();this.currentTime-=this.totalTime,this.previousEventName="",this.callback()}for(var c=0;c<this.queue.length;c++){var d=this.queue[c],e=b;if(b+=d.duration,this.currentTime>=e&&this.currentTime<=b){this.previousEventName=this.currentEventName,this.currentEventName=d.name;var f=this.currentTime-e;this.currentPercent=f/d.duration}}},c.prototype.restart=function(){this.isFinished=!1,this.currentTime=-this.delay,this.currentEventName=null,this.currentPercent=0,this.previousEventName=null},c.prototype.goToNext=function(){for(var a=0,b=0;b<this.queue.length;b++){var c=this.queue[b],d=a;if(a+=c.duration,this.currentTime>=d&&this.currentTime<=a){this.queue.length>b+1&&(this.currentTime=a+1,this.currentPercent=0);break}}},c.prototype.get=function(){return{name:this.currentEventName,percent:this.currentPercent,isFirstTime:this.previousEventName!==this.currentEventName}},a.Looper=c}(window),function(a,b){function c(){throw"Can't initialize Notes"}c.listeners={},c.add=function(a,b){if(!a.onNote)throw"the object must implement onNote method in order to recive Notes";c.listeners[b]||(c.listeners[b]=[]),-1===c.listeners[b].indexOf(a)&&c.listeners[b].push(a)},c.remove=function(a,b){if(b){var d=c.listeners[b];if(d){var e=d.indexOf(a);-1!==e&&d.splice(e,1)}}else for(var f in c.listeners){var d=c.listeners[f];if(d){var e=d.indexOf(a);-1!==e&&d.splice(e,1)}}},c.removeAll=function(){c.listeners={}},c.send=function(a,b,d){if(c.listeners[a])for(var e=c.listeners[a],f=0;f<e.length;f++){var g=e[f];g.onNote(a,b,d)}else log("You are tring to send a message for which there are no subscribers :"+a)},a.Notes=c}(window),function(a){var b=function(){throw"cant initialize"};b.baseURL="",b.countLoaded=0,b.countToLoad=0,b.countSoundsToLoad=0,b.countSoundsLoaded=0,b.countProgress=0,b.soundsToLoad=[],b.hasError=!1,b.callback=function(){},b.context=null,b.spine={},b.files={},b.jsons={},b.isSoundLoaded=!0,b.isResourcesLoaded=!0,b.onProgress=function(a,c){if(b.countLoaded++,b.countProgress++,c.type===PIXI.loaders.Resource.TYPE.IMAGE)Images[c.name]=c;else if(c.data&&c.data.bones)b.spine[c.name]=c;else if(c.type===PIXI.loaders.Resource.TYPE.JSON)b.jsons[c.name]=c.data;else if(c.url.endsWith(".ttf")){var d=new Font;d.fontFamily=c.name,d.src=c.url,d.format="embedded-opentype",Fonts[c.name]=d}else c.url.endsWith(".fnt")||(b.files[c.name]=c.data)},b.onComplete=function(){b.isResourcesLoaded=!0,b.isSoundLoaded&&(b.countLoaded=0,b.countToLoad=0,b.countSoundsLoaded=0,b.countSoundsToLoad=0,b.countProgress=0,b.soundsToLoad=[],b.callback.call(b.context,b.hasError))},b.setLoader=function(){b.loader=PIXI.loader,b.loader.on("progress",function(a,c){b.onProgress(a,c)}).on("error",function(){b.hasError=!0}).on("complete",function(){b.onComplete()})},b.addImage=function(a,c,d){b.loader.resources[a]||(d||(c?c.startsWith("http")||(c=c.startsWith("../")?b.baseURL+c:b.baseURL+"assets/images/"+c):c=b.baseURL+"assets/images/"+a+".png"),b.loader.add(a,c,{crossOrigin:!0}),b.countToLoad++,b.isResourcesLoaded=!1)},b.addFile=function(a,c){c=b.baseURL+c,b.loader.add(a,c),b.countToLoad++,b.isResourcesLoaded=!1},b.addSound=function(a,c){if(Howler.noAudio)return void(Sounds[a]={play:function(){return this},volume:function(){return this},_volume:1,once:function(){}});for(var d=0;d<c.length;d++){var e=c[d];e.startsWith("data:")||(c[d]=b.baseURL+e)}b.soundsToLoad[a]=c,b.countToLoad++,b.countSoundsToLoad++,b.isSoundLoaded=!1},b.addSpine=function(a){this.loader.add(a,b.baseURL+"assets/spine/"+a+".json"),b.isResourcesLoaded=!1,b.countToLoad+=3},b.addAtlas=function(a){var c=b.baseURL+"assets/images/atlases/"+a+".json";b.loader.add(a,c),b.countToLoad+=2,b.isResourcesLoaded=!1},b.addFont=function(a,c){b.loader.add(a,b.baseURL+c),b.countToLoad++,b.isResourcesLoaded=!1},b.addBitmapFont=function(a,c){b.loader.add(a,b.baseURL+c),b.countToLoad+=2,b.isResourcesLoaded=!1},b.addAudio=function(a,c){if(Howler.noAudio)return void(Sounds[a]={play:function(){return this},volume:function(){return this},_volume:1,once:function(){}});for(var d=0;d<c.length;d++){var e=c[d];e.startsWith("data:")||(c[d]=b.baseURL+e)}var f=new Howl({src:c,onload:function(){},onloaderror:function(){}});Sounds[a]=f},b.downloadResources=function(a,c){b.callback=a,b.context=c,b.hasError=!1;for(var d in b.soundsToLoad){var e=b.soundsToLoad[d],f=new Howl({src:e,onload:function(){b.countLoaded++,b.countSoundsLoaded++,b.countSoundsToLoad===b.countSoundsLoaded&&(b.isSoundLoaded=!0,b.soundsToLoad=[]),b.countToLoad===b.countLoaded&&b.isResourcesLoaded&&b.onComplete()},onloaderror:function(a){log("Error loading: "+d),log(a),b.hasError=!0,b.countLoaded++,b.countSoundsLoaded++,b.countToLoad===b.countLoaded&&b.isResourcesLoaded&&b.onComplete()},buffer:!0});Sounds[d]=f}b.loader.load(),0===b.countToLoad&&0===b.countLoaded&&b.onComplete()},b.readBaseURL=function(){var a=document.URL;if(a.indexOf("localhost")>0){var c=a.lastIndexOf("/"),d=a.substring(0,c);b.baseURL=d+"/"}else b.baseURL="";Config.baseURL&&(b.baseURL=Config.baseURL)},b.readBaseURL(),b.setLoader(),a.ContentManager=b}(window),function(a,b){function c(){throw"Can't initialize fonts"}a.Fonts=c}(window),function(a,b){function c(){throw"Can't initialize images"}a.Images=c}(window),function(a,b){function c(){throw"cant initialize sounds"}a.Sounds=c}(window),function(a,b){function c(a){this.initialize(a)}c.ANIMATION_TYPE_SLIDE=0,c.ANIMATION_TYPE_SLIDEOVER=1,c.ANIMATION_TYPE_FADEIN=2,c.ANIMATION_TYPE_FADE_TO_BLACK=3,c.ANIMATION_TYPE_DELAYED_REMOVAL=4,c.ANIMATION_TYPE_SCREEN=5,c.ANIMATION_TYPE_FADEOUT=6,c.ANIMATION_DIRECTION_LEFT=0,c.ANIMATION_DIRECTION_RIGHT=1,c.ANIMATION_DIRECTION_UP=2,c.ANIMATION_DIRECTION_DOWN=3,c.prototype.initialize=function(a){this.app=a,this.screens=[],this.currentScreen=null,this.newScreen=null,this.transitionCallback=null,this.isTransitioning=!1,this.transitionScreen=null},c.prototype.add=function(a,b,d,e,f){if(this.isTransitioning)return!1;this.isTransitioning=!0;var g=void 0===b?200:b,h=void 0===d?c.ANIMATION_TYPE_FADEOUT:d;this.transitionCallback=e,this.transitionScreen=f||null,this.screens.push(a),this.currentScreen?(this.newScreen=a,this.currentScreen.onHide(),this.currentScreen.deactivateTouchables(),this.app.stage.addChild(this.newScreen),this.newScreen.onBeforeShow(),this.setAnimation(h,g,c.ANIMATION_DIRECTION_LEFT,this.onTransitionFinished)):(this.currentScreen=a,this.app.stage.addChild(this.currentScreen),this.currentScreen.onBeforeShow(),this.currentScreen.onShow(),this.isTransitioning=!1,this.transitionCallback&&this.transitionCallback())},c.prototype.setAnimation=function(a,b,d,e){a===c.ANIMATION_TYPE_FADEIN?this.animationFadeIn(b,e):a===c.ANIMATION_TYPE_SLIDE?this.animationSlide(b,d,e):a===c.ANIMATION_TYPE_SLIDEOVER?this.animationSlideOver(b,d,e):a===c.ANIMATION_TYPE_DELAYED_REMOVAL?this.animationDelayedRemoval(b,e):a===c.ANIMATION_TYPE_FADE_TO_BLACK?this.animationFadeToBlack(b,e):a===c.ANIMATION_TYPE_SCREEN?this.animationScreen(b,e):a===c.ANIMATION_TYPE_FADEOUT?this.animationFadeOut(b,e):(this.newScreen.position.set(0,0),this.newScreen.alpha=1,e.call(app.navigator))},c.prototype.animationScreen=function(a,b){this.transitionScreen.zIndex=2,this.currentScreen.zIndex=1,this.newScreen.zIndex=0,this.currentScreen.position.set(0,0),this.newScreen.position.set(0,0),this.transitionScreen.position.set(0,0),this.transitionScreen.onShow(),this.app.stage.addChild(this.transitionScreen),timeout(function(){this.newScreen.zIndex=1,this.currentScreen.zIndex=0},a/2,this),timeout(function(){b.call(app.navigator),this.transitionScreen.onHide(),this.app.stage.removeChild(this.transitionScreen),this.transitionScreen.removeFromParent(),this.transitionScreen=null},a,this)},c.prototype.animationFadeToBlack=function(a,b){var c=a/3;this.newScreen.alpha=0,this.currentScreen.alpha=1,this.newScreen.position.set(0,0);var d=new TweenAlpha(this.currentScreen,0,null,a/2-c/2),e=new TweenAlpha(this.newScreen,1,null,a/2-c/2,function(){b.call(app.navigator)});d.run(),timeout(function(){e.run()},a/2+c/2)},c.prototype.animationFadeIn=function(a,b){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=0;var c=new TweenAlpha(this.currentScreen,0,null,a),d=new TweenAlpha(this.newScreen,1,null,a,function(){b.call(app.navigator)});c.run(),d.run()},c.prototype.animationFadeOut=function(a,b){this.currentScreen.zIndex=1,this.newScreen.zIndex=0,this.newScreen.alpha=1,new TweenAlpha(this.currentScreen,0,new Bezier(.72,.08,.91,.68),a,function(){b.call(app.navigator)}).run()},c.prototype.animationSlide=function(a,b,c){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=1,this.newScreen.position.set(this.app.width,0);var d=new TweenMoveTo(this.currentScreen,new Vector(-this.app.width,0),null,a),e=new TweenMoveTo(this.newScreen,new Vector(0,0),null,a,function(){c.call(app.navigator)});d.run(),e.run()},c.prototype.animationSlideOver=function(a,b,c){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=1,this.newScreen.position.set(this.app.width,0);var d=new TweenMoveTo(this.currentScreen,new Vector(0,0),null,0),e=new TweenMoveTo(this.newScreen,new Vector(0,0),null,a,function(){c.call(app.navigator)});d.run(),e.run()},c.prototype.animationDelayedRemoval=function(a,b){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.position.set(0,0),timeout(function(){b.call(app.navigator)},a)},c.prototype.goBack=function(a,b,d){if(this.isTransitioning)return!1;this.isTransitioning=!0,this.transitionCallback=d;var e=void 0===b?200:b,f=void 0===a?c.ANIMATION_TYPE_FADEOUT:a;this.screens.length>1?(this.newScreen=this.screens[this.screens.length-2],this.currentScreen.onHide(),this.currentScreen.deactivateTouchables(),this.app.stage.addChild(this.newScreen),this.newScreen.onBeforeShow(),this.screens.pop(),this.setAnimation(f,e,c.ANIMATION_DIRECTION_RIGHT,this.onTransitionFinished)):this.isTransitioning=!1},c.prototype.goToRootCallback=function(){this.currentScreen.removeFromParent(),this.currentScreen.onDestroy(),this.currentScreen=this.newScreen;for(var a=this.screens.length-1;a>0;a--)this.screens.splice(a,1);this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null)},c.prototype.goToIndexCallback=function(){this.currentScreen.removeFromParent(),this.currentScreen.onDestroy(),this.currentScreen=this.newScreen;for(var a=this.screens.length-1;a>=0;a--){if(this.screens[a].id===this.newScreen.id)break;this.screens.splice(a,1)}this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null)},c.prototype.setCurrentAsRoot=function(){for(var a=this.screens.indexOf(this.currentScreen),b=0;b<this.screens.length;b++)b!==a&&this.screens[b].onDestroy();this.screens=[],this.newScreen=null,this.screens.push(this.currentScreen)},c.prototype.justDisplay=function(a){if(this.isTransitioning)return!1;this.isTransitioning=!0,this.newScreen=a,a.onShow(),this.app.stage.addChild(a),this.onTransitionFinished()},c.prototype.goToRoot=function(a,b,d){if(this.isTransitioning)return!1;if(this.isTransitioning=!0,this.screens.length){this.transitionCallback=d;var e=void 0===b?200:b;this.newScreen=this.screens[0],this.currentScreen.onHide(),this.app.stage.removeChild(this.currentScreen),this.newScreen.onShow(),this.app.stage.addChild(this.newScreen),this.setAnimation(a,e,c.ANIMATION_DIRECTION_LEFT,this.goToRootCallback)}},c.prototype.setCurrentAtIndex=function(a){for(var b=this.screens.indexOf(this.currentScreen),c=0;c<this.screens.length;c++)c!==b&&c>=a&&this.screens[c].onDestroy();this.screens=this.screens.slice(0,a),this.newScreen=null,this.screens.push(this.currentScreen)},c.prototype.goToIndex=function(a,b,d,e){if(this.isTransitioning)return!1;if(this.isTransitioning=!0,this.screens.length){this.transitionCallback=e;var f=void 0===d?200:d;this.newScreen=this.screens[a],this.currentScreen.onHide(),this.app.stage.removeChild(this.currentScreen),this.newScreen.onShow(),this.app.stage.addChild(this.newScreen),this.setAnimation(b,f,c.ANIMATION_DIRECTION_LEFT,this.goToIndexCallback)}},c.prototype.removePrevious=function(){if(this.screens.length>=2){var a=this.screens.length-2,b=this.screens[a];this.screens.splice(a,1),b.onDestroy()}},c.prototype.update=function(a){Math.insertionSort(this.app.stage.children,function(a,b){return a.zIndex>b.zIndex}),null===this.transitionScreen||this.transitionScreen.isPaused||(this.transitionScreen.update(a),this.transitionScreen.updateChildren(a,this.transitionScreen.children),this.transitionScreen.postUpdate(a)),null===this.currentScreen||this.currentScreen.isPaused||(this.currentScreen.update(a),this.currentScreen.updateChildren(a,this.currentScreen.children),this.currentScreen.postUpdate(a)),null!==this.newScreen&&(this.newScreen.isPaused||(this.newScreen.update(a),this.newScreen.updateChildren(a,this.newScreen.children),this.newScreen.postUpdate(a)))},c.prototype.onTransitionFinished=function(){this.currentScreen.removeFromParent(),this.currentScreen.onAfterHide(),this.currentScreen=this.newScreen,this.currentScreen.onShow(),this.currentScreen.activateTouchables(),this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null)},a.HNavigator=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype=Object.create(PIXI.Sprite.prototype),c.prototype.constructor=c,c.prototype.initialize=function(a){PIXI.Sprite.call(this,this.findTexture(a),!0),this.imageName=a},a.Sprite=c}(window),function(a,b){function c(){this.initialize()}c.prototype=Object.create(PIXI.Container.prototype),c.prototype.constructor=c,c.prototype.initialize=function(){PIXI.Container.call(this),this.enableSensor(),this._touchables=[],this.isPaused=!1,"undefined"!=typeof app&&(this.setSensorSize(app.width,app.height),this._background=new Sprite("white"),this._background.zIndex=-1,this._background.visible=!1,this._background.stretch(app.width,app.height),this.addChild(this._background)),this.constraints=new Constraints(this)},c.prototype.setBackgroundColor=function(a){a?(this._background.tint=convertColor(a),this._background.visible=!0):this._background.visible=!1},c.prototype.activateTouchables=function(){app.input.add(this._touchables)},c.prototype.deactivateTouchables=function(){app.input.remove(this._touchables)},c.prototype.addTouchable=function(a){app.input.add(a),this._touchables.push(a)},c.prototype.removeTouchable=function(a){app.input.remove(a);var b=this._touchables.indexOf(a);-1!==b&&this._touchables.splice(b,1)},c.prototype.onShow=function(){},c.prototype.onHide=function(){},c.prototype.onBeforeShow=function(){},c.prototype.onAfterHide=function(){},c.prototype.onAnimationEnd=function(){},c.prototype.update=function(a){},c.prototype.postUpdate=function(a){},c.prototype.updateChildren=function(a,b){Math.insertionSort(b,function(a,b){return a.zIndex>b.zIndex});for(var c=b.length;c--;){var d=b[c];d.update(a),d&&this.updateChildren(a,d.children),d.postUpdate(a)}},c.prototype.onVisibilityChange=function(a){},c.prototype._onResize=function(a,b){this.setSensorSize(a,b),this.constraints.applyValues(),this.onResize&&this.onResize(a,b)},c.prototype.findById=function(a,b){b=b||this;for(var c=0;c<b.children.length;c++){var d=b.children[c];if(d.id===a)return d;var e=this._findById(a,d.children);if(e)return e}return null},c.prototype._findById=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.id===a)return d;var e=this._findById(a,d.children);if(e)return e}return null},c.prototype.onDestroy=function(){},a.HScreen=c}(window),function(a,b){function c(){this.initialize()}c.prototype=Object.create(PIXI.Container.prototype),c.prototype.constructor=c,c.prototype.initialize=function(){PIXI.Container.call(this),this.enableSensor(),this.setSensorSize(app.width,app.height)},a.Layer=c}(window),function(a,b){function c(a,b){this.initialize(a,b)}c.prototype=Object.create(PIXI.Text.prototype),c.prototype.constructor=c,c.TEXT_H_ALIGN_CENTER="center",c.TEXT_H_ALIGN_LEFT="left",c.TEXT_H_ALIGN_RIGHT="right",c.TEXT_V_ALIGN_TOP="top",c.TEXT_V_ALIGN_MIDDLE="middle",c.TEXT_V_ALIGN_BOTTOM="bottom",c.TEXT_V_ALIGN_ALPHABETIC="alphabetic",c.prototype.initialize=function(a,b){a=a||{},PIXI.Text.call(this,b||"Default Label Text"),this.setStyle(a)},c.prototype.setStyle=function(a){this.style=a},c.prototype.clone=function(){return null},c.prototype.update=function(a){},Object.defineProperty(c.prototype,"txt",{get:function(){return this._txt},set:function(a){this._txt=a,this.text=a}}),a.Label=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a){this.spriteInitialize(null),this.setSensorSize(app.width,app.height),this.anchor.set(.5,.5),this.position.set(app.width/2,app.height/2),this.delegate=a,this.visible=!1,this.priority=1e3,this.background=new Sprite(null),this.background.anchor.set(.5,.5),this.background.zIndex=-1,this.addChild(this.background)},c.prototype.onMouseDown=function(a,b){a.stopPropagation()},c.prototype.show=function(a){this.delegate.addChild(this),this.visible=!0,a?(this.alpha=1,this.scale.set(1)):(this.background.alpha=0,this.background.scale.set(.2),new TweenAlpha(this.background,1,null,200).run(),new TweenScale(this.background,1,new Bezier(.18,.66,.64,1.23),200).run()),app.input.add(this)},c.prototype.hide=function(a){if(a){var b=new Bezier(.44,-.51,.76,.36);new TweenAlpha(this,0,null,300).run();new TweenScale(this,.5,b,300,function(a){a.removeFromParent()}).run()}else this.removeFromParent();app.input.remove(this)},a.Popup=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a){this.spriteInitialize(a),this.TYPE=c.TYPE},c.prototype.setSize=function(a,b){this._width=a,this._height=b},c.prototype.update=function(a){Sprite.prototype.update.call(this,a)},a.ScrollviewContent=c}(window),function(a,b){function c(a,b,c){this.initialize(a,b,c)}c.prototype=new Sprite,c.prototype.parentInitialize=Sprite.prototype.initialize,c.TYPE_NORMAL=0,c.TYPE_NINE_SLICE=1,c.prototype.initialize=function(a,b,d){b=b||{},this.parentInitialize(),this.type=d||0,this.offsetX=b.offsetX||0,this.offsetY=b.offsetY||0,this._isTinted=!1,this.background=new Sprite,this.anchor.set(.5,.5),this.type===c.TYPE_NORMAL?(this.imageNormal=b.imageNormal||null,this.imageSelected=b.imageSelected||null,this.background=new Sprite(this.imageNormal),this.background.centered(),this.addChild(this.background),this.setSensorSize(this.background.width,this.background.height)):d===c.TYPE_NINE_SLICE&&(this.background=new NineSlice(b.imageNormal,"15"),this.addChild(this.background)),this.label=new Label(b),this.label.txt=a,this.label.anchor.set(.5,.5),this.addChild(this.label),this.priority=10},Object.defineProperty(c.prototype,"txt",{get:function(){return this._text},set:function(a){this._text=a,this.label.txt=a}}),Object.defineProperty(c.prototype,"imageNormal",{get:function(){return this._imageNormal},set:function(a){this._imageNormal=a,this.type===c.TYPE_NORMAL&&(this.background.setTexture(a),this.setSensorSize(this.background.width,this.background.height))}}),Object.defineProperty(c.prototype,"imageSelected",{get:function(){return this._imageSelected},set:function(a){this._imageSelected=a}}),c.prototype.update=function(a){this.type===c.TYPE_NORMAL?this.handleNormalType(a):this.type===c.TYPE_NINE_SLICE&&this.handleNineSlice(a),this.label.position.set(this.offsetX,this.offsetY)},c.prototype.handleNormalType=function(a){this.isMouseDown?this.imageSelected?this.imageNormal===this.imageSelected?this.background.tint=14540253:this.imageName!==this.imageSelected&&this.background.setTexture(this.imageSelected):this.background.tint=14540253:(this.background.tint=16777215,this.imageNormal&&this.imageName!==this.imageNormal&&this.background.setTexture(this.imageNormal))},c.prototype.handleNineSlice=function(a){if(this.isMouseDown&&!this._isTinted){for(var b=0;b<this.background.backgroundParts.length;b++){var c=this.background.backgroundParts[b];c.tint=14540253}this._isTinted=!0}else if(!this.isMouseDown&&this._isTinted){for(var b=0;b<this.background.backgroundParts.length;b++){var c=this.background.backgroundParts[b];c.tint=16777215}this._isTinted=!1}},c.prototype.onMouseMove=function(a){this._check(a.point)||(this.eventIdx=-1,this.isMouseDown=!1,this.onMouseCancel(a,this))},a.Button=c}(window),function(a,b){function c(a){this.initialize(a)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a){if(!a)throw"You must initialize the InputContent with a delegate";this.spriteInitialize(null),this.delegate=a,this.keyboard=new Keyboard(this),this.delegate.addChild(this.keyboard),this.inputFields=[],this.priority=-100,this._inputTagCounter=0,this.tabIndex=0,this.setSensorSize(app.width,app.height)},c.prototype.addInput=function(a){a.setKeyboard(this.keyboard),a.tag=this._inputTagCounter++,a.delegate=this,a.onFocus=c.prototype.onInputFocus.bind(this),this.inputFields.push(a),app.input.add(a)},c.prototype.onInputFocus=function(a){this.tabIndex=a.tag;for(var b=0;b<this.inputFields.length;b++){var c=this.inputFields[b];Object.is(a,c)||c.blur()}},c.prototype.onMouseUp=function(b,c){for(var d=0;d<this.inputFields.length;d++){this.inputFields[d].blur()}a.focus()},c.prototype.onMouseCancel=function(b,c){for(var d=0;d<this.inputFields.length;d++){this.inputFields[d].blur()}a.focus()},c.prototype.onKeyboardShow=function(){var a=this.position.y,b=this.keyboard.getSize(),c=new V(0,-b.height);Actions.stopByTag("animate_content");for(var d=new V,e=0;e<this.inputFields.length;e++){var f=this.inputFields[e];f.isFocused&&d.copy(f.getGlobalPosition())}var g=app.height-b.height,h=g/2;c.y=h-d.y+a,c.y<-b.height&&(c.y=-b.height),new TweenMoveTo(this,c,null,200).run("animate_content")},c.prototype.onKeyboardHide=function(){var a=new V(0,0);Actions.stopByTag("animate_content"),new TweenMoveTo(this,a,null,200).run("animate_content")},c.prototype.onTab=function(){if(this.inputFields.length)for(var a=++this.tabIndex%this.inputFields.length,b=0;b<this.inputFields.length;b++){var c=this.inputFields[b];if(c.tag===a){c.focus();break}}},c.prototype.onShiftTab=function(){if(this.inputFields.length){var a=--this.tabIndex%this.inputFields.length;a=a<0?this.inputFields.length+a:a;for(var b=0;b<this.inputFields.length;b++){var c=this.inputFields[b];if(c.tag===a){c.focus();break}}}},c.prototype.onEsc=function(){for(var b=0;b<this.inputFields.length;b++){this.inputFields[b].blur()}a.focus()},c.prototype.onInputAdded=function(){app.input.add(this.inputFields)},c.prototype.onInputRemoved=function(){app.input.remove(this.inputFields),this.keyboard.hide(!0)},c.prototype.update=function(a){},a.InputContent=c}(window),function(a,b){function c(a,b,c,d,e){this.initialize(a,b,c,d,e)}c.TYPE_ALL=0,c.TYPE_ALPHA_NUMERIC=1,c.TYPE_NUMERIC=2,c.TYPE_ALPHABETIC=3,c.TYPE_DECIMAL=4,c.TYPE_NUMERIC_SYMBOLS=5,c.MODE_STANDARD=0,c.MODE_CENTER=1,c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,d,e,f){this.spriteInitialize(),this.delegate=f,this.keyboard=null,this.setKeyboard(e),this.type=b||c.TYPE_ALL,this.mode=d||c.MODE_STANDARD,this.hasNext=!1,this.isFocused=!1,this.priority=10,this.stream="",this.placeholder="",this.padding=20,this.fontSize=a?a.fontSize:30,this.cursorColor=0,this.originalColor=a?a.fill:"#000000",this.placeholderColor=a?a.placeholderColor||"#bbbbbb":"#bbbbbb",this.backgroundImageName=a?a.background:"button",this.backgroundPadding=a?a.backgroundPadding||"10":"20",this.anchor.set(.5,.5),this.background=new NineSlice(this.backgroundImageName,this.backgroundPadding),this.addChild(this.background),this.label=new Label(a),this.addChild(this.label),this.cursor=new Sprite("white"),this.cursor.tint=this.cursorColor,this.cursor.anchor.set(.5,.5),this.addChild(this.cursor),this.setText(""),this.blink=new TweenBlink(this.cursor,0,null,400),this.blur()},c.prototype.setKeyboard=function(a){this.keyboard=a,a&&this.keyboard.subscribe(this)},c.prototype.setSize=function(a,b){this._width=a,this._height=b,this.setSensorSize(a,b),this.label&&this.build()},c.prototype.setFontSize=function(a){this.label.style.fontSize=this.fontSize=a},c.prototype.build=function(){var a=this._width,b=this._height;this.cursor.tint=this.cursorColor,this.label.style.fontSize=this.fontSize?this.fontSize:Math.round(.7*b),this.mode===c.MODE_CENTER?(this.label.anchor.set(.5,.5),this.label.position.set(0,0)):this.mode===c.MODE_STANDARD&&(this.label.anchor.set(0,.5),this.label.position.set(-a/2+this.padding,0)),this.background.setSize(a,b),this.cursor.stretch(2,b-2*this.padding)},c.prototype.onKeyboardChange=function(a){this.isFocused&&this.setStream(a)},c.prototype.onMouseDown=function(a,b){a.stopPropagation()},c.prototype.onMouseUp=function(a,b){this.focus()},c.prototype.onFocus=function(a){},c.prototype.onBlur=function(a){},c.prototype.focus=function(){document.activeElement&&document.activeElement.blur(),a.focus(),this.isFocused||(this.onFocus(this),this.blink.run(),this.isFocused=!0,this.keyboard.hasNext=this.hasNext,app.device.isTouch&&this.keyboard.show(this.type),this.keyboard.kiboRegister(),this.keyboard.kiboSetType(this.type),this.label.txt===this.placeholder&&(this.setText(""),this.label.style.fill=this.originalColor),this.keyboard.stream=this.stream,this.keyboard.limit=this.limit)},c.prototype.blur=function(){this.blink.stop(),this.cursor.alpha=0,this.isFocused=!1,this.keyboard&&(this.keyboard.kiboUnregister(),app.device.isTouch&&this.keyboard.hide()),""===this.label.txt.trim()&&(this.setText(this.placeholder),this.label.style.fill=this.placeholderColor),this.onBlur(this)},c.prototype.setLimit=function(a){this.limit=a,this.keyboard.limit=a},c.prototype.setStream=function(a,b){if(this.stream=this.keyboard.stream=a,b=void 0===b||b,this.delegate&&this.delegate.on_stream_change){var c=this.delegate.on_stream_change(a,this);!1!==c&&this.setText(c)}else this.setText(a);this.stream===this.placeholder?this.label.style.fill=this.placeholderColor:this.label.style.fill=this.originalColor,this.delegate&&this.delegate.onStreamChanged&&b&&this.delegate.onStreamChanged(a,this)},c.prototype.setText=function(a){var b=this._width;this.label.txt=a;var d=this.label.position;if(this.mode===c.MODE_CENTER?(""===this.label.txt?this.cursor.position.set(0,0):this.cursor.position.set(this.label.width/2+5,0),this.label.position.set(0,0)):this.mode===c.MODE_STANDARD&&(""===this.label.txt?this.cursor.position.set(d.x+5,0):this.cursor.position.set(d.x+this.label.width+5,0),this.label.position.set(-b/2+this.padding,0)),this.label.width>=this._width-2*this.padding&&1!==this._width){if(this.label.mask||this.setMask(),this.mode===c.MODE_CENTER);else if(this.mode===c.MODE_STANDARD){var e=this.label.width-(b-2*this.padding);this.label.position.set(-b/2+this.padding-e,0)}this.cursor.position.set(b/2-this.padding,0)}else this.label.mask&&(this.label.mask.removeFromParent(),this.label.mask=null)},c.prototype.setMask=function(){var a=this.label.mask;!a&&this._width&&this._height&&(a=new PIXI.Graphics,this.addChild(a),a.clear(),a.beginFill(),a.drawRect(-this._width/2+this.padding,-this._height/2,this._width-2*this.padding,this._height),a.endFill(),this.label.mask=a)},c.prototype.getText=function(){return this.label.txt===this.placeholder?"":this.label.txt},c.prototype.getStream=function(){return this.stream},c.prototype.setPlaceholder=function(a,b){this.placeholder=a,this.setText(a),this.label.style.fill=b||this.placeholderColor,b&&(this.placeholderColor=b)},c.prototype.update=function(a){Sprite.prototype.update.call(this,a)},a.InputField=c}(window),function(a,b){function c(a,b,c){this.initialize(a,b,c)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.VERTICAL=0,c.HORIZONTAL=1,c.prototype.initialize=function(b,c,d){this.spriteInitialize(),this.type=d,this.delegate=b,this.priority=99,this.orientation=c,this.fontSize=60,this.openPosition=new V,this.limit=0,this.stream="",this.hasNext=!1,this.subscribers=[],this.mainSymbols=[],this.topSymbols=[],this.digits=["1","2","3","4","5","6","7","8","9","0"],this.symbols=["+","-","/","*","=","<",">",".",",","%"],this.alphabets=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],this.buttons=[],this.background=null,this.isCapital=!1,this.isShown=!1,this.isSymbol=!1,this.showCapitalize=!0,this.showSymbols=!0,this.showDot=!0,this.numberOfRows=-1,this.cellWidth=app.width/10,this.cellHeight=120,this.preview=new Button,this.preview.imageNormal="keyboard_preview_key",this.preview.label.style.fontSize=Math.round(3*this.fontSize),this.preview.offsetY=-20,this.preview.label.style.fill="#bbbbbb",this.preview.visible=!1,this.preview.zIndex=1,this.addChild(this.preview),this.visible=!1,this.hide(),this.position.set(0,app.height),this.kibo=new Kibo(a.document,this),this.kiboUnregister(),this.zIndex=100},c.prototype.kiboSetType=function(a){this.type=a,this.kibo.unregisterAll();var b=this.getConfByType(this.type);this.kibo.down(b,this.kiboDown),this.kibo.down("backspace",this.kiboDownBackspace),this.kibo.down("tab",this.kiboTab),this.kibo.down("shift tab",this.kiboShiftTab),this.kibo.down("esc",this.kiboEsc)},c.prototype.kiboDown=function(a){if(!(this.limit>0&&this.limit<=this.stream.length))return this.stream+=a.key,this.onChange(this.stream),!1},c.prototype.kiboDownBackspace=function(a){return this.stream=this.stream.slice(0,-1),this.onChange(this.stream),!1},c.prototype.kiboRegister=function(){Kibo.registerEvent(this.kibo.element,"keydown",this.kibo.downHandler),Kibo.registerEvent(this.kibo.element,"keyup",this.kibo.upHandler)},c.prototype.kiboUnregister=function(){Kibo.unregisterEvent(this.kibo.element,"keydown",this.kibo.downHandler),Kibo.unregisterEvent(this.kibo.element,"keyup",this.kibo.upHandler)},c.prototype.getConfByType=function(a){return a===InputField.TYPE_ALL?["any letter","any number","space","any symbols"]:a===InputField.TYPE_ALPHABETIC?["any letter","space"]:a===InputField.TYPE_ALPHA_NUMERIC?["any number","any letter","space"]:a===InputField.TYPE_DECIMAL?["any number","any decimals"]:a===InputField.TYPE_NUMERIC?["any number"]:a===InputField.TYPE_NUMERIC_SYMBOLS?["any number","any symbols"]:["any letter","any number","space","any symbols"]},c.prototype.loadKeyboardSymbols=function(){var a=this.type;this.isSymbol=!1,a===InputField.TYPE_NUMERIC?(this.topSymbols=this.digits,this.mainSymbols=[],this.showSymbols=!1,this.showCapitalize=!1,this.showDot=!1):a===InputField.TYPE_ALPHABETIC?(this.topSymbols=[],this.mainSymbols=this.alphabets,this.showSymbols=!1,this.showCapitalize=!0,this.showDot=!1):a===InputField.TYPE_ALPHA_NUMERIC?(this.topSymbols=this.digits,this.mainSymbols=this.alphabets,this.showSymbols=!1,this.showCapitalize=!0,this.showDot=!1):a===InputField.TYPE_DECIMAL?(this.topSymbols=this.digits,this.mainSymbols=[],this.showSymbols=!1,this.showCapitalize=!1,this.showDot=!0):a===InputField.TYPE_ALL?(this.topSymbols=this.digits,this.mainSymbols=this.alphabets,this.showSymbols=!0,this.showCapitalize=!0,this.showDot=!1):a===InputField.TYPE_NUMERIC_SYMBOLS&&(this.topSymbols=this.digits,this.mainSymbols=[],this.showSymbols=!0,this.showCapitalize=!1,this.showDot=!1)},c.prototype.subscribe=function(a){this.subscribers.push(a)},c.prototype.unsubscribe=function(a){this.subscribers.removeElement(a)},c.prototype.getSize=function(){return{width:this._width,height:this._height}},c.prototype.recalculateSize=function(){this.numberOfRows=this.mainSymbols.length+2,0===this.topSymbols.length&&(this.numberOfRows-=1),this.setSensorSize(app.width,this.cellHeight*this.numberOfRows)},c.prototype.backgroundSetup=function(){this.backgorund&&this.backgorund.removeFromParent(),this.backgorund=new PIXI.Graphics,this.addChild(this.backgorund),this.backgorund.beginFill(1118481,1),this.backgorund.drawRect(0,0,this._width,this._height+500),this.backgorund.endFill()},c.prototype.layoutSetup=function(){for(var a=0;a<this.buttons.length;a++){var b=this.buttons[a];b.removeFromParent()}this.buttons=[];for(var c=this.cellWidth,d=this.cellHeight,e=(app.width-this.topSymbols.length*c)/2,a=0;a<this.topSymbols.length;a++){var f=this.topSymbols[a],b=this.createButton(f,c,d);b.position.set(e+a*c+c/2,d/2),this.addChild(b),this.buttons.push(b)}for(var g=this.topSymbols.length?1.5*this.cellHeight:this.cellHeight/2,h=0;h<this.mainSymbols.length;h++){var i=this.mainSymbols[h];e=(app.width-i.length*c)/2;for(var a=0;a<i.length;a++){var j=i[a],b=this.createButton(j,c,d);b.position.set(a*c+e+c/2,g+d*h),this.addChild(b),this.buttons.push(b)}}var k=this.createButton("capitalize");k.imageNormal="keyboard_capitalize",k.anchor.set(.5,.5),k.label.txt="",k.isSpecial=!0;var l=this.createButton("keyboard_symbols");l.imageNormal="keyboard_symbols",l.anchor.set(.5,.5),l.label.txt="",l.isSpecial=!0;var m=this.createButton("space");m.imageNormal="keyboard_space",m.anchor.set(.5,.5),m.label.txt="",m.isSpecial=!0,this.addChild(m);var n=this.createButton("backspace");n.imageNormal="keyboard_backspace",n.anchor.set(.5,.5),n.label.txt="",n.isSpecial=!0,this.addChild(n);var o=this.createButton("done");this.hasNext?o.imageNormal="keyboard_next":o.imageNormal="keyboard_close",o.anchor.set(.5,.5),o.label.txt="",o.isSpecial=!0,this.addChild(o);var p=this.createButton(".",c,d);this.showDot&&(this.addChild(p),this.buttons.push(p)),this.buttons.push(m),this.buttons.push(n),this.buttons.push(o),this.showCapitalize&&(this.buttons.push(k),this.addChild(k)),this.showSymbols&&(this.buttons.push(l),this.addChild(l));var q=20;k.position.set(c/2+q,d*(this.numberOfRows-1)+d/2),this.showCapitalize?l.position.set(c/2+2*q+c,d*(this.numberOfRows-1)+d/2):l.position.set(c/2+q,d*(this.numberOfRows-1)+d/2),n.position.set(app.width-c/2-2*q-c,d*(this.numberOfRows-1)+d/2),m.position.set(app.width/2,d*(this.numberOfRows-1)+d/2),o.position.set(app.width-c/2-q,d*(this.numberOfRows-1)+d/2),p.position.set(app.width-3*q-2.5*c,d*(this.numberOfRows-1)+d/2)},c.prototype.createButton=function(a,b,d){var e=new Button;return e.symbol=a,e.label.txt=a,e.label.style.fill="#bbbbbb",e.label.style.fontSize=this.fontSize,e.label.style.fontFamily="Arial Black",e.priority=100,e.onMouseUp=c.prototype.keyMouseUp.bind(this),e.onMouseDown=c.prototype.keyMouseDown.bind(this),e.onMouseCancel=c.prototype.keyMouseCancel.bind(this),e.isSpecial=!1,b&&d&&e.setSensorSize(b,d),e},c.prototype.onChange=function(a){for(var b=0;b<this.subscribers.length;b++){var c=this.subscribers[b];c.onKeyboardChange&&c.onKeyboardChange(a)}},c.prototype.onType=function(a,b){},c.prototype.onBackspace=function(a){},c.prototype.keyMouseCancel=function(){this.preview.visible=!1},c.prototype.keyMouseDown=function(a,b){if(a.stopPropagation(),b.isSpecial)b.tint=14540253;else{this.preview.visible=!0;var c=b.position;this.preview.label.txt=b.symbol,this.preview.position.set(c.x-this.preview.width/2,c.y-this.preview.height-1.5*b._height)}},c.prototype.keyMouseUp=function(a,b){if(a.stopPropagation(),this.preview.visible=!1,!(this.limit&&this.limit<=this.stream.length)||b.isSpecial&&"space"!==b.symbol){if("capitalize"===b.symbol){this.isCapital=!this.isCapital;for(var c=0;c<this.buttons.length;c++){var d=this.buttons[c];if(!d.isSpecial)if(this.isCapital){var e=d.label.txt.toString().charAt(0).toUpperCase();d.label.txt=e,d.symbol=e}else{var f=d.label.txt.toString().charAt(0).toLowerCase();d.label.txt=f,d.symbol=f}}}b.isSpecial?"backspace"===b.symbol?(this.stream=this.stream.slice(0,-1),this.onBackspace(this.stream),this.onChange(this.stream)):"space"===b.symbol?(this.stream+=" ",this.onType(" ",this.stream),this.onChange(this.stream)):"done"===b.symbol?this.hasNext?this.delegate.onTab():this.hide(!0):"keyboard_symbols"===b.symbol&&this.switchSymbols():(this.stream+=b.symbol,this.onType(b.symbol,this.stream),this.onChange(this.stream))}},c.prototype.positionSetup=function(){var a=app.height-this._height;this.openPosition.x=0,this.openPosition.y=a},c.prototype.layout=function(){this.orientation===c.VERTICAL||(this.orientation,c.VERTICAL),this.recalculateSize(),this.backgroundSetup(),this.layoutSetup(),this.positionSetup()},c.prototype.switchSymbols=function(){app.input.remove(this.buttons),this.isSymbol=!this.isSymbol,this.isSymbol?this.topSymbols=this.symbols:this.topSymbols=this.digits,this.layout(),this.position.set(this.openPosition.x,this.openPosition.y),app.input.add(this.buttons)},c.prototype.show=function(a){if(this.isShown)return!1;Actions.stopByTag("keyboard_animation"),this.isShown=!0,this.kiboSetType(a),this.loadKeyboardSymbols(),this.layout(),app.input.add(this.buttons),app.input.add(this),this.visible=!0,new TweenMoveTo(this,this.openPosition,null,200).run("keyboard_animation"),this.delegate.onKeyboardShow&&this.delegate.onKeyboardShow()},c.prototype.hide=function(a){if(!this.isShown)return!1;if(Actions.stopByTag("keyboard_animation"),this.isShown=!1,a)for(var b=0;b<this.subscribers.length;b++){var c=this.subscribers[b];a&&c.isFocused&&c.blur()}for(var b=0;b<this.buttons.length;b++){var d=this.buttons[b];app.input.remove(d)}app.input.remove(this),new TweenMoveTo(this,new V(0,app.height),null,200,function(a){a.visible=!1}).run("keyboard_animation"),this.delegate.onKeyboardHide&&this.delegate.onKeyboardHide()},c.prototype.onMouseDown=function(a,b){a.stopPropagation()},c.prototype.onMouseUp=function(a,b){a.stopPropagation()},c.prototype.kiboTab=function(){return this.delegate.onTab(),!1},c.prototype.kiboShiftTab=function(){return this.delegate.onShiftTab(),!1},c.prototype.kiboEsc=function(){return this.delegate.onEsc(),!1},a.Keyboard=c}(window),function(a,b){function c(a,b){this.initialize(a,b)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b){a=a||"_loading_bar_fg",b=b||"_loading_bar_bg",this.spriteInitialize(null),this.padding=3,this.percentage=0,this.toPercentage=1,this.isAnimating=!1,this.background=new Sprite(b),this.addChild(this.background),this.setSensorSize(this.background.width,this.background.height),this.foreground=new Sprite(null),this.foreground.position.set(this.padding,this.padding),this.addChild(this.foreground),this.forgrounds=[],this.leftX=-this._width/2-100,this.totalWidth=0,this.segmentWidth=0;for(var c=0;c<28;c++){var d=new Sprite(a);d.anchor.set(.5,.5),this.totalWidth+=d.width,this.foreground.addChild(d);var e=this.leftX+d.width*c;d.position.set(e,d.height/2),this.forgrounds.push(d),this.segmentWidth=d.width}var f=new PIXI.Graphics;this.maskPadding=3,this.speed=-.05,this.maskWidth=this._width-2*this.maskPadding,this.maskHeight=this._height,this.foreground.mask=f,this.foreground.addChild(f),this.timeout=0,this.duration=300,this.xScale=1,this.yScale=1,this.isAutoHiding=!1,this.looper=new Looper([{name:"fade_in",duration:100},{name:"still",duration:800},{name:"fade_out",duration:200},{name:"end",duration:100}],!0),this.looper.isFinished=!0},c.prototype.setBarScale=function(a,b){this.xScale=a,this.yScale=b,this.scale.x=a,this.scale.y=b},c.prototype.setPercent=function(a,b){this.isAnimating=!!b,this.isAnimating?this.toPercentage=a:(this.percentage=a,this.drawMask(a)),this.timeout=this.duration,this.isAutoHiding&&this.looper.restart()},c.prototype.update=function(a){for(var b=0;b<this.forgrounds.length;b++){var c=this.forgrounds[b],d=a*this.speed,e=c.position,f=e.x-d;if(f<this.leftX){var g=this.leftX-f;f=this.leftX+this.totalWidth-g}else if(f>this.totalWidth+this.leftX){var g=this.totalWidth+this.leftX-f;f=this.leftX-g}c.position.set(f,e.y)}if(this.isAnimating&&this.timeout>0){this.timeout-=a;var e=(this.duration-this.timeout)/this.duration,h=this.toPercentage-this.percentage;this.drawMask(this.percentage+h*e),this.timeout<=0&&(this.isAnimating=!1,this.percentage=this.toPercentage)}if(this.isAutoHiding&&!this.looper.isFinished){this.looper.update(a);var i=this.looper.get();"fade_in"===i.name?this.alpha=i.percent:"still"===i.name?i.isFirstTime&&(this.alpha=1):"fade_out"===i.name&&(this.alpha=1-i.percent),"end"===i.name&&i.isFirstTime&&(this.alpha=0)}},c.prototype.drawMask=function(a){var b=this.foreground.mask;this.percentage=Math.clamp(a,0,1),b&&(b.clear(),b.beginFill(16777215,1),b.drawRect(0,0,this.maskWidth*this.percentage,this.maskHeight),b.endFill())},a.LoadingBar=c}(window),function(a,b){function c(a,b,c,d){this.initialize(a,b,c,d)}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(a,b,c,d){this.spriteInitialize(null),this.backgroundParts=[],this.imageName=a,this.padding=b,this._width=c,this._height=d,this.anchor.set(.5,.5),this.setSize(c,d)},c.prototype.setSize=function(a,b){this._width=a,this._height=b,this.setSensorSize(a,b),this.buildBackground()},c.prototype.buildBackground=function(){for(var a=this._width,b=this._height,c=0;c<this.backgroundParts.length;c++){this.backgroundParts[c].removeFromParent()}this.backgroundParts=[];var d=this.padding.split(" "),e=Number(d[0])||0,f=Number(d[1])||e,g=Number(d[2])||f,h=Number(d[3])||g;e=Math.clamp(e,-100,100),f=Math.clamp(f,-100,100),g=Math.clamp(g,-100,100),h=Math.clamp(h,-100,100);var i=new Sprite(this.imageName);i.texture=i.texture.clone();var j=i.texture.frame;i.texture.frame=new PIXI.Rectangle(j.x+h,j.y+e,j.width-h-f,j.height-e-g),i.anchor.set(.5,.5),i.position.set(0,0),i.stretch(a-h-f,b-e-g),this.addChild(i),this.backgroundParts.push(i);var k=new Sprite(this.imageName);k.texture=k.texture.clone();var j=k.texture.frame;k.texture.frame=new PIXI.Rectangle(j.x+h,j.y,j.width-h-f,e),k.anchor.set(.5,.5),k.stretch(a-h-f,e),k.position.set(0,-b/2+e/2),this.addChild(k),this.backgroundParts.push(k);var l=new Sprite(this.imageName);l.texture=l.texture.clone();var j=l.texture.frame;l.texture.frame=new PIXI.Rectangle(j.x,j.y,h,e),l.anchor.set(.5,.5),l.position.set(-a/2+h/2,-b/2+e/2),this.addChild(l),this.backgroundParts.push(l);var m=new Sprite(this.imageName);m.texture=m.texture.clone();var j=m.texture.frame;m.texture.frame=new PIXI.Rectangle(j.x+j.width-f,j.y,f,e),m.anchor.set(.5,.5),m.position.set(+a/2-f/2,-b/2+e/2),this.addChild(m),this.backgroundParts.push(m);var n=new Sprite(this.imageName);n.texture=n.texture.clone();var j=n.texture.frame;n.texture.frame=new PIXI.Rectangle(j.x+j.width-f,j.y+e,f,j.height-e-g),n.anchor.set(.5,.5),n.position.set(+a/2-f/2,0),n.stretch(f,b-e-g),this.addChild(n),this.backgroundParts.push(n);var o=new Sprite(this.imageName);o.texture=o.texture.clone();var j=o.texture.frame;o.texture.frame=new PIXI.Rectangle(j.x+j.width-f,j.y+j.height-g,f,g),o.anchor.set(.5,.5),o.position.set(+a/2-f/2,b/2-e/2),this.addChild(o),this.backgroundParts.push(o);var p=new Sprite(this.imageName);p.texture=p.texture.clone();var j=p.texture.frame;p.texture.frame=new PIXI.Rectangle(j.x+f,j.y+j.height-g,j.width-h-f,g),p.anchor.set(.5,.5),p.position.set(0,b/2-e/2),p.stretch(a-h-f,g),this.addChild(p),this.backgroundParts.push(p);var q=new Sprite(this.imageName);q.texture=q.texture.clone();var j=q.texture.frame;q.texture.frame=new PIXI.Rectangle(j.x,j.y+j.height-g,h,g),q.anchor.set(.5,.5),q.position.set(-a/2+h/2,b/2-e/2),this.addChild(q),this.backgroundParts.push(q);var r=new Sprite(this.imageName);r.texture=r.texture.clone();var j=r.texture.frame;r.texture.frame=new PIXI.Rectangle(j.x,j.y+e,h,j.height-e-g),r.anchor.set(.5,.5),r.position.set(-a/2+h/2,0),r.stretch(h,b-e-g),this.addChild(r),this.backgroundParts.push(r)},c.prototype.update=function(a){},a.NineSlice=c}(window),function(a,b){function c(){this.initialize()}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(){this.spriteInitialize(),this.contentWidth=0,this.contentHeight=0,this.content=new ScrollviewContent,Sprite.prototype.addChild.call(this,this.content),this.scrollingSpeed=new V,this.lastScrollPosition=new V,this.currentScrollPosition=new V,this.startScrollPosition=new V,this.prevX=0,this.prevY=0,this.priority=11,this._hasScrolled=!1},c.prototype.scrollToElement=function(a,b){var c=(new V).copy(a.getGlobalPosition()),d=new V(app.width/2,app.height/3*2),e=V.substruction(d,c);if(b>0){var f=this,g=V.addition(e,this.currentScrollPosition),h=new Bezier(.48,.15,.52,.92);new TweenMoveTo(this.content,g,h,b,function(a){f.currentScrollPosition.copy(a.position),f.lastScrollPosition.copy(f.currentScrollPosition)}).run()}else this.scrollBy(e.x,e.y),this.lastScrollPosition.copy(this.currentScrollPosition)},c.prototype.scrollBy=function(a,b){var c=this.currentScrollPosition,d=c.x+a,e=c.y+b,f=this._width-this.contentWidth;(d>0||d<f)&&(this.scrollingSpeed.x=0),d=d>0?0:d,d=d<f?f:d;var g=this._height-this.contentHeight;(e>0||e<g)&&(this.scrollingSpeed.y=0),e=e>0?0:e,e=e<g?g:e,this.content.position.set(d,e),this.currentScrollPosition.x=d,this.currentScrollPosition.y=e},c.prototype.onMouseDown=function(a,b){this.prevY=a.point.y,this.prevX=a.point.x,this.startScrollPosition.copy(a.point),this._hasScrolled=!1},c.prototype.onMouseMove=function(a,b){if(Math.getDistance(this.startScrollPosition,a.point)>10){var c=-this.prevX+a.point.x,d=-this.prevY+a.point.y;this.scrollBy(c,d),this.prevX=a.point.x,this.prevY=a.point.y,this._hasScrolled=!0}},c.prototype.onMouseUp=function(a){this._hasScrolled&&a.stopPropagation(),this._hasScrolled=!1},c.prototype.onMouseCancel=function(){},c.prototype.update=function(a){var b=V.substruction(this.currentScrollPosition,this.lastScrollPosition);b.len()>0&&(this.scrollingSpeed.x=(this.scrollingSpeed.x+b.x/a)/2,this.scrollingSpeed.y=(this.scrollingSpeed.y+b.y/a)/2);var c=this.scrollingSpeed.len();c>.02?(this.is_mouse_down||this.scrollBy(this.scrollingSpeed.x*a,this.scrollingSpeed.y*a),this.scrollingSpeed.scale(.9,.9)):c<.02&&(this.scrollingSpeed.x=0,this.scrollingSpeed.y=0),this.lastScrollPosition.copy(this.currentScrollPosition)},c.prototype.addChild=function(){throw"Don't add child content to the scroll view directly , use the content instead"},c.prototype.setSize=function(a,b){this.setSensorSize(a,b),this.mask&&this.mask.removeFromParent();var c=new PIXI.Graphics;c.beginFill(),c.drawRect(0,0,this._width,this._height),c.endFill(),this.mask=c,Sprite.prototype.addChild.call(this,c)},c.prototype.setContentSize=function(a,b){this.contentWidth=a,this.contentHeight=b,this.content.setSensorSize(a,b)},a.ScrollView=c}(window),function(a,b){function c(){this.initialize()}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(){this.spriteInitialize(),this.index=0,this.isSelected=!1,this._width=100,this._height=60,this.tappedLocation={x:0,y:0},this._id=-1,this.label=new Label,this.label.style.fill="#dddddd",this.label.style.fontSize=32,this.label.style.fontFamily="Arial Black",this.label.anchor.set(0,.5),this.label.position.set(20,30),this.addChild(this.label)},c.prototype.onMouseMove=function(a){Math.getDistance(this.tappedLocation,a.point);this.parent.toleranceDistance},c.prototype.onMouseDown=function(a){var b=this.parent;this.tappedLocation=a.point,0!==b.scrollingSpeed&&b.stopScrolling()},c.prototype.onMouseUp=function(a){var b=this.get_parent();0!==b.scrollingSpeed?b.stopScrolling():b.onCellSelected(this,a)},c.prototype.bindData=function(a){this.label.txt=a.text},a.TableCell=c}(window),function(a,b){function c(){this.initialize()}c.prototype=new Sprite,c.prototype.spriteInitialize=c.prototype.initialize,c.prototype.initialize=function(){this.spriteInitialize(),this.cellType=TableCell,this.data=[],this.offsetY=0,this.offsetX=0,this.cells=[],this.cellsHeight=100,this.numberOfVisibleCells=0,this.previousY=0,this.scrollingSpeed=0,this.friction=.05,this.previousFrameOffsetY=0,this.isChildrenSortable=!1,this.isScrollable=!0,this.cellSelectedIndex=b,this.toleranceDistance=5,this.tappedLocation={x:0,y:0},this.readyCounter=100,this.mask=new PIXI.Graphics},c.prototype.onWheel=function(a){var b=.8;a.point.y>0?this.scrollingSpeed=-b:this.scrollingSpeed=b},c.prototype.setSize=function(a,b){this._width=a,this._height=b,this.setSensorSize(a,b),this.mask.clear(),this.mask.beginFill(),this.mask.drawRect(0,0,this._width,this._height),this.mask.endFill(),this.addChild(this.mask)},c.prototype.onMouseDown=function(a){this.previousY=a.point.y,this.tappedLocation=a.point},c.prototype.onMouseMove=function(a){var b=Math.getDistance(this.tappedLocation,a.point),c=this.previousY-a.point.y;this.previousY=a.point.y,b>this.toleranceDistance&&this.scrollY(c)},c.prototype.setCellType=function(a){this.cellType=a},c.prototype.scrollY=function(a){if(!this.isScrollable)return this.offsetY=0,!0;this.offsetY+a<0?(this.offsetY=0,this.scrollingSpeed=0):this.offsetY+a>=this.data.length*this.cellsHeight-this._height?(this.offsetY=this.data.length*this.cellsHeight-this._height,this.scrollingSpeed=0):this.offsetY+=a},c.prototype.initCells=function(){if(this._width<=0||this._height<=0)throw"framework: table must have visible size";if(this.data.length){for(var a=0;a<this.cells.length;a++)this.cells[a].removeFromParent();this.cells=[];var b=new this.cellType;this.cellsHeight=b._height,this.cellsHeight*this.data.length<=this._height?(this.numberOfVisibleCells=this.data.length,this.isScrollable=!1):this.numberOfVisibleCells=Math.ceil(this._height/this.cellsHeight)+1;for(var a=0;a<this.numberOfVisibleCells;a++){var c=new this.cellType;this.cells.push(c),this.addChild(c)}}},c.prototype.setData=function(a){if(this.data=a,a)for(var b=0;b<a.length;b++){var c=a[b];c._id=b}},c.prototype.get_first_visible_cell_index=function(){return Math.floor(this.offsetY/this.cellsHeight)},c.prototype.stopScrolling=function(){this.readyCounter=0,this.scrollingSpeed=0,this.previousFrameOffsetY=this.offsetY},c.prototype.update=function(a){if(this.data.length){var b=this.offsetY-this.previousFrameOffsetY;0!==b&&(this.scrollingSpeed=(this.scrollingSpeed+b/a)/2),this.scrollingSpeed>.02||this.scrollingSpeed<-.02?(this.isMouseDown||this.scrollY(this.scrollingSpeed*a),this.scrollingSpeed=this.scrollingSpeed-this.scrollingSpeed*this.friction):this.scrollingSpeed<.02&&this.scrollingSpeed>-.02&&(this.scrollingSpeed=0),this.previousFrameOffsetY=this.offsetY;for(var c=Math.floor(this.offsetY/this.cellsHeight),d=this.offsetY%this.cellsHeight,e=0,f=c;f<c+this.numberOfVisibleCells;f++){var g=this.cells[e];if(g.index=f,g.position.set(0,e*this.cellsHeight-d),f===this.data.length)break;g.isSelected=!1,g.index===this.cellSelectedIndex&&(g.isSelected=!0),this.data[f]._id!==g._id&&(g._id=this.data[f]._id,g.bindData(this.data[f])),e++}}},c.prototype.onInputAdded=function(){},c.prototype.onInputRemoved=function(){},c.prototype.onCellSelected=function(a,b){this.cellSelectedIndex=a.index},a.TableView=c}(window);