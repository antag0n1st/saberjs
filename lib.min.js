!function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var i=this||e;if(t=parseFloat(t),i.ctx||l(),void 0!==t&&t>=0&&t<=1){if(i._volume=t,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),s=0;s<o.length;s++){var r=i._howls[n]._soundById(o[s]);r&&r._node&&(r._node.volume=r._volume*t)}return i}return i._volume},mute:function(t){var i=this||e;i.ctx||l(),i._muted=t,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t?0:i._volume,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),s=0;s<o.length;s++){var r=i._howls[n]._soundById(o[s]);r&&r._node&&(r._node.muted=!!t||r._muted)}return i},stop:function(){for(var t=this||e,i=0;i<t._howls.length;i++)t._howls[i].stop();return t},unload:function(){for(var t=this||e,i=t._howls.length-1;i>=0;i--)t._howls[i].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,l()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!i||"function"!=typeof i.canPlayType)return t;var n=i.canPlayType("audio/mpeg;").replace(/^no$/,""),o=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),s=o&&parseInt(o[0].split("/")[1],10)<33;return t._codecs={mp3:!(s||!n&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var i=function(e){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}catch(e){t.noAudio=!0;break}for(var o=0;o<t._howls.length;o++)if(!t._howls[o]._webAudio)for(var s=t._howls[o]._getSoundIds(),r=0;r<s.length;r++){var a=t._howls[o]._soundById(s[r]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var h=t.ctx.createBufferSource();h.buffer=t._scratchBuffer,h.connect(t.ctx.destination),void 0===h.start?h.noteOn(0):h.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),h.onended=function(){h.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var i=(new Audio).play();return i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(t){var i=this||e;return t._unlocked&&i._html5AudioPool.push(t),i},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var i=0;i<t._howls.length;i++)if(t._howls[i]._webAudio)for(var n=0;n<t._howls[i]._sounds.length;n++)if(!t._howls[i]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,i=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(t){var i=this;return e.ctx||l(),i._autoplay=t.autoplay||!1,i._format="string"!=typeof t.format?t.format:[t.format],i._html5=t.html5||!1,i._muted=t.mute||!1,i._loop=t.loop||!1,i._pool=t.pool||5,i._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,i._rate=t.rate||1,i._sprite=t.sprite||{},i._src="string"!=typeof t.src?t.src:[t.src],i._volume=void 0!==t.volume?t.volume:1,i._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=t.onend?[{fn:t.onend}]:[],i._onfade=t.onfade?[{fn:t.onfade}]:[],i._onload=t.onload?[{fn:t.onload}]:[],i._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],i._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],i._onpause=t.onpause?[{fn:t.onpause}]:[],i._onplay=t.onplay?[{fn:t.onplay}]:[],i._onstop=t.onstop?[{fn:t.onstop}]:[],i._onmute=t.onmute?[{fn:t.onmute}]:[],i._onvolume=t.onvolume?[{fn:t.onvolume}]:[],i._onrate=t.onrate?[{fn:t.onrate}]:[],i._onseek=t.onseek?[{fn:t.onseek}]:[],i._onunlock=t.onunlock?[{fn:t.onunlock}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&"none"!==i._preload&&i.load(),i},load:function(){var t=this,i=null;if(!e.noAudio){"string"==typeof t._src&&(t._src=[t._src]);for(var o=0;o<t._src.length;o++){var r,a;if(t._format&&t._format[o])r=t._format[o];else{if("string"!=typeof(a=t._src[o])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(a))||(r=/\.([^.]+)$/.exec(a.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&e.codecs(r)){i=t._src[o];break}}return i?(t._src=i,t._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new n(t),t._webAudio&&s(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")}t._emit("loaderror",null,"No audio support.")},play:function(t,i){var n=this,o=null;if("number"==typeof t)o=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var s=0,r=0;r<n._sounds.length;r++)n._sounds[r]._paused&&!n._sounds[r]._ended&&(s++,o=n._sounds[r]._id);1===s?t=null:o=null}}var a=o?n._soundById(o):n._inactiveSound();if(!a)return null;if(o&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var h=a._id;return n._queue.push({event:"play",action:function(){n.play(h)}}),h}if(o&&!a._paused)return i||n._loadQueue("play"),a._id;n._webAudio&&e._autoResume();var l=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),c=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-l),u=1e3*c/Math.abs(a._rate),p=n._sprite[t][0]/1e3,d=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var f=function(){a._paused=!1,a._seek=l,a._start=p,a._stop=d,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(l>=d)){var y=a._node;if(n._webAudio){var g=function(){n._playLock=!1,f(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;y.gain.setValueAtTime(t,e.ctx.currentTime),a._playStart=e.ctx.currentTime,void 0===y.bufferSource.start?a._loop?y.bufferSource.noteGrainOn(0,l,86400):y.bufferSource.noteGrainOn(0,l,c):a._loop?y.bufferSource.start(0,l,86400):y.bufferSource.start(0,l,c),u!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u)),i||setTimeout(function(){n._emit("play",a._id),n._loadQueue()},0)};"running"===e.state&&"interrupted"!==e.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(a._id))}else{var b=function(){y.currentTime=l,y.muted=a._muted||n._muted||e._muted||y.muted,y.volume=a._volume*e.volume(),y.playbackRate=a._rate;try{var o=y.play();if(o&&"undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)?(n._playLock=!0,f(),o.then(function(){n._playLock=!1,y._unlocked=!0,i||(n._emit("play",a._id),n._loadQueue())}).catch(function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0})):i||(n._playLock=!1,f(),n._emit("play",a._id),n._loadQueue()),y.playbackRate=a._rate,y.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u):(n._endTimers[a._id]=function(){n._ended(a),y.removeEventListener("ended",n._endTimers[a._id],!1)},y.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=n._src,y.load());var v=window&&window.ejecta||!y.readyState&&e._navigator.isCocoonJS;if(y.readyState>=3||v)b();else{n._playLock=!0;var m=function(){b(),y.removeEventListener(e._canPlayEvent,m,!1)};y.addEventListener(e._canPlayEvent,m,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),n=0;n<i.length;n++){e._clearTimer(i[n]);var o=e._soundById(i[n]);if(o&&!o._paused&&(o._seek=e.seek(i[n]),o._rateSeek=0,o._paused=!0,e._stopFade(i[n]),o._node))if(e._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var n=i._getSoundIds(t),o=0;o<n.length;o++){i._clearTimer(n[o]);var s=i._soundById(n[o]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(n[o]),s._node&&(i._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&i._clearSound(s._node))),e||i._emit("stop",s._id))}return i},mute:function(t,i){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,i)}}),n;if(void 0===i){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var o=n._getSoundIds(i),s=0;s<o.length;s++){var r=n._soundById(o[s]);r&&(r._muted=t,r._interval&&n._stopFade(r._id),n._webAudio&&r._node?r._node.gain.setValueAtTime(t?0:r._volume,e.ctx.currentTime):r._node&&(r._node.muted=!!e._muted||t),n._emit("mute",r._id))}return n},volume:function(){var t,i,n,o=this,s=arguments;if(0===s.length)return o._volume;if(1===s.length||2===s.length&&void 0===s[1]?o._getSoundIds().indexOf(s[0])>=0?i=parseInt(s[0],10):t=parseFloat(s[0]):s.length>=2&&(t=parseFloat(s[0]),i=parseInt(s[1],10)),!(void 0!==t&&t>=0&&t<=1))return(n=i?o._soundById(i):o._sounds[0])?n._volume:0;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,s)}}),o;void 0===i&&(o._volume=t),i=o._getSoundIds(i);for(var r=0;r<i.length;r++)(n=o._soundById(i[r]))&&(n._volume=t,s[2]||o._stopFade(i[r]),o._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,e.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*e.volume()),o._emit("volume",n._id));return o},fade:function(t,i,n,o){var s=this;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"fade",action:function(){s.fade(t,i,n,o)}}),s;t=Math.min(Math.max(0,parseFloat(t)),1),i=Math.min(Math.max(0,parseFloat(i)),1),n=parseFloat(n),s.volume(t,o);for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var h=s._soundById(r[a]);if(h){if(o||s._stopFade(r[a]),s._webAudio&&!h._muted){var l=e.ctx.currentTime,c=l+n/1e3;h._volume=t,h._node.gain.setValueAtTime(t,l),h._node.gain.linearRampToValueAtTime(i,c)}s._startFadeInterval(h,t,i,n,r[a],void 0===o)}}return s},_startFadeInterval:function(t,e,i,n,o,s){var r=this,a=e,h=i-e,l=Math.abs(h/.01),c=Math.max(4,l>0?n/l:n),u=Date.now();t._fadeTo=i,t._interval=setInterval(function(){var o=(Date.now()-u)/n;u=Date.now(),a+=h*o,a=h<0?Math.max(i,a):Math.min(i,a),a=Math.round(100*a)/100,r._webAudio?t._volume=a:r.volume(a,t._id,!0),s&&(r._volume=a),(i<e&&a<=i||i>e&&a>=i)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,r.volume(i,t._id),r._emit("fade",t._id))},c)},_stopFade:function(t){var i=this,n=i._soundById(t);return n&&n._interval&&(i._webAudio&&n._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(n._interval),n._interval=null,i.volume(n._fadeTo,t),n._fadeTo=null,i._emit("fade",t)),i},loop:function(){var t,e,i,n=this,o=arguments;if(0===o.length)return n._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(i=n._soundById(parseInt(o[0],10)))&&i._loop;t=o[0],n._loop=t}else 2===o.length&&(t=o[0],e=parseInt(o[1],10));for(var s=n._getSoundIds(e),r=0;r<s.length;r++)(i=n._soundById(s[r]))&&(i._loop=t,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t,t&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var t,i,n,o=this,s=arguments;if(0===s.length)i=o._sounds[0]._id;else if(1===s.length){o._getSoundIds().indexOf(s[0])>=0?i=parseInt(s[0],10):t=parseFloat(s[0])}else 2===s.length&&(t=parseFloat(s[0]),i=parseInt(s[1],10));if("number"!=typeof t)return(n=o._soundById(i))?n._rate:o._rate;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,s)}}),o;void 0===i&&(o._rate=t),i=o._getSoundIds(i);for(var r=0;r<i.length;r++)if(n=o._soundById(i[r])){o.playing(i[r])&&(n._rateSeek=o.seek(i[r]),n._playStart=o._webAudio?e.ctx.currentTime:n._playStart),n._rate=t,o._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):n._node&&(n._node.playbackRate=t);var a=o.seek(i[r]),h=1e3*((o._sprite[n._sprite][0]+o._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);!o._endTimers[i[r]]&&n._paused||(o._clearTimer(i[r]),o._endTimers[i[r]]=setTimeout(o._ended.bind(o,n),h)),o._emit("rate",n._id)}return o},seek:function(){var t,i,n=this,o=arguments;if(0===o.length)i=n._sounds[0]._id;else if(1===o.length){n._getSoundIds().indexOf(o[0])>=0?i=parseInt(o[0],10):n._sounds.length&&(i=n._sounds[0]._id,t=parseFloat(o[0]))}else 2===o.length&&(t=parseFloat(o[0]),i=parseInt(o[1],10));if(void 0===i)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var s=n._soundById(i);if(s){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var r=n.playing(i)?e.ctx.currentTime-s._playStart:0,a=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(a+r*Math.abs(s._rate))}return s._node.currentTime}var h=n.playing(i);h&&n.pause(i,!0),s._seek=t,s._ended=!1,n._clearTimer(i),n._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=t);var l=function(){n._emit("seek",i),h&&n.play(i,!0)};if(h&&!n._webAudio){var c=function(){n._playLock?setTimeout(c,0):l()};setTimeout(c,0)}else l()}return n},playing:function(t){var e=this;if("number"==typeof t){var i=e._soundById(t);return!!i&&!i._paused}for(var n=0;n<e._sounds.length;n++)if(!e._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this,i=e._duration,n=e._soundById(t);return n&&(i=e._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var t=this,i=t._sounds,n=0;n<i.length;n++)i[n]._paused||t.stop(i[n]._id),t._webAudio||(t._clearSound(i[n]._node),i[n]._node.removeEventListener("error",i[n]._errorFn,!1),i[n]._node.removeEventListener(e._canPlayEvent,i[n]._loadFn,!1),e._releaseHtml5Audio(i[n]._node)),delete i[n]._node,t._clearTimer(i[n]._id);var s=e._howls.indexOf(t);s>=0&&e._howls.splice(s,1);var r=!0;for(n=0;n<e._howls.length;n++)if(e._howls[n]._src===t._src||t._src.indexOf(e._howls[n]._src)>=0){r=!1;break}return o&&r&&delete o[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,i,n){var o=this["_on"+t];return"function"==typeof e&&o.push(n?{id:i,fn:e,once:n}:{id:i,fn:e}),this},off:function(t,e,i){var n=this,o=n["_on"+t],s=0;if("number"==typeof e&&(i=e,e=null),e||i)for(s=0;s<o.length;s++){var r=i===o[s].id;if(e===o[s].fn&&r||!e&&r){o.splice(s,1);break}}else if(t)n["_on"+t]=[];else{var a=Object.keys(n);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(n[a[s]])&&(n[a[s]]=[])}return n},once:function(t,e,i){return this.on(t,e,i,1),this},_emit:function(t,e,i){for(var n=this,o=n["_on"+t],s=o.length-1;s>=0;s--)o[s].id&&o[s].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(n,o[s].fn),0),o[s].once&&n.off(t,o[s].fn,o[s].id));return n._loadQueue(t),n},_loadQueue:function(t){var e=this;if(e._queue.length>0){var i=e._queue[0];i.event===t&&(e._queue.shift(),e._loadQueue()),t||i.action()}return e},_ended:function(t){var i=this,n=t._sprite;if(!i._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(i._ended.bind(i,t),100),i;var o=!(!t._loop&&!i._sprite[n][2]);if(i._emit("end",t._id),!i._webAudio&&o&&i.stop(t._id,!0).play(t._id),i._webAudio&&o){i._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var s=1e3*(t._stop-t._start)/Math.abs(t._rate);i._endTimers[t._id]=setTimeout(i._ended.bind(i,t),s)}return i._webAudio&&!o&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,i._clearTimer(t._id),i._cleanBuffer(t._node),e._autoSuspend()),i._webAudio||o||i.stop(t._id,!0),i},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var i=e._soundById(t);i&&i._node&&i._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,i=0;i<e._sounds.length;i++)if(t===e._sounds[i]._id)return e._sounds[i];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new n(t)},_drain:function(){var t=this,e=t._pool,i=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&i++;for(n=t._sounds.length-1;n>=0;n--){if(i<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),i--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],i=0;i<this._sounds.length;i++)e.push(this._sounds[i]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=o[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var i=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),i))try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(t){this._parent=t,this.init()};n.prototype={init:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,i._sounds.push(t),t.create(),t},create:function(){var t=this,i=t._parent,n=e._muted||t._muted||t._parent._muted?0:t._volume;return i._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(n,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._node.src=i._src,t._node.preload=!0===i._preload?"auto":i._preload,t._node.volume=n*e.volume(),t._node.load()),t},reset:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,i=t._parent;i._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)}};var o={},s=function(t){var e=t._src;if(o[e])return t._duration=o[e].duration,void h(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),n=new Uint8Array(i.length),s=0;s<i.length;++s)n[s]=i.charCodeAt(s);a(n.buffer,t)}else{var l=new XMLHttpRequest;l.open(t._xhr.method,e,!0),l.withCredentials=t._xhr.withCredentials,l.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach(function(e){l.setRequestHeader(e,t._xhr.headers[e])}),l.onload=function(){var e=(l.status+"")[0];"0"===e||"2"===e||"3"===e?a(l.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+l.status+".")},l.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete o[e],t.load())},r(l)}},r=function(t){try{t.send()}catch(e){t.onerror()}},a=function(t,i){var n=function(){i._emit("loaderror",null,"Decoding audio data failed.")},s=function(t){t&&i._sounds.length>0?(o[i._src]=t,h(i,t)):n()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(s).catch(n):e.ctx.decodeAudioData(t,s,n)},h=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},l=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=i?parseInt(i[1],10):null;if(t&&n&&n<9){var o=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!o&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:e,Howl:i}}),"undefined"!=typeof exports&&(exports.Howler=e,exports.Howl=i),"undefined"!=typeof global?(global.HowlerGlobal=t,global.Howler=e,global.Howl=i,global.Sound=n):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=i,window.Sound=n)}(),function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.SAT=e()}(this,function(){"use strict";var t={};function e(t,e){this.x=t||0,this.y=e||0}function i(t,i){this.pos=t||new e,this.r=i||0,this.offset=new e}function n(t,i){this.pos=t||new e,this.angle=0,this.offset=new e,this.scale=new e(1,1),this.setPoints(i||[])}function o(t,i,n){this.pos=t||new e,this.w=i||0,this.h=n||0}function s(){this.a=null,this.b=null,this.overlapN=new e,this.overlapV=new e,this.clear()}t.Vector=e,t.V=e,e.prototype.copy=e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.perp=e.prototype.perp=function(){var t=this.x;return this.x=this.y,this.y=-t,this},e.prototype.rotate=e.prototype.rotate=function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)-i*Math.sin(t),this.y=e*Math.sin(t)+i*Math.cos(t),this},e.prototype.reverse=e.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.normalize=e.prototype.normalize=function(){var t=this.len();return t>0&&(this.x=this.x/t,this.y=this.y/t),this},e.prototype.add=e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.sub=e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.scale=e.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0!==e?e:t,this},e.prototype.project=e.prototype.project=function(t){var e=this.dot(t)/t.len2();return this.x=e*t.x,this.y=e*t.y,this},e.prototype.projectN=e.prototype.projectN=function(t){var e=this.dot(t);return this.x=e*t.x,this.y=e*t.y,this},e.prototype.reflect=e.prototype.reflect=function(t){var e=this.x,i=this.y;return this.project(t).scale(2),this.x-=e,this.y-=i,this},e.prototype.reflectN=e.prototype.reflectN=function(t){var e=this.x,i=this.y;return this.projectN(t).scale(2),this.x-=e,this.y-=i,this},e.prototype.dot=e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len2=e.prototype.len2=function(){return this.dot(this)},e.prototype.len=e.prototype.len=function(){return Math.sqrt(this.len2())},t.Circle=i,i.prototype.getAABB=i.prototype.getAABB=function(){var t=this.r;return new o(this.pos.clone().add(this.offset).sub(new e(t,t)),2*t,2*t).toPolygon()},i.prototype.setOffset=i.prototype.setOffset=function(t){return this.offset=t,this},t.Polygon=n,n.prototype.setPoints=n.prototype.setPoints=function(t){if(!this.points||this.points.length!==t.length){var i,n=this.calcPoints=[],o=this.edges=[],s=this.normals=[];for(i=0;i<t.length;i++){var r=t[i],a=i<t.length-1?t[i+1]:t[0];r===a||r.x!==a.x||r.y!==a.y?(n.push(new e),o.push(new e),s.push(new e)):(t.splice(i,1),i-=1)}}return this.points=t,this._recalc(),this},n.prototype.setAngle=n.prototype.setAngle=function(t){return this.angle=t,this._recalc(),this},n.prototype.setOffset=n.prototype.setOffset=function(t){return this.offset=t,this._recalc(),this},n.prototype.rotate=n.prototype.rotate=function(t){for(var e=this.points,i=e.length,n=0;n<i;n++)e[n].rotate(t);return this._recalc(),this},n.prototype.translate=n.prototype.translate=function(t,e){for(var i=this.points,n=i.length,o=0;o<n;o++)i[o].x+=t,i[o].y+=e;return this._recalc(),this},n.prototype._recalc=function(){var t,e=this.calcPoints,i=this.edges,n=this.normals,o=this.points,s=this.offset,r=this.angle,a=o.length;for(t=0;t<a;t++){var h=e[t].copy(o[t]);h.x+=s.x,h.y+=s.y,0!==r&&h.rotate(r)}for(t=0;t<a;t++){var l=e[t],c=t<a-1?e[t+1]:e[0],u=i[t].copy(c).sub(l);n[t].copy(u).perp().normalize()}return this},n.prototype.getAABB=n.prototype.getAABB=function(){for(var t=this.calcPoints,i=t.length,n=t[0].x,s=t[0].y,r=t[0].x,a=t[0].y,h=1;h<i;h++){var l=t[h];l.x<n?n=l.x:l.x>r&&(r=l.x),l.y<s?s=l.y:l.y>a&&(a=l.y)}return new o(this.pos.clone().add(new e(n,s)),r-n,a-s).toPolygon()},n.prototype.getCentroid=n.prototype.getCentroid=function(){for(var t=this.calcPoints,i=t.length,n=0,o=0,s=0,r=0;r<i;r++){var a=t[r],h=r===i-1?t[0]:t[r+1],l=a.x*h.y-h.x*a.y;n+=(a.x+h.x)*l,o+=(a.y+h.y)*l,s+=l}return new e(n/=s*=3,o/=s)},t.Box=o,o.prototype.toPolygon=o.prototype.toPolygon=function(){var t=this.pos,i=this.w,o=this.h;return new n(new e(t.x,t.y),[new e,new e(i,0),new e(i,o),new e(0,o)])},t.Response=s,s.prototype.clear=s.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var r=[],a=0;a<10;a++)r.push(new e);var h=[];for(a=0;a<5;a++)h.push([]);var l=new s,c=new o(new e,1e-6,1e-6).toPolygon();function u(t,e,i){for(var n=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=t.length,r=0;r<s;r++){var a=t[r].dot(e);a<n&&(n=a),a>o&&(o=a)}i[0]=n,i[1]=o}function p(t,e,i,n,o,s){var a=h.pop(),l=h.pop(),c=r.pop().copy(e).sub(t),p=c.dot(o);if(u(i,o,a),u(n,o,l),l[0]+=p,l[1]+=p,a[0]>l[1]||l[0]>a[1])return r.push(c),h.push(a),h.push(l),!0;if(s){var d,f,y=0;if(a[0]<l[0])if(s.aInB=!1,a[1]<l[1])y=a[1]-l[0],s.bInA=!1;else y=(d=a[1]-l[0])<(f=l[1]-a[0])?d:-f;else if(s.bInA=!1,a[1]>l[1])y=a[0]-l[1],s.aInB=!1;else y=(d=a[1]-l[0])<(f=l[1]-a[0])?d:-f;var g=Math.abs(y);g<s.overlap&&(s.overlap=g,s.overlapN.copy(o),y<0&&s.overlapN.reverse())}return r.push(c),h.push(a),h.push(l),!1}function d(t,e){var i=t.len2(),n=e.dot(t);return n<0?f:n>i?g:y}t.isSeparatingAxis=p;var f=-1,y=0,g=1;function b(t,e,i){for(var n=r.pop().copy(e.pos).add(e.offset).sub(t.pos),o=e.r,s=o*o,a=t.calcPoints,h=a.length,l=r.pop(),c=r.pop(),u=0;u<h;u++){var p=u===h-1?0:u+1,y=0===u?h-1:u-1,b=0,v=null;l.copy(t.edges[u]),c.copy(n).sub(a[u]),i&&c.len2()>s&&(i.aInB=!1);var m=d(l,c);if(m===f){l.copy(t.edges[y]);var _=r.pop().copy(n).sub(a[y]);if((m=d(l,_))===g){if((S=c.len())>o)return r.push(n),r.push(l),r.push(c),r.push(_),!1;i&&(i.bInA=!1,v=c.normalize(),b=o-S)}r.push(_)}else if(m===g){if(l.copy(t.edges[p]),c.copy(n).sub(a[p]),(m=d(l,c))===f){if((S=c.len())>o)return r.push(n),r.push(l),r.push(c),!1;i&&(i.bInA=!1,v=c.normalize(),b=o-S)}}else{var w=l.perp().normalize(),S=c.dot(w),x=Math.abs(S);if(S>0&&x>o)return r.push(n),r.push(w),r.push(c),!1;i&&(v=w,b=o-S,(S>=0||b<2*o)&&(i.bInA=!1))}v&&i&&Math.abs(b)<Math.abs(i.overlap)&&(i.overlap=b,i.overlapN.copy(v))}return i&&(i.a=t,i.b=e,i.overlapV.copy(i.overlapN).scale(i.overlap)),r.push(n),r.push(l),r.push(c),!0}function v(t,e,i){for(var n=t.calcPoints,o=n.length,s=e.calcPoints,r=s.length,a=0;a<o;a++)if(p(t.pos,e.pos,n,s,t.normals[a],i))return!1;for(a=0;a<r;a++)if(p(t.pos,e.pos,n,s,e.normals[a],i))return!1;return i&&(i.a=t,i.b=e,i.overlapV.copy(i.overlapN).scale(i.overlap)),!0}return t.pointInCircle=function(t,e){var i=r.pop().copy(t).sub(e.pos).sub(e.offset),n=e.r*e.r,o=i.len2();return r.push(i),o<=n},t.pointInPolygon=function(t,e){c.pos.copy(t),l.clear();var i=v(c,e,l);return i&&(i=l.aInB),i},t.testCircleCircle=function(t,e,i){var n=r.pop().copy(e.pos).add(e.offset).sub(t.pos).sub(t.offset),o=t.r+e.r,s=o*o,a=n.len2();if(a>s)return r.push(n),!1;if(i){var h=Math.sqrt(a);i.a=t,i.b=e,i.overlap=o-h,i.overlapN.copy(n.normalize()),i.overlapV.copy(n).scale(i.overlap),i.aInB=t.r<=e.r&&h<=e.r-t.r,i.bInA=e.r<=t.r&&h<=t.r-e.r}return r.push(n),!0},t.testPolygonCircle=b,t.testCirclePolygon=function(t,e,i){var n=b(e,t,i);if(n&&i){var o=i.a,s=i.aInB;i.overlapN.reverse(),i.overlapV.reverse(),i.a=i.b,i.b=o,i.aInB=i.bInA,i.bInA=s}return n},t.testPolygonPolygon=v,t});var Kibo=function(t,e){this.element=t||window.document,this.context=e||this,this.initialize(),this.isRegistered=!0};Kibo.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",18:"alt",17:"ctrl",224:"ctrl",91:"ctrl",93:"ctrl",20:"caps_lock",27:"esc",32:"space",33:"page_up",34:"page_down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num_lock",188:"comma",189:"dash",190:"dot",191:"slash"},Kibo.KEY_CODES_BY_NAME={},function(){for(var t in Kibo.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(Kibo.KEY_NAMES_BY_CODE,t)&&(Kibo.KEY_CODES_BY_NAME[Kibo.KEY_NAMES_BY_CODE[t]]=+t)}(),Kibo.MODIFIERS=["shift","ctrl","alt"],Kibo.WILDCARD_TYPES=["arrow","number","letter","f","symbols","decimals"],Kibo.WILDCARDS={arrow:[37,38,39,40],number:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],letter:[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90],f:[112,113,114,115,116,117,118,119,120,121,122,123],symbols:[59,61,173,186,187,188,189,190,191,192,106,107,108,109,110,111,219,220,221,222],decimals:[110,190]},Kibo.registerEvent=document.addEventListener?function(t,e,i){t.addEventListener(e,i,!1)}:document.attachEvent?function(t,e,i){t.attachEvent("on"+e,i)}:void 0,Kibo.unregisterEvent=document.removeEventListener?function(t,e,i){t.removeEventListener(e,i,!1)}:document.detachEvent?function(t,e,i){t.detachEvent("on"+e,i)}:void 0,Kibo.stringContains=function(t,e){return-1!==t.indexOf(e)},Kibo.neatString=function(t){return t.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")},Kibo.capitalize=function(t){return t.toLowerCase().replace(/^./,function(t){return t.toUpperCase()})},Kibo.isString=function(t){return Kibo.stringContains(Object.prototype.toString.call(t),"String")},Kibo.arrayIncludes=Array.prototype.indexOf?function(t,e){return-1!==t.indexOf(e)}:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},Kibo.extractModifiers=function(t){var e,i;for(e=[],i=0;i<Kibo.MODIFIERS.length;i++)Kibo.stringContains(t,Kibo.MODIFIERS[i])&&e.push(Kibo.MODIFIERS[i]);return e},Kibo.extractKey=function(t){var e,i;for(e=Kibo.neatString(t).split(" "),i=0;i<e.length;i++)if(!Kibo.arrayIncludes(Kibo.MODIFIERS,e[i]))return e[i]},Kibo.modifiersAndKey=function(t){var e,i;return Kibo.stringContains(t,"any")?Kibo.neatString(t).split(" ").slice(0,2).join(" "):(e=Kibo.extractModifiers(t),(i=Kibo.extractKey(t))&&!Kibo.arrayIncludes(Kibo.MODIFIERS,i)&&e.push(i),e.join(" "))},Kibo.keyName=function(t){return Kibo.KEY_NAMES_BY_CODE[t+""]},Kibo.keyCode=function(t){return+Kibo.KEY_CODES_BY_NAME[t]},Kibo.prototype.initialize=function(){var t;for(this.lastKeyCode=-1,this.lastModifiers={},t=0;t<Kibo.MODIFIERS.length;t++)this.lastModifiers[Kibo.MODIFIERS[t]]=!1;for(this.keysDown={any:[]},this.keysUp={any:[]},t=0;t<Kibo.WILDCARD_TYPES.length;t++)this.keysDown["any "+Kibo.WILDCARD_TYPES[t]]=[],this.keysUp["any "+Kibo.WILDCARD_TYPES[t]]=[];this.downHandler=this.handler("down"),this.upHandler=this.handler("up");var e=this;Kibo.registerEvent(this.element,"keydown",this.downHandler),Kibo.registerEvent(this.element,"keyup",this.upHandler),Kibo.registerEvent(window,"unload",function t(){Kibo.unregisterEvent(e.element,"keydown",e.downHandler),Kibo.unregisterEvent(e.element,"keyup",e.upHandler),Kibo.unregisterEvent(window,"unload",t)})},Kibo.prototype.handler=function(t){var e=this;return function(i){var n,o,s,r;for((i=i||window.event).keyIdentifier&&(i.keyCode=parseInt(i.keyIdentifier,16),i.key=String.fromCharCode(i.keyCode)),e.lastKeyCode=i.keyCode,n=0;n<Kibo.MODIFIERS.length;n++)e.lastModifiers[Kibo.MODIFIERS[n]]=i[Kibo.MODIFIERS[n]+"Key"];for(Kibo.arrayIncludes(Kibo.MODIFIERS,Kibo.keyName(e.lastKeyCode))&&(e.lastModifiers[Kibo.keyName(e.lastKeyCode)]=!0),s=e["keys"+Kibo.capitalize(t)],n=0;n<s.any.length;n++){!1===s.any[n].call(e.context,i)&&i.preventDefault&&i.preventDefault()}for(n=0;n<Kibo.WILDCARD_TYPES.length;n++)if(Kibo.arrayIncludes(Kibo.WILDCARDS[Kibo.WILDCARD_TYPES[n]],e.lastKeyCode))for(o=0;o<s["any "+Kibo.WILDCARD_TYPES[n]].length;o++){!1===s["any "+Kibo.WILDCARD_TYPES[n]][o].call(e.context,i)&&i.preventDefault&&i.preventDefault()}if(s[r=e.lastModifiersAndKey()])for(n=0;n<s[r].length;n++){!1===s[r][n].call(e.context,i)&&i.preventDefault&&i.preventDefault()}}},Kibo.prototype.registerKeys=function(t,e,i){var n,o,s=this["keys"+Kibo.capitalize(t)];for(Kibo.isString(e)&&(e=[e]),n=0;n<e.length;n++)o=e[n],s[o=Kibo.modifiersAndKey(o+"")]?s[o].push(i):s[o]=[i];return this},Kibo.prototype.unregisterKeys=function(t,e,i){var n,o,s,r=this["keys"+Kibo.capitalize(t)];for(Kibo.isString(e)&&(e=[e]),n=0;n<e.length;n++)if(s=e[n],s=Kibo.modifiersAndKey(s+""),null===i)delete r[s];else if(r[s])for(o=0;o<r[s].length;o++)if(String(r[s][o])===String(i)){r[s].splice(o,1);break}return this},Kibo.prototype.unregisterAll=function(){this.unregisterByKey("keysUp"),this.unregisterByKey("keysDown")},Kibo.prototype.unregisterByKey=function(t){var e=this[t];for(var i in e)e.hasOwnProperty(i)&&(e[i]=[])},Kibo.prototype.delegate=function(t,e,i){return null!==i?this.registerKeys(t,e,i):this.unregisterKeys(t,e,i)},Kibo.prototype.down=function(t,e){return this.delegate("down",t,e)},Kibo.prototype.up=function(t,e){return this.delegate("up",t,e)},Kibo.prototype.lastKey=function(t){return t?this.lastModifiers[t]:Kibo.keyName(this.lastKeyCode)},Kibo.prototype.lastModifiersAndKey=function(){var t,e;for(t=[],e=0;e<Kibo.MODIFIERS.length;e++)this.lastKey(Kibo.MODIFIERS[e])&&t.push(Kibo.MODIFIERS[e]);return Kibo.arrayIncludes(t,this.lastKey())||t.push(this.lastKey()),t.join(" ")},Kibo.prototype.registerMe=function(){this.isRegistered||(Kibo.registerEvent(this.element,"keydown",this.downHandler),Kibo.registerEvent(this.element,"keyup",this.upHandler),this.isRegistered=!0)},Kibo.prototype.unregisterMe=function(){this.isRegistered&&(Kibo.unregisterEvent(this.element,"keydown",this.downHandler),Kibo.unregisterEvent(this.element,"keyup",this.upHandler),this.isRegistered=!1)},function(t){var e=-1,i={onVisible:function(t){var e=i.isSupported();if(!e||!i.hidden())return t(),e;var n=i.change(function(e,o){i.hidden()||(i.unbind(n),t())});return n},change:function(t){if(!i.isSupported())return!1;var n=e+=1;return i._callbacks[n]=t,i._listen(),n},unbind:function(t){delete i._callbacks[t]},afterPrerendering:function(t){var e=i.isSupported();if(!e||"prerender"!=i.state())return t(),e;var n=i.change(function(e,o){"prerender"!=o&&(i.unbind(n),t())});return n},hidden:function(){return!(!i._doc.hidden&&!i._doc.webkitHidden)},state:function(){return i._doc.visibilityState||i._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!i._doc.visibilityState&&!i._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(t){var e=i.state();for(var n in i._callbacks)i._callbacks[n].call(i._doc,t,e)},_listen:function(){if(!i._init){var t="visibilitychange";i._doc.webkitVisibilityState&&(t="webkit"+t);var e=function(){i._change.apply(i,arguments)};i._doc.addEventListener?i._doc.addEventListener(t,e):i._doc.attachEvent(t,e),i._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=i:t.Visibility=i}(this),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).store=t()}}(function(){return function t(e,i,n){function o(r,a){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!a&&h)return h(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){var i=e[r][1][t];return o(i||t)},c,c.exports,t,e,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,e,i){(function(t){"use strict";e.exports=function(){var e,i={},n="undefined"!=typeof window?window:t,o=n.document,s="localStorage",r="script";if(i.disabled=!1,i.version="1.3.20",i.set=function(t,e){},i.get=function(t,e){},i.has=function(t){return void 0!==i.get(t)},i.remove=function(t){},i.clear=function(){},i.transact=function(t,e,n){null==n&&(n=e,e=null),null==e&&(e={});var o=i.get(t,e);n(o),i.set(t,o)},i.getAll=function(){},i.forEach=function(){},i.serialize=function(t){return JSON.stringify(t)},i.deserialize=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}},function(){try{return s in n&&n[s]}catch(t){return!1}}())e=n[s],i.set=function(t,n){return void 0===n?i.remove(t):(e.setItem(t,i.serialize(n)),n)},i.get=function(t,n){var o=i.deserialize(e.getItem(t));return void 0===o?n:o},i.remove=function(t){e.removeItem(t)},i.clear=function(){e.clear()},i.getAll=function(){var t={};return i.forEach(function(e,i){t[e]=i}),t},i.forEach=function(t){for(var n=0;n<e.length;n++){var o=e.key(n);t(o,i.get(o))}};else if(o&&o.documentElement.addBehavior){var a,h;try{(h=new ActiveXObject("htmlfile")).open(),h.write("<"+r+">document.w=window</"+r+'><iframe src="/favicon.ico"></iframe>'),h.close(),a=h.w.frames[0].document,e=a.createElement("div")}catch(t){e=o.createElement("div"),a=o.body}var l=function(t){return function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(e),a.appendChild(e),e.addBehavior("#default#userData"),e.load(s);var o=t.apply(i,n);return a.removeChild(e),o}},c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),u=function(t){return t.replace(/^d/,"___$&").replace(c,"___")};i.set=l(function(t,e,n){return e=u(e),void 0===n?i.remove(e):(t.setAttribute(e,i.serialize(n)),t.save(s),n)}),i.get=l(function(t,e,n){e=u(e);var o=i.deserialize(t.getAttribute(e));return void 0===o?n:o}),i.remove=l(function(t,e){e=u(e),t.removeAttribute(e),t.save(s)}),i.clear=l(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(s);for(var i=e.length-1;i>=0;i--)t.removeAttribute(e[i].name);t.save(s)}),i.getAll=function(t){var e={};return i.forEach(function(t,i){e[t]=i}),e},i.forEach=l(function(t,e){for(var n,o=t.XMLDocument.documentElement.attributes,s=0;n=o[s];++s)e(n.name,i.deserialize(t.getAttribute(n.name)))})}try{var p="__storejs__";i.set(p,p),i.get(p)!=p&&(i.disabled=!0),i.remove(p)}catch(t){i.disabled=!0}return i.enabled=!i.disabled,i}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});var OP=PIXI.ObservablePoint,P=PIXI.Point;function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PIXI.DisplayObject.prototype.sensor=null,PIXI.DisplayObject.prototype._width=0,PIXI.DisplayObject.prototype._height=0,PIXI.DisplayObject.prototype.tag="",PIXI.DisplayObject.prototype.priority=0,PIXI.DisplayObject.prototype.sumAllAngles=function(){return this.parent?this.rotation+this.parent.sumAllAngles():this.rotation},PIXI.DisplayObject.prototype.absoluteScale=function(){return this.parent?this.scale.x*this.parent.absoluteScale():this.scale.x},PIXI.DisplayObject.prototype.absoluteScaleY=function(){return this.parent?this.scale.y*this.parent.absoluteScaleY():this.scale.y},PIXI.DisplayObject.prototype.setCustomSensor=function(t){this.sensor=t,this.sensor.translate(-this._sensorTranslationX,-this._sensorTranslationY),this.sensor.rotate(this._sensorRotation)},PIXI.DisplayObject.prototype.enableSensor=function(){this.sensor||(this.texture?(this._width=this.texture.width,this._height=this.texture.height):(this._width=1,this._height=1),this.sensor=new SAT.Box(new SAT.V(this.x,this.y),this._width,this._height).toPolygon(),this._sensorTranslationX=0,this._sensorTranslationY=0,this._sensorRotation=0,this._sensorTranslationScaleX=1,this._sensorTranslationScaleY=1,this.eventIdx=-1,this.isMouseDown=!1,this.isTouchable=!0)},PIXI.DisplayObject.prototype.setSensorSize=function(t,e){this.sensor||this.enableSensor(),this._width=Math.round(t),this._height=Math.round(e),this.sensor=new SAT.Box(new SAT.V(this.x,this.y),this._width,this._height).toPolygon()},PIXI.DisplayObject.prototype.getSensor=function(){if(this.sensor){var t=this.getGlobalPosition();this.sensor.pos.copy(t);var e=this.absoluteScale(),i=this.absoluteScaleY(),n=this.sumAllAngles();return e===this._sensorTranslationScaleX&&i===this._sensorTranslationScaleY||(this.adjustScale(this._sensorTranslationScaleX,this._sensorTranslationScaleY),this.adjustTranslation(this._sensorTranslationScaleX,this._sensorTranslationScaleY,n),this.adjustRotation(n)),this.adjustScale(e,i),this.adjustTranslation(e,i,n),this.adjustRotation(n),this.sensor}return null},PIXI.DisplayObject.prototype.adjustTranslation=function(t,e){var i=this.pivot?this.pivot.x:0,n=this.pivot?this.pivot.y:0,o=this.anchor?this.anchor.x:0,s=this.anchor?this.anchor.y:0,r=i+this._width*o*t,a=n+this._height*s*e,h=this._sensorTranslationX-r,l=this._sensorTranslationY-a;if(!this.sensor.anchor||this.sensor.anchor.x!==o||this.sensor.anchor.y!==s){var c=new V(h,l);c.rotate(this._sensorRotation),this.sensor.translate(c.x,c.y),this.sensor.anchor=new V(o,s),this._sensorTranslationX=r,this._sensorTranslationY=a,this._sensorTranslationScaleX=t,this._sensorTranslationScaleY=e}},PIXI.DisplayObject.prototype.adjustScale=function(t,e){var i=t/this.sensor.scale.x,n=e/this.sensor.scale.y;if(this.sensor.scale.x=t,this.sensor.scale.y=e,1!==i||1!==n){for(var o=[],s=0;s<this.sensor.points.length;s++){var r=this.sensor.points[s].clone();r.scale(i,n),o.push(r)}this.sensor.setPoints(o)}},PIXI.DisplayObject.prototype.adjustRotation=function(t){var e=t-this._sensorRotation;e&&(this.sensor.rotate(e),this._sensorRotation=t)},PIXI.DisplayObject.prototype.bringToFront=function(){var t=this.parent;t.setChildIndex(this,t.children.length-1)},PIXI.DisplayObject.prototype.pushToBack=function(){this.parent.setChildIndex(this,0)},PIXI.DisplayObject.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},PIXI.DisplayObject.prototype._check=function(t){var e=this.getSensor();return!!SAT.pointInPolygon(t,e)},PIXI.DisplayObject.prototype.stretch=function(t,e){this.width=t,this.height=e},PIXI.DisplayObject.prototype.centered=function(){this.anchor.set(.5,.5)},PIXI.DisplayObject.prototype.findById=function(t,e){e=e||this;for(var i=0;i<e.children.length;i++){var n=e.children[i];if(n.id===t)return n;var o=this._findById(t,n.children);if(o)return o}return null},PIXI.DisplayObject.prototype._findById=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n;var o=this._findById(t,n.children);if(o)return o}return null},PIXI.DisplayObject.prototype.findByName=function(t,e){e=e||this.children;for(var i=0;i<e.length;i++){var n=e[i];if(n.name===t)return n;var o=this.findByName(t,n.children);if(o)return o}return null},PIXI.DisplayObject.prototype.findByTag=function(t,e,i){i=i||this.children,e=e||[];for(var n=0;n<i.length;n++){var o=i[n];o.tag==t&&e.push(o),this.findByTag(t,e,o.children)}return e.length?e:null},PIXI.DisplayObject.prototype.findByType=function(t,e,i){i=i||this.children,e=e||[];for(var n=0;n<i.length;n++){var o=i[n];o instanceof t&&e.push(o),this.findByType(t,e,o.children)}return e.length?e:null},PIXI.DisplayObject.prototype.findByCustom=function(t,e,i){i=i||this.children,e=e||[];for(var n=0;n<i.length;n++){var o=i[n];t(o)&&e.push(o),this.findByCustom(t,e,o.children)}return e.length?e:null},PIXI.DisplayObject.prototype.fitTo=function(t,e){this.calculateBounds();var i=this.getLocalBounds(),n=i.width,o=i.height;this.scale.set(Math.min(t/n,e/o))},PIXI.DisplayObject.prototype.fillOut=function(t,e){this.calculateBounds();var i=this.getLocalBounds(),n=i.width,o=i.height,s=Math.max(t/n,e/o);this.scale.set(s,s)},PIXI.DisplayObject.prototype.onUpdate=function(t){},PIXI.DisplayObject.prototype.postUpdate=function(t){},PIXI.DisplayObject.prototype.onMouseDown=function(t,e){},PIXI.DisplayObject.prototype.onMouseMove=function(t,e){},PIXI.DisplayObject.prototype.onMouseUp=function(t,e){},PIXI.DisplayObject.prototype.onMouseCancel=function(t,e){},PIXI.DisplayObject.prototype.onRightMouseDown=function(t,e){},PIXI.DisplayObject.prototype.onRightMouseMove=function(t,e){},PIXI.DisplayObject.prototype.onRightMouseUp=function(t,e){},PIXI.DisplayObject.prototype.onWheel=function(t,e){},PIXI.DisplayObject.prototype.onInputAdded=function(){},PIXI.DisplayObject.prototype.onInputRemoved=function(){},PIXI.Sprite.prototype.findTexture=function(t){return Images[t]?Images[t].texture:"white"===t?PIXI.Texture.WHITE:t?PIXI.Texture.from(t):PIXI.Texture.EMPTY},PIXI.Sprite.prototype.textureExists=function(t){return!!PIXI.utils.TextureCache[t]},PIXI.Sprite.prototype.setTexture=function(t){this.texture=this.findTexture(t),this.imageName=t},PIXI.utils.string2hex=function(t){return t=t.replace("#","0x"),Math.round(t)};var V=SAT.V;V.prototype.setLength=function(t){var e=this.getAngle();return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},V.prototype.getLength=function(){return Math.sqrt(this.len2())},V.prototype.setAngle=function(t){var e=this.len();return this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},V.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},V.prototype.set=function(t,e){this.x=t,this.y=e},V.addition=function(t,e){return new V(t.x+e.x,t.y+e.y)},V.substruction=function(t,e){return new V(t.x-e.x,t.y-e.y)},function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype=new V,i.prototype.initialize=function(t,e,i,n){this._x=t,this._y=e,this.callback=i||function(){},this.context=n||this,this.originalX=t,this.originalY=e,this.index=-1},i.prototype.set=function(t,e){var i=t||0,n=e||(0!==e?i:0);this._x===i&&this._y===n||(this._x=i,this._y=n,this.callback.call(this.context,this))},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){var e=this._x;this._x=t,e!==t&&this.callback.call(this.context,this)}}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){var e=this._y;this._y=t,e!==t&&this.callback.call(this.context,this)}}),t.ObservableVector=i}(window);var OV=ObservableVector,BEZIER={};if(function(t,e){"use strict";var i=Math.abs,n=Math.cos,o=Math.sin,s=Math.acos,r=Math.atan2,a=Math.sqrt,h=Math.pow,l=function(t){return t<0?-h(-t,1/3):h(t,1/3)},c=Math.PI,u=2*c,p=c/2,d=Number.MAX_SAFE_INTEGER,f=Number.MIN_SAFE_INTEGER,y={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var i=e(t),n=i.x*i.x+i.y*i.y;return void 0!==i.z&&(n+=i.z*i.z),a(n)},between:function(t,e,i){return e<=t&&t<=i||y.approximately(t,e)||y.approximately(t,i)},approximately:function(t,e,n){return i(t-e)<=(n||1e-6)},length:function(t){var e,i,n=0,o=y.Tvalues.length;for(e=0;e<o;e++)i=.5*y.Tvalues[e]+.5,n+=y.Cvalues[e]*y.arcfn(i,t);return.5*n},map:function(t,e,i,n,o){return n+(o-n)*((t-e)/(i-e))},lerp:function(t,e,i){var n={x:e.x+t*(i.x-e.x),y:e.y+t*(i.y-e.y)};return e.z&&i.z&&(n.z=e.z+t*(i.z-e.z)),n},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(y.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,i){var n=e.x-t.x,o=e.y-t.y,s=i.x-t.x,a=i.y-t.y;return r(n*a-o*s,n*s+o*a)},round:function(t,e){var i=""+t,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(t,e){var i=t.x-e.x,n=t.y-e.y;return a(i*i+n*n)},closest:function(t,e){var i,n,o=h(2,63);return t.forEach(function(t,s){(n=y.dist(e,t))<o&&(o=n,i=s)}),{mdist:o,mpos:i}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=h(t,e)+h(1-t,e);return i((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var i=h(1-t,e);return i/(h(t,e)+i)},lli8:function(t,e,i,n,o,s,r,a){var h=(t-i)*(s-a)-(e-n)*(o-r);return 0!=h&&{x:((t*n-e*i)*(o-r)-(t-i)*(o*a-s*r))/h,y:((t*n-e*i)*(s-a)-(e-n)*(o*a-s*r))/h}},lli4:function(t,e,i,n){var o=t.x,s=t.y,r=e.x,a=e.y,h=i.x,l=i.y,c=n.x,u=n.y;return y.lli8(o,s,r,a,h,l,c,u)},lli:function(t,e){return y.lli4(t,t.c,e,e.c)},makeline:function(e,i){var n=t.Bezier,o=e.x,s=e.y,r=i.x,a=i.y,h=(r-o)/3,l=(a-s)/3;return new n(o,s,o+h,s+l,o+2*h,s+2*l,r,a)},findbbox:function(t){var e=d,i=d,n=f,o=f;return t.forEach(function(t){var s=t.bbox();e>s.x.min&&(e=s.x.min),i>s.y.min&&(i=s.y.min),n<s.x.max&&(n=s.x.max),o<s.y.max&&(o=s.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+o)/2,max:o,size:o-i}}},shapeintersections:function(t,e,i,n,o){if(!y.bboxoverlap(e,n))return[];var s=[],r=[t.startcap,t.forward,t.back,t.endcap],a=[i.startcap,i.forward,i.back,i.endcap];return r.forEach(function(e){e.virtual||a.forEach(function(n){if(!n.virtual){var r=e.intersects(n,o);r.length>0&&(r.c1=e,r.c2=n,r.s1=t,r.s2=i,s.push(r))}})}),s},makeshape:function(t,e,i){var n=e.points.length,o=t.points.length,s=y.makeline(e.points[n-1],t.points[0]),r=y.makeline(t.points[o-1],e.points[0]),a={startcap:s,forward:t,back:e,endcap:r,bbox:y.findbbox([s,t,e,r])},h=y;return a.intersections=function(t){return h.shapeintersections(a,a.bbox,t,t.bbox,i)},a},getminmax:function(t,e,i){if(!i)return{min:0,max:0};var n,o,s=d,r=f;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var a=0,h=i.length;a<h;a++)n=i[a],(o=t.get(n))[e]<s&&(s=o[e]),o[e]>r&&(r=o[e]);return{min:s,mid:(s+r)/2,max:r,size:r-s}},align:function(t,e){var i=e.p1.x,s=e.p1.y,a=-r(e.p2.y-s,e.p2.x-i);return t.map(function(t){return{x:(t.x-i)*n(a)-(t.y-s)*o(a),y:(t.x-i)*o(a)+(t.y-s)*n(a)}})},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=t.length-1,o=y.align(t,e),r=function(t){return 0<=t&&t<=1};if(2===i){if(0!==(p=(d=o[0].y)-2*(f=o[1].y)+(g=o[2].y))){var h=-a(f*f-d*g),c=-d+f;return[-(h+c)/p,-(-h+c)/p].filter(r)}return f!==g&&0===p?[(2*f-g)/2*(f-g)].filter(r):[]}var p,d,f,g,b,v=o[0].y,m=o[1].y,_=o[2].y,w=(o=(3*(f=(-3*v+3*m)/(p=3*m-v-3*_+o[3].y))-(d=(3*v-6*m+3*_)/p)*d)/3)/3,S=(2*d*d*d-9*d*f+27*(g=v/p))/27,x=S/2,I=x*x+w*w*w;if(I<0){var T=-o/3,k=a(T*T*T),C=-S/(2*k),P=s(C<-1?-1:C>1?1:C),z=2*l(k);return[z*n(P/3)-d/3,z*n((P+u)/3)-d/3,z*n((P+2*u)/3)-d/3].filter(r)}if(0===I)return[2*(b=x<0?l(-x):-l(x))-d/3,-b-d/3].filter(r);var E=a(I);return[(b=l(-x+E))-l(x+E)-d/3].filter(r)},droots:function(t){if(3===t.length){var e=t[0],i=t[1],n=t[2],o=e-2*i+n;if(0!==o){var s=-a(i*i-e*n),r=-e+i;return[-(s+r)/o,-(-s+r)/o]}return i!==n&&0===o?[(2*i-n)/(2*(i-n))]:[]}if(2===t.length)return(e=t[0])!==(i=t[1])?[e/(e-i)]:[]},inflections:function(t){if(t.length<4)return[];var e=y.align(t,{p1:t[0],p2:t.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,o=e[1].x*e[2].y,s=18*(-3*i+2*n+3*o-(u=e[3].x*e[2].y)),r=18*(3*i-n-3*o),a=18*(o-i);if(y.approximately(s,0)){if(!y.approximately(r,0)){var h=-a/r;if(0<=h&&h<=1)return[h]}return[]}var l=r*r-4*s*a,c=Math.sqrt(l),u=2*s;return y.approximately(u,0)?[]:[(c-r)/u,-(r+c)/u].filter(function(t){return 0<=t&&t<=1})},bboxoverlap:function(t,e){var n,o,s,r,a,h=["x","y"],l=h.length;for(n=0;n<l;n++)if(s=t[o=h[n]].mid,r=e[o].mid,a=(t[o].size+e[o].size)/2,i(s-r)>=a)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,i){var n=t.bbox(),o=e.bbox(),s=1e5,r=i||.5;if(n.x.size+n.y.size<r&&o.x.size+o.y.size<r)return[(s*(t._t1+t._t2)/2|0)/s+"/"+(s*(e._t1+e._t2)/2|0)/s];var a=t.split(.5),h=e.split(.5),l=[{left:a.left,right:h.left},{left:a.left,right:h.right},{left:a.right,right:h.right},{left:a.right,right:h.left}],c=[];return 0===(l=l.filter(function(t){return y.bboxoverlap(t.left.bbox(),t.right.bbox())})).length?c:(l.forEach(function(t){c=c.concat(y.pairiteration(t.left,t.right,r))}),c=c.filter(function(t,e){return c.indexOf(t)===e}))},getccenter:function(t,e,i){var s,a=e.x-t.x,h=e.y-t.y,l=i.x-e.x,c=i.y-e.y,d=a*n(p)-h*o(p),f=a*o(p)+h*n(p),g=l*n(p)-c*o(p),b=l*o(p)+c*n(p),v=(t.x+e.x)/2,m=(t.y+e.y)/2,_=(e.x+i.x)/2,w=(e.y+i.y)/2,S=v+d,x=m+f,I=_+g,T=w+b,k=y.lli8(v,m,S,x,_,w,I,T),C=y.dist(k,t),P=r(t.y-k.y,t.x-k.x),z=r(e.y-k.y,e.x-k.x),E=r(i.y-k.y,i.x-k.x);return P<E?((P>z||z>E)&&(P+=u),P>E&&(s=E,E=P,P=s)):E<z&&z<P?(s=E,E=P,P=s):E+=u,k.s=P,k.e=E,k.r=C,k}};t.utils=y}(BEZIER),function(t,e){"use strict";var i=Math.abs,n=Math.min,o=Math.max,s=Math.acos,r=Math.sqrt,a=Math.PI,h={x:0,y:0,z:0},l=t.utils,c=t.PolyBezier,u=function(t){var e=t&&t.forEach?t:[].slice.call(arguments),n=!1;if(this.points=[],this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.precision=100,this.calculateArcs(),"object"==typeof e[0]){n=e.length;var o=[],s=[];e.forEach(function(t){["x","y","z"].forEach(function(e){void 0!==t[e]&&o.push(t[e])}),s.push(t)}),e=o,this.points=s}var r=!1,a=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var h=!r&&(9===a||12===a)||t&&t[0]&&void 0!==t[0].z;this._3d=h,this.order=this.points.length-1;var c=["x","y"];h&&c.push("z"),this.dims=c,this.dimlen=c.length,function(t){for(var e=t.order,n=t.points,o=l.align(n,{p1:n[0],p2:n[e]}),s=0;s<o.length;s++)if(i(o[s].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()};function p(t,e,i,n,o){void 0===o&&(o=.5);var s=l.projectionratio(o,t),r=1-s,a={x:s*e.x+r*n.x,y:s*e.y+r*n.y},h=l.abcratio(o,t);return{A:{x:i.x+(i.x-a.x)/h,y:i.y+(i.y-a.y)/h},B:i,C:a}}u.fromSVG=function(t){var e=t.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat);return/[cq]/.test(t)?(e=e.map(function(t,i){return i<2?t:t+e[i%2]}),new u(e)):new u(e)},u.quadraticFromPoints=function(t,e,i,n){if(void 0===n&&(n=.5),0===n)return new u(e,e,i);if(1===n)return new u(t,e,e);var o=p(2,t,e,i,n);return new u(t,o.A,i)},u.cubicFromPoints=function(t,e,i,n,o){void 0===n&&(n=.5);var s=p(3,t,e,i,n);void 0===o&&(o=l.dist(e,s.C));var r=o*(1-n)/n,a=l.dist(t,i),h=(i.x-t.x)/a,c=(i.y-t.y)/a,d=o*h,f=o*c,y=r*h,g=r*c,b=e.x-d,v=e.y-f,m=e.x+y,_=e.y+g,w=s.A,S=w.x+(b-w.x)/(1-n),x=w.y+(v-w.y)/(1-n),I=w.x+(m-w.x)/n,T=w.y+(_-w.y)/n,k={x:t.x+(S-t.x)/n,y:t.y+(x-t.y)/n},C={x:i.x+(I-i.x)/(1-n),y:i.y+(T-i.y)/(1-n)};return new u(t,k,C,i)};var d=function(){return l};u.getUtils=d,u.prototype={getUtils:d,valueOf:function(){return this.toString()},toString:function(){return l.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,i=["M",e[0].x,e[0].y,2===this.order?"Q":"C"],n=1,o=e.length;n<o;n++)i.push(e[n].x),i.push(e[n].y);return i.join(" ")},update:function(){this.dpoints=[];for(var t=this.points,e=t.length,i=e-1;e>1;e--,i--){for(var n,o=[],s=0;s<i;s++)n={x:i*(t[s+1].x-t[s].x),y:i*(t[s+1].y-t[s].y)},this._3d&&(n.z=i*(t[s+1].z-t[s].z)),o.push(n);this.dpoints.push(o),t=o}this.computedirection(),this.calculateArcs()},computedirection:function(){var t=this.points,e=l.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return l.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(t=t||100,this._lut.length===t)return this._lut;this._lut=[];for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var i,n=this.getLUT(),o=[],s=0,r=0;r<n.length;r++)i=n[r],l.dist(i,t)<e&&(o.push(i),s+=r/n.length);return!!o.length&&s/o.length},project:function(t){var e=this.getLUT(),i=e.length-1,n=l.closest(e,t),o=n.mdist,s=n.mpos;if(0===s||s===i){var r=s/i,a=this.compute(r);return a.t=r,a.d=o,a}var h,c,u,p=(s+1)/i,d=.1/i;for(o+=1,h=r=(s-1)/i;r<p+d;r+=d)c=this.compute(r),(u=l.dist(t,c))<o&&(o=u,h=r);return(c=this.compute(h)).t=h,c.d=o,c},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){if(0===t)return this.points[0];if(1===t)return this.points[this.order];var e=this.points,i=1-t;if(1===this.order)return c={x:i*e[0].x+t*e[1].x,y:i*e[0].y+t*e[1].y},this._3d&&(c.z=i*e[0].z+t*e[1].z),c;if(this.order<4){var n,o,s,r=i*i,a=t*t,l=0;2===this.order?(e=[e[0],e[1],e[2],h],n=r,o=i*t*2,s=a):3===this.order&&(n=r*i,o=r*t*3,s=i*a*3,l=t*a);var c={x:n*e[0].x+o*e[1].x+s*e[2].x+l*e[3].x,y:n*e[0].y+o*e[1].y+s*e[2].y+l*e[3].y};return this._3d&&(c.z=n*e[0].z+o*e[1].z+s*e[2].z+l*e[3].z),c}for(var u=JSON.parse(JSON.stringify(this.points));u.length>1;){for(var p=0;p<u.length-1;p++)u[p]={x:u[p].x+(u[p+1].x-u[p].x)*t,y:u[p].y+(u[p+1].y-u[p].y)*t},void 0!==u[p].z&&(u[p]=u[p].z+(u[p+1].z-u[p].z)*t);u.splice(u.length-1,1)}return u[0]},raise:function(){for(var t,e,i=this.points,n=[i[0]],o=i.length,s=1;s<o;s++)t=i[s],e=i[s-1],n[s]={x:(o-s)/o*t.x+s/o*e.x,y:(o-s)/o*t.y+s/o*e.y};return n[o]=i[o-1],new u(n)},derivative:function(t){var e,i,n=1-t,o=0,s=this.dpoints[0];2===this.order&&(s=[s[0],s[1],h],e=n,i=t),3===this.order&&(e=n*n,i=n*t*2,o=t*t);var r={x:e*s[0].x+i*s[1].x+o*s[2].x,y:e*s[0].y+i*s[1].y+o*s[2].y};return this._3d&&(r.z=e*s[0].z+i*s[1].z+o*s[2].z),r},inflections:function(){return l.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),i=r(e.x*e.x+e.y*e.y);return{x:-e.y/i,y:e.x/i}},__normal3:function(t){var e=this.derivative(t),i=this.derivative(t+.01),n=r(e.x*e.x+e.y*e.y+e.z*e.z),o=r(i.x*i.x+i.y*i.y+i.z*i.z);e.x/=n,e.y/=n,e.z/=n,i.x/=o,i.y/=o,i.z/=o;var s={x:i.y*e.z-i.z*e.y,y:i.z*e.x-i.x*e.z,z:i.x*e.y-i.y*e.x},a=r(s.x*s.x+s.y*s.y+s.z*s.z);s.x/=a,s.y/=a,s.z/=a;var h=[s.x*s.x,s.x*s.y-s.z,s.x*s.z+s.y,s.x*s.y+s.z,s.y*s.y,s.y*s.z-s.x,s.x*s.z-s.y,s.y*s.z+s.x,s.z*s.z];return{x:h[0]*e.x+h[1]*e.y+h[2]*e.z,y:h[3]*e.x+h[4]*e.y+h[5]*e.z,z:h[6]*e.x+h[7]*e.y+h[8]*e.z}},hull:function(t){var e,i=this.points,n=[],o=[],s=0,r=0,a=0;for(o[s++]=i[0],o[s++]=i[1],o[s++]=i[2],3===this.order&&(o[s++]=i[3]);i.length>1;){for(n=[],r=0,a=i.length-1;r<a;r++)e=l.lerp(t,i[r],i[r+1]),o[s++]=e,n.push(e);i=n}return o},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var i=this.hull(t),n={left:2===this.order?new u([i[0],i[3],i[5]]):new u([i[0],i[4],i[7],i[9]]),right:2===this.order?new u([i[5],i[4],i[2]]):new u([i[9],i[8],i[6],i[3]]),span:i};return n.left._t1=l.map(0,0,1,this._t1,this._t2),n.left._t2=l.map(t,0,1,this._t1,this._t2),n.right._t1=l.map(t,0,1,this._t1,this._t2),n.right._t2=l.map(1,0,1,this._t1,this._t2),e?(e=l.map(e,t,1,0,1),n.right.split(e).left):n},extrema:function(){var t,e,i={},n=[];return this.dims.forEach(function(o){e=function(t){return t[o]},t=this.dpoints[0].map(e),i[o]=l.droots(t),3===this.order&&(t=this.dpoints[1].map(e),i[o]=i[o].concat(l.droots(t))),i[o]=i[o].filter(function(t){return t>=0&&t<=1}),n=n.concat(i[o].sort())}.bind(this)),n=n.sort().filter(function(t,e){return n.indexOf(t)===e}),i.values=n,i},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(i){e[i]=l.getminmax(this,i,t[i])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),i=t.bbox();return l.bboxoverlap(e,i)},offset:function(t,e){if(void 0!==e){var i=this.get(t),n=this.normal(t),o={c:i,n:n,x:i.x+n.x*e,y:i.y+n.y*e};return this._3d&&(o.z=i.z+n.z*e),o}if(this._linear){var s=this.normal(0),r=this.points.map(function(e){var i={x:e.x+t*s.x,y:e.y+t*s.y};return e.z&&n.z&&(i.z=e.z+t*s.z),i});return[new u(r)]}return this.reduce().map(function(e){return e.scale(t)})},simple:function(){if(3===this.order){var t=l.angle(this.points[0],this.points[3],this.points[1]),e=l.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}var n=this.normal(0),o=this.normal(1),r=n.x*o.x+n.y*o.y;return this._3d&&(r+=n.z*o.z),i(s(r))<a/3},reduce:function(){var t,e,n=0,o=0,s=[],r=[],a=this.extrema().values;for(-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1),n=a[0],t=1;t<a.length;t++)o=a[t],(e=this.split(n,o))._t1=n,e._t2=o,s.push(e),n=o;return s.forEach(function(t){for(n=0,o=0;o<=1;)for(o=n+.01;o<=1.01;o+=.01)if(!(e=t.split(n,o)).simple()){if(i(n-(o-=.01))<.01)return[];(e=t.split(n,o))._t1=l.map(n,0,1,t._t1,t._t2),e._t2=l.map(o,0,1,t._t1,t._t2),r.push(e),n=o;break}n<1&&((e=t.split(n,1))._t1=l.map(n,0,1,t._t1,t._t2),e._t2=t._t2,r.push(e))}),r},scale:function(t){var e=this.order,i=!1;if("function"==typeof t&&(i=t),i&&2===e)return this.raise().scale(i);var n=this.clockwise,o=i?i(0):t,s=i?i(1):t,a=[this.offset(0,10),this.offset(1,10)],h=l.lli4(a[0],a[0].c,a[1],a[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");var c=this.points,p=[];return[0,1].forEach(function(t){var i=p[t*e]=l.copy(c[t*e]);i.x+=(t?s:o)*a[t].n.x,i.y+=(t?s:o)*a[t].n.y}.bind(this)),i?([0,1].forEach(function(o){if(2!==this.order||!o){var s=c[o+1],a={x:s.x-h.x,y:s.y-h.y},l=i?i((o+1)/e):t;i&&!n&&(l=-l);var u=r(a.x*a.x+a.y*a.y);a.x/=u,a.y/=u,p[o+1]={x:s.x+l*a.x,y:s.y+l*a.y}}}.bind(this)),new u(p)):([0,1].forEach(function(t){if(2!==this.order||!t){var i=p[t*e],n=this.derivative(t),o={x:i.x+n.x,y:i.y+n.y};p[t+1]=l.lli4(i,o,h,c[t+1])}}.bind(this)),new u(p))},outline:function(t,e,i,n){e=void 0===e?t:e;var o,s=this.reduce(),r=s.length,a=[],h=[],u=0,p=this.length(),d=void 0!==i&&void 0!==n;function f(t,e,i,n,o){return function(s){var r=n/i,a=(n+o)/i,h=e-t;return l.map(s,0,1,t+r*h,t+a*h)}}s.forEach(function(o){S=o.length(),d?(a.push(o.scale(f(t,i,p,u,S))),h.push(o.scale(f(-e,-n,p,u,S)))):(a.push(o.scale(t)),h.push(o.scale(-e))),u+=S}),h=h.map(function(t){return(o=t.points)[3]?t.points=[o[3],o[2],o[1],o[0]]:t.points=[o[2],o[1],o[0]],t}).reverse();var y=a[0].points[0],g=a[r-1].points[a[r-1].points.length-1],b=h[r-1].points[h[r-1].points.length-1],v=h[0].points[0],m=l.makeline(b,y),_=l.makeline(g,v),w=[m].concat(a).concat([_]).concat(h),S=w.length;return new c(w)},outlineshapes:function(t,e,i){e=e||t;for(var n=this.outline(t,e).curves,o=[],s=1,r=n.length;s<r/2;s++){var a=l.makeshape(n[s],n[r-s],i);a.startcap.virtual=s>1,a.endcap.virtual=s<r/2-1,o.push(a)}return o},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof u&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=n(t.p1.x,t.p2.x),i=n(t.p1.y,t.p2.y),s=o(t.p1.x,t.p2.x),r=o(t.p1.y,t.p2.y),a=this;return l.roots(this.points,t).filter(function(t){var n=a.get(t);return l.between(n.x,e,s)&&l.between(n.y,i,r)})},selfintersects:function(t){var e,i,n,o,s=this.reduce(),r=s.length-2,a=[];for(e=0;e<r;e++)n=s.slice(e,e+1),o=s.slice(e+2),i=this.curveintersects(n,o,t),a=a.concat(i);return a},curveintersects:function(t,e,i){var n=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&n.push({left:t,right:e})})});var o=[];return n.forEach(function(t){var e=l.pairiteration(t.left,t.right,i);e.length>0&&(o=o.concat(e))}),o},arcs:function(t){t=t||.5;return this._iterate(t,[])},_error:function(t,e,n,o){var s=(o-n)/4,r=this.get(n+s),a=this.get(o-s),h=l.dist(t,e),c=l.dist(t,r),u=l.dist(t,a);return i(c-h)+i(u-h)},_iterate:function(t,e){var i,n=0,o=1;do{i=0,o=1;var s,r,a,h,c,u=this.get(n),p=!1,d=!1,f=o,y=1;do{if(d=p,h=a,f=(n+o)/2,0,s=this.get(f),r=this.get(o),(a=l.getccenter(u,s,r)).interval={start:n,end:o},p=this._error(a,u,n,o)<=t,(c=d&&!p)||(y=o),p){if(o>=1){a.interval.end=y=1,h=a;break}o+=(o-n)/2}else o=f}while(!c&&i<100);if(++i>=100)break;h=h||a,e.push(h),n=y}while(o<1);return e},map:function(t){for(var e=t*this.arcLengths[this.precision],i=0,n=this.precision,o=0;i<n;)o=i+((n-i)/2|0),this.arcLengths[o]<e?i=o+1:n=o;this.arcLengths[o]>e&&o--;var s=this.arcLengths[o];return s===e?o/this.precision:(o+(e-s)/(this.arcLengths[o+1]-s))/this.precision},mx:function(t){return this.x(this.map(t))},my:function(t){return this.y(this.map(t))},x:function(t){return(1-t)*(1-t)*(1-t)*this.a.x+(1-t)*(1-t)*3*t*this.b.x+3*(1-t)*(t*t)*this.c.x+t*t*t*this.d.x},y:function(t){return(1-t)*(1-t)*(1-t)*this.a.y+(1-t)*(1-t)*3*t*this.b.y+3*(1-t)*(t*t)*this.c.y+t*t*t*this.d.y},getEqual:function(t){return{x:this.mx(t),y:this.my(t)}},calculateArcs:function(){this.arcLengths=new Array(this.precision+1),this.arcLengths[0]=0;for(var t=this.x(0),e=this.y(0),i=0,n=1;n<=this.precision;n+=1){var o=this.x(.01*n),s=this.y(.01*n),r=t-o,a=e-s;i+=Math.sqrt(r*r+a*a),this.arcLengths[n]=i,t=o,e=s}this.totalLength=i}},t.Bezier=u}(BEZIER),function(t,e){"use strict";var i=t.utils,n=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};n.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(t){return i.pointsToString(t.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,e=t[0].bbox(),n=1;n<t.length;n++)i.expandbox(e,t[n].bbox());return e},offset:function(t){var e=[];return this.curves.forEach(function(i){e=e.concat(i.offset(t))}),new n(e)}},t.PolyBezier=n}(BEZIER),function(t,e){function i(t){this.initialize(t)}i.prototype.initialize=function(t){this.hex_code=t,t>16777215?(this.alpha=t>>>24,this.a=t>>>24):(this.alpha=255,this.a=t>>>255),this.red=t>>16&255,this.green=t>>8&255,this.blue=255&t,this.r=t>>16&255,this.g=t>>8&255,this.b=255&t},i.hex_to_color_32=function(t){return(t>16777215?t>>>24:t>>>255)<<24|(t>>16&255)<<16|(t>>8&255)<<8|255&t},i.get_color_32=function(t,e,i,n){return t<<24|e<<16|i<<8|n},i.hex_to_number=function(t){t=t.replace("#","0x");return t=PIXI.utils.hex2rgb(t),t=i.get_color_32(1,255*t[0],255*t[1],255*t[2])},t.Color=i}(window),function(window,undefined){function Constraint(t,e,i){this.initialize(t,e,i)}Constraint.prototype.initialize=function(t,e,i){this.value=i||"",this.isValid=!1,this.parent=null,this.parentID=null,this.propertyName=e,this._originalParentID=null,this.children=[],this.evaluatedValue=null,this.object=t,this._isRoot=!0,this.isMethod=!1,this.parse(this.value)},Constraint.prototype.parse=function(t){if(this.value=t,this.value){var e=!1,i="";this.isValid=!0;for(var n=0;n<this.value.length;n++){var o=this.value[n];"["===o?(e=!0,i=""):"]"===o?(e=!1,this.parentID=i,this._originalParentID=this.parentID.replace(/\s\s+/g,"")):e&&(i+=o)}this.isValid=this.resolve()}else this.isValid=!1},Constraint.prototype.resolve=function(){var evalString=this.value||"";if(this.parent){var rx=new RegExp("\\["+this._originalParentID+"\\]","g");evalString=evalString.replace(rx,"this.parent")}evalString=evalString.replace(/\.width/g,".w_idth"),evalString=evalString.replace(/\.height/g,".h_eight"),evalString=evalString.replace(/width/g,"this.object._width"),evalString=evalString.replace(/height/g,"this.object._height"),evalString=evalString.replace(/\.w_idth/g,".width"),evalString=evalString.replace(/\.h_eight/g,".height");try{var x=eval("'use strict'; "+evalString);return"number"==typeof x&&(!isNaN(x)&&(this.evaluatedValue=x,!0))}catch(t){return!1}},window.Constraint=Constraint}(window),function(window,undefined){function ConstraintMethod(t,e,i){this.initialize(t,e,i)}ConstraintMethod.prototype.initialize=function(t,e,i){this.value=i,this.args=[],this.isValid=!1,this.parent=null,this.parentID=null,this.methodName=e,this._originalParentID=null,this.children=[],this.object=t,this._isRoot=!0,this.isMethod=!0,this.requiredArguments=2,this.evaluatedValues=[],Array.isArray(i)?(this.value=i.join(","),this.args=i):this.parse(this.value)},ConstraintMethod.prototype.parseLine=function(t){if(t){var e=!1,i="";this.isValid=!0;for(var n=t.split(),o=0;o<n.length;o++){var s=n[o];"["===s?(e=!0,i=""):"]"===s?(e=!1,this.parentID=i,this._originalParentID=this.parentID.replace(/\s\s+/g,"")):e&&(i+=s)}var r=this.prepString(t);this.args.push(r),this.isValid=this.resolveArgument(r)}else this.isValid=!1},ConstraintMethod.prototype.parse=function(t){for(var e=t.trim().split(","),i=0;i<e.length;i++){var n=e[i];this.parseLine(n)}},ConstraintMethod.prototype.prepString=function(t){var e=t||"";if(this.parent){var i=new RegExp("\\["+this._originalParentID+"\\]","g");e=e.replace(i,"this.parent")}return e=(e=(e=(e=(e=(e=e.replace(/\.width/g,".w_idth")).replace(/\.height/g,".h_eight")).replace(/width/g,"this.object._width")).replace(/height/g,"this.object._height")).replace(/\.w_idth/g,".width")).replace(/\.h_eight/g,".height")},ConstraintMethod.prototype.resolve=function(){return this.args=[],this.evaluatedValues=[],this.parse(this.value),this.args.length===this.evaluatedValues.length&&this.args.length===this.requiredArguments},ConstraintMethod.prototype.applyMethod=function(){if(this.args.length===this.evaluatedValues.length&&this.args.length===this.requiredArguments){var evalStr="this.object."+this.methodName+"("+this.evaluatedValues.join(",")+")";try{return eval("'use strict'; "+evalStr),!0}catch(t){return console.error(t),!1}}else console.warn("Can't apply constraint , it has invalid arguments");return!1},ConstraintMethod.prototype.resolveArgument=function(argument){try{var x=eval("'use strict'; "+argument);return"number"==typeof x&&(!isNaN(x)&&(this.evaluatedValues.push(x),!0))}catch(t){return!1}},window.ConstraintMethod=ConstraintMethod}(window),function(t,e){function i(t){this.initialize(t)}i.prototype.initialize=function(t){this.screen=t,this.constraints=[],this.ignore=!1,this._import(),this.rebuildDependencyTree(),this.applyValues()},i.prototype._import=function(t){t=t||this.screen.children;for(var e=0;e<t.length;e++){var i=t[e];this.add(i.constraintX),this.add(i.constraintY),this.add(i.constraintWidth),this.add(i.constraintHeight),this.add(i.constraintFit),this.add(i.constraintFill),this._import(i.children)}},i.prototype.add=function(t){if(t){for(var e=0;e<this.constraints.length;e++){var i=this.constraints[e];if(i.object.id===t.object.id&&i.propertyName===t.propertyName){i.parse(t.value);break}}this.constraints.push(t)}},i.prototype.remove=function(t){for(var e=this.constraints.length-1;e>=0;e--){var i=this.constraints[e];i.object.id===t.object.id&&i.propertyName===t.propertyName&&this.constraints.removeElement(i)}},i.prototype.clear=function(){this.constraints=[]},i.prototype.rebuildDependencyTree=function(){for(var t=0;t<this.constraints.length;t++){(n=this.constraints[t]).children=[],n.parent=this.screen.findById(n.parentID)}for(var e=0;e<this.constraints.length-1;e++){var i=this.constraints[e];for(t=e+1;t<this.constraints.length;t++){var n=this.constraints[t];i.parent&&i.parent.id===n.object.id&&n.propertyName===i.propertyName?(n.children.push(i),i._isRoot=!1):n.parent&&i.object.id===n.parent.id&&n.propertyName===i.propertyName&&(i.children.push(n),n._isRoot=!1)}}},i.prototype.applyValues=function(t){if(!this.ignore||t)for(var e=0;e<this.constraints.length;e++){var i=this.constraints[e];i._isRoot&&(i.resolve(),i.isMethod?i.applyMethod():null!==i.evaluatedValue&&(i.object[i.propertyName]=i.evaluatedValue),this._applyValues(i.children))}},i.prototype._applyValues=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.resolve(),i.isMethod?i.applyMethod():null!==i.evaluatedValue&&(i.object[i.propertyName]=i.evaluatedValue),this._applyValues(i.children)}},t.Constraints=i}(window),function(t,e){function i(){this.initialize()}i.prototype.initialize=function(){},i.set=function(t,e,i){i=i||90;var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);var o="expires="+n.toUTCString();document.cookie=t+"="+JSON.stringify(e)+"; "+o},i.get=function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(e))return JSON.parse(o.substring(e.length,o.length))}return null},i.delete=function(t){i.set(t,"",-100)},t.Cookies=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype.initialize=function(e){this.app=e,this.isMobile=PIXI.utils.isMobile,this.isTouch=!1,this.isIE=!1,this.isFullScreen=!1,this.isLocalhost="localhost"===location.hostname||"127.0.0.1"===location.hostname,this.isHandheld=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream,this.readTouchDevice(),this.readIE(),this.calculateSizes();var i=this;t.addEventListener("webkitfullscreenchange",function(t){i.fullscreenCallback()}),t.addEventListener("mozfullscreenchange",function(t){i.fullscreenCallback()}),t.addEventListener("fullscreenchange",function(t){i.fullscreenCallback()}),t.addEventListener("MSFullscreenChange",function(t){i.fullscreenCallback()}),t.addEventListener("resize",function(t){setTimeout(function(){i.app.resize()},16)}),this.browsers={isChrome:null,isExplorer:null,isFirefox:null,isSafari:null,isOpera:null},this.detectBrowsers()},i.prototype.detectBrowsers=function(){var t=navigator.userAgent,e=t.indexOf("Chrome")>-1||t.indexOf("CriOS")>-1,i=t.indexOf("MSIE")>-1,n=t.indexOf("Firefox")>-1,o=t.indexOf("Safari")>-1,s=t.toLowerCase().indexOf("op")>-1;e&&o&&(o=!1),e&&s&&(e=!1),this.browsers={isChrome:e,isExplorer:i,isFirefox:n,isSafari:o,isOpera:s}},i.prototype.readTouchDevice=function(){this.isTouch="ontouchstart"in t||navigator.maxTouchPoints},i.prototype.calculateSizes=function(){var t=Config.game_width,e=Config.game_height,i=Config.window_mode,n=this.windowSize();this.app.windowWidth=n.width,this.app.windowHeight=n.height,this.app.canvasWidth=Math.ceil(n.width),this.app.canvasHeight=Math.ceil(n.height);var o=n.width/n.height;if(i===Config.MODE_FLEXIBLE_WIDTH)this.app.height=e,this.app.width=e*o;else if(i===Config.MODE_FLEXIBLE_HEIGHT)this.app.width=t,this.app.height=t/o;else if(i===Config.MODE_STRETCH)this.app.width=t,this.app.height=e;else if(i===Config.MODE_CENTERED){this.app.width=t,this.app.height=e;var s=t/e;o>=t/e?(this.app.canvasWidth=Math.ceil(n.height*s),this.app.canvasHeight=Math.ceil(n.height)):(this.app.canvasWidth=Math.ceil(n.width),this.app.canvasHeight=Math.ceil(n.width/s))}else if(i===Config.MODE_NONE)this.app.canvasWidth=Math.ceil(t),this.app.canvasHeight=Math.ceil(e),this.app.width=t,this.app.height=e;else if(i===Config.MODE_PADDING){var r=Config.canvas_padding.split(" ");this.app.canvasWidth=n.width-Math.round(r[1])-Math.round(r[3]),this.app.canvasHeight=n.height-Math.round(r[0])-Math.round(r[2]);var a=this.app.canvasWidth/this.app.canvasHeight;this.app.width=e*a,this.app.height=e}},i.prototype.windowSize=function(){var e=t,i="inner";return"innerWidth"in t||(i="client",e=document.documentElement||document.body),{width:e[i+"Width"],height:e[i+"Height"]}},i.prototype.readIE=function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return this.isIE=parseInt(e.substring(i+5,e.indexOf(".",i)),10),this.isIE;if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return this.isIE=parseInt(e.substring(n+3,e.indexOf(".",n)),10),this.isIE}var o=e.indexOf("Edge/");return o>0?(this.isIE=parseInt(e.substring(o+5,e.indexOf(".",o)),10),this.isIE):(this.isIE=!1,this.isIE)},i.prototype.isRetina=t.devicePixelRatio>1||!(!t.matchMedia||!t.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx)").matches),i.prototype.goFullScreen=function(){if(!this.isFullScreen){this.isFullScreen=!0;var t=document.body;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},i.prototype.canGoFullScreen=function(){var t=document.body;return!!t.requestFullscreen||(!!t.msRequestFullscreen||(!!t.mozRequestFullScreen||!!t.webkitRequestFullscreen))},i.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},i.prototype.fullscreenCallback=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?this.isFullScreen=!0:this.isFullScreen=!1},t.Device=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype.initialize=function(t,e,i,n){this.emissionPoint=t,this.layer=e,this.particleClass=i,this.frequency=n,this.timePassed=0,this.particlesCount=0,this.freeParticles=[],this.isRunning=!1},i.prototype.reset=function(){this.timePassed=0,this.particlesCount=0},i.prototype.getParticle=function(){if(0===this.freeParticles.length){var t=new this.particleClass;t.emitter=this,this.freeParticles.push(t)}return this.freeParticles.pop()},i.prototype.recycleParticle=function(t){t.removeFromParent(),this.freeParticles.push(t)},i.prototype.start=function(){this.isRunning||(this.isRunning=!0,Actions.add(this))},i.prototype.run=function(){this.isRunning||(this.isRunning=!0,Actions.add(this))},i.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,Actions.remove(this))},i.prototype.step=function(t){this.timePassed+=t;var e=Math.round(this.timePassed*this.frequency),i=e-this.particlesCount;this.particlesCount=e;for(var n=0;n<i;n++){var o=this.getParticle();if(o.reset(),o.position.set(this.emissionPoint.x,this.emissionPoint.y),!this.layer)throw"Please set the layer for the particle engine,better do that in the 'on_added_to_parent()' method";this.layer.addChild(o),o.onEmmitted(this.layer)}},t.Emitter=i}(window),Array.matrix=function(t,e,i){var n,o,s,r=[];for(o=0;o<t;o+=1){for(n=[],s=0;s<e;s+=1)n[s]=i;r[o]=n}return r},Math.getDistance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},Math.getAngle=function(t,e){return null===t||null===e?0:Math.atan2(e.y-t.y,e.x-t.x)},Math.getDistanceFromLine=function(t,e,i){var n=i.x-e.x,o=i.y-e.y,s=n*n+o*o,r=(t.x-e.x)*n+(t.y-e.y)*o,a=Math.min(1,Math.max(0,r/s));r=(i.x-e.x)*(t.y-e.y)-(i.y-e.y)*(t.x-e.x);var h={x:e.x+n*a,y:e.y+o*a};return Math.getDistance(t,h)},Math.insertionSort=function(t,e){for(var i,n,o=0;o<t.length;++o){for(n=t[o],i=o-1;i>=0&&e(t[i],n);--i)t[i+1]=t[i];t[i+1]=n}},Math.bubbleSort=function(t,e){var i;do{i=!1;for(var n=0;n<t.length-1;n++)if(e(t[n],t[n+1])){var o=t[n];t[n]=t[n+1],t[n+1]=o,i=!0}}while(i)},Math.degreesToRadians=function(t){return t/180*Math.PI},Math.radiansToDegrees=function(t){return 180*t/Math.PI},Math.randomFloat=function(t,e){return t+Math.random()*(e-t)},Math.randomInt=function(t,e){return Math.floor(t+Math.random()*(e-t+1))},Math.inRange=function(t,e,i){return t>=Math.min(e,i)&&t<=Math.max(e,i)},Math.normalize=function(t,e,i){return(t-e)/(i-e)},Math.lerp=function(t,e,i){return(i-e)*t+e},Math.map=function(t,e,i,n,o){return Math.lerp(Math.normalize(t,e,i),n,o)},Math.clamp=function(t,e,i){return Math.min(Math.max(t,Math.min(e,i)),Math.max(e,i))},Math.roundDecimal=function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},void 0===log)function log(t){console.log(t)}function trace(t){console.trace(t)}function toHHMMSS(t){var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),n=t-3600*e-60*i;return e<10&&(e="0"+e),i<10&&(i="0"+i),n<10&&(n="0"+n),e+":"+i+":"+n}function toMMSS(t){var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),n=t-3600*e-60*i;return e<10&&(e="0"+e),i<10&&(i="0"+i),n<10&&(n="0"+n),i+":"+n}function timeout(t,e,i,n){var o=new Timer(t,e,i);return n=n||0,o.run(n),o}function serialize(t,e){var i=[];for(var n in t)if(t.hasOwnProperty(n)){var o=e?e+"["+n+"]":n,s=t[n];i.push("object"==typeof s?serialize(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return i.join("&")}function createAjax(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}function ajaxGet(t,e,i){var n=createAjax();if(i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&n.setRequestHeader(o,i[o]);n.onreadystatechange=function(){4===n.readyState&&(200===n.status?(n.getResponseHeader("content-type")||"").indexOf("json")>-1?e(JSON.parse(n.responseText),n):e(n.responseText,n):e&&e(null,n))},n.open("GET",t,!0),n.send()}function ajaxPost(t,e,i,n){var o=createAjax();if(o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){if(i)if((o.getResponseHeader("content-type")||"").indexOf("json")>-1){var t=o.responseText;try{t=JSON.parse(o.responseText)}catch(e){t=o.responseText}i(t,o)}else i(o.responseText,o)}else i&&i(null,o)},o.open("POST",t,!0),n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&o.setRequestHeader(s,n[s]);else o.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(e instanceof FormData)o.send(e);else{var r=serialize(e);o.send(r)}}function lang(t){var e=Localization.instance().text[t];return e||t}function shuffleArray(t){for(var e,i,n=t.length;0!==n;)i=Math.floor(Math.random()*n),e=t[n-=1],t[n]=t[i],t[i]=e;return t}function treatAsUTC(t){var e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}function daysBetween(t,e){return(treatAsUTC(e)-treatAsUTC(t))/864e5}function createPointsInSpace(t,e,i,n,o){for(var s=o||250,r=0,a=[],h=new V(e/2,i/2),l=0;r<t;){var c=!0,u=new V(Math.randomInt(0,e),Math.randomInt(0,i));++l>1e3&&s--;for(var p=0;p<a.length;p++){var d=a[p];if(Math.getDistance(u,d)<s){c=!1;break}}n&&Math.getDistance(u,h)<350&&(c=!1),c&&(r++,a.push(u))}return a}function getQueryString(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function leadingZeros(t,e){for(var i=t+"";i.length<e;)i="0"+i;return i}function shorten(t,e,i){for(var n="",o=[" ",",",".","!","?"],s=0,r=0;r<t.length;r++)if(n+=t[r],-1!==o.indexOf(t[r])&&(++s>=e||r>=i)){n+="...";break}return n}function googleAnalytics(t){app.device.isLocalhost?log("localhost pageview : "+t):window._gTagID?gtag("config",_gTagID,{page_path:t}):console.warn("SaberJS: You need to define a global variable _gTagID")}function inArray(t,e){return-1!==t.indexOf(e)}function convertColor(t){if("transparent"===t||"#ffffff"===t||"#FFFFFF"===t)return 16777215;var e=t||"";return e=e.replace("#","0x"),e=PIXI.utils.hex2rgb(e),Color.get_color_32(1,255*e[0],255*e[1],255*e[2])}function getDateByTimeZone(t){t=t||0;var e=new Date,i=e.getTime()+6e4*e.getTimezoneOffset();return new Date(i+36e5*t)}function isDateBetween(t,e,i){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n>=e&&n<=i}function applyToConstructor(t,e){var i=[null].concat(e);return new(t.bind.apply(t,i))}function uuid(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?i:3&i|8).toString(16)})}function numberWithCommas(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}function isEmpty(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)},String.prototype.startsWith=function(t){return 0===this.indexOf(t)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Object.defineProperty(Array.prototype,"removeElement",{enumerable:!1,value:function(t){for(var e=0,i=0;i<this.length;i++)this[i]===t&&(this.splice(i,1),e++,i--);return e}}),Object.defineProperty(Array.prototype,"getRandom",{enumerable:!1,value:function(){return this[Math.randomInt(0,this.length-1)]}}),String.prototype.supplant=function(t){return this.replace(/{([^{}]*)}/g,function(e,i){var n=t[i];return"string"==typeof n||"number"==typeof n?n:e})},String.prototype.smartShort=function(t,e){if(e=e||20,0===t)return this.substr(0,e-3)+"...";var i=shorten(this,t,e);return i.length>e?this.smartShort(t-1,e):i},function(window,undefined){function Importer(t){this.initialize(t)}Importer.prototype.initialize=function(t){this.inputs=[],this.screen=t,this.content=null,this.resolveConstraints=!0,this.objects=null},Importer.prototype.dataToObject=function(t){var e=this.unwrapObject(t,null);return t.children&&t.children.length&&this.importChildren(e,t.children),e},Importer.prototype.findDataById=function(t,e){e=e||this.objects;for(var i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n;var o=this.findDataById(t,n.children);if(o)return o}return null},Importer.prototype.findDataByType=function(t,e,i){e=e||this.objects,i=i||[];for(var n=0;n<e.length;n++){var o=e[n];o.type===t&&i.push(o),this.findDataByType(t,o.children,i)}return i.length?i:null},Importer.prototype.findDataByClassName=function(t,e,i){e=e||this.objects,i=i||[];for(var n=0;n<e.length;n++){var o=e[n];o.className===t&&i.push(o),this.findDataByClassName(t,o.children,i)}return i.length?i:null},Importer.prototype.findDataByTag=function(t,e,i){e=e||this.objects,i=i||[];for(var n=0;n<e.length;n++){var o=e[n];o.tag===t&&i.push(o),this.findDataByTag(t,o.children,i)}return i.length?i:null},Importer.prototype.findDataByMethod=function(t,e,i){e=e||this.objects,i=i||[];for(var n=0;n<e.length;n++){var o=e[n];t(o)&&i.push(o),this.findDataByMethod(t,o.children,i)}return i.length?i:null},Importer.prototype.importObjects=function(t,e){this.content=e,this.objects=t;for(var i=0;i<t.length;i++){var n=t[i],o=this.unwrapObject(n,e);o&&e.addChild(o),n.children&&n.children.length&&this.importChildren(o,n.children)}this.screen.constraints.rebuildDependencyTree(),this.screen.constraints.applyValues();for(i=0;i<this.inputs.length;i++)this.screen.addTouchable(this.inputs[i]);this.propagateImport(this.content.children)},Importer.prototype.propagateImport=function(t){for(var e=t.length-1;e>=0;e--){var i=t[e];i.onImport&&i.onImport(),i.onImportFinished&&i.onImportFinished(),this.propagateImport(i.children)}},Importer.prototype.importChildren=function(t,e){for(var i=[],n=0;n<e.length;n++){var o=e[n],s=this.unwrapObject(o,t);if(s){if(s instanceof InputField&&this.addInputToParent(s,t),t.addChild(s),"ViewComponentObject"===o.type&&o.properties.view_name&&ContentManager.jsons[o.properties.view_name]){for(var r=ContentManager.jsons[o.properties.view_name],a=0;a<r.objects.length;a++){var h=r.objects[a];h.name="view"+h.name}this.importChildren(s,r.objects)}o.children&&o.children.length&&this.importChildren(s,o.children),i.push(s)}}return i},Importer.prototype.addInputToParent=function(t,e){e instanceof InputContent?e.addInput(t):e.parent&&this.addInputToParent(t,e.parent)},Importer.prototype.unwrapObject=function(data,parent){var object=null;if(data.properties&&data.properties.isCustomSensor)return this.setCustomSensor(data,parent),null;if(data.className){if("CustomSensor"===data.className||"CustomBounds"===data.className)return this.setCustomSensor(data,parent),null;if(!window[data.className])return console.warn('Class: "'+data.className+'" is not defined!'),new Sprite;object=new window[data.className],object.mode="app",object.setData&&object.setData(data,this.extract,this),object.enableSensor()}else if("ImageObject"!==data.type||this._customImport)if("LabelObject"===data.type){var style=this.createStyle(data);object=new Label(style),object.txt=data.txt}else if("ButtonObject"===data.type){var props=this.createProperties(data),style=this.createStyle(data),type=props.isNineSlice?Button.TYPE_NINE_SLICE:Button.TYPE_NORMAL;object=new Button(data.txt,{properties:props,style:style,type:type}),this.inputs.push(object);for(var events=["onMouseDown","onMouseMove","onMouseUp","onMouseCancel"],i=0;i<events.length;i++){var eventName=events[i];if(props[eventName])if(this.screen[props[eventName]])object[eventName]=this.screen[props[eventName]].bind(this.screen);else if(props[eventName].startsWith("fn ")||props[eventName].startsWith("fn:")){var fnCode=props[eventName].substring(3);object[eventName]=function(event,sender){try{eval(fnCode)}catch(t){console.error("You have defined an invalid function code!"),console.error(t)}}.bind(this.screen)}else console.warn("undeclared method:"+props[eventName]+" from imported button")}}else if("Layer"===data.type)data.isInputContent?(object=new InputContent(this.screen),this.inputs.push(object)):object=new Layer,object.name=data.name,object.factor=Number(data.factor);else if("InputObject"===data.type){var props=this.createProperties(data),style=this.createStyle(data);style.background=data.backgroundName,object=new InputField(style,parseInt(props.input_type)||InputField.TYPE_ALL),object.setSize(props.width,props.height),object.hasNext=props.hasNext,object.doneText=props.doneText||null,object.scrollToY=props.scrollTo||0,props.hasPlaceholder&&object.setPlaceholder(data.txt)}else if("GenericObject"===data.type)object=new Sprite,object.enableSensor();else if("ContainerObject"===data.type)object=new Sprite,object.enableSensor();else if("PolygonObject"===data.type){object=new Sprite,object.enableSensor();for(var points=[],i=0;i<data.points.length;i++){var p=(new V).copy(data.points[i]);points.push(p)}var polygon=new SAT.Polygon(new V,points);object.enableSensor(),object.setCustomSensor(polygon)}else if("GenericPoint"===data.type)object=new Sprite,object.enableSensor();else if("PathObject"===data.type)object=new PolyBezier,object.build(data);else if("NineSliceObject"===data.type){var props=this.createProperties(data);object=new NineSlice(props.backgroundName,props.padding.toString(),props.width,props.height),object.tint=convertColor(props.tintColor)}else if("TilingSpriteObject"===data.type){var props=this.createProperties(data),texture=Sprite.prototype.findTexture.call(this,props.backgroundName);object=new PIXI.TilingSprite(texture),object.width=props.width,object.height=props.height,object.tilePosition.set(props.tilePositionX,props.tilePositionY),object.tileScale.set(props.tileScaleX,props.tileScaleY)}else this._customImport&&(object=this._customImport(data));else object=new Sprite(data.imageName),object.enableSensor();return object||(object=new Sprite,object.enableSensor()),data.position&&object.position.set(data.position.x,data.position.y),object.anchor&&(data.anchor?object.anchor.set(data.anchor.x,data.anchor.y):object.anchor.set(.5,.5)),data.scale&&object.scale.set(data.scale.x,data.scale.y),data.tag&&(object.tag=data.tag),data.zIndex&&(object.zIndex=data.zIndex),data.rotation&&(object.rotation=data.rotation),data.alpha!==undefined&&(object.alpha=data.alpha),object.visible=data.visible===undefined||data.visible,data.id!==undefined?(object.id=data.id,object.id=object.id.toLowerCase()):object.id=PIXI.utils.uid(),"NineSliceObject"!==data.type&&(object.tint=data.tint||16777215),data.properties&&data.properties._custom&&(object._properties=data.properties._custom),this.resolveConstraints&&(data.constraintX&&(object.constraintX=new Constraint(object,"x",data.constraintX),this.screen.constraints.add(object.constraintX)),data.constraintY&&(object.constraintY=new Constraint(object,"y",data.constraintY),this.screen.constraints.add(object.constraintY)),data.constraintWidth&&(object.constraintWidth=new Constraint(object,"width",data.constraintWidth),this.screen.constraints.add(object.constraintWidth)),data.constraintHeight&&(object.constraintHeight=new Constraint(object,"height",data.constraintHeight),this.screen.constraints.add(object.constraintHeight)),data.constraintFit&&(object.constraintFit=new ConstraintMethod(object,"fitTo",data.constraintFit),this.screen.constraints.add(object.constraintFit)),data.constraintFill&&(object.constraintFill=new ConstraintMethod(object,"fillOut",data.constraintFill),this.screen.constraints.add(object.constraintFill))),this._customBuild&&this._customBuild(object,data),object},Importer.prototype.extract=function(t,e){if(e.properties&&e.properties._custom)for(var i=0;i<e.properties._custom.length;i++){var n=e.properties._custom[i];if(n.key===t)return n.value}return null},Importer.prototype.setCustomSensor=function(t,e){e.enableSensor(),e.getSensor();for(var i=[],n=t.position,o=0;o<t.points.length;o++){var s=(new V).copy(t.points[o]);s.x+=e._width*e.anchor.x+n.x,s.y+=e._height*e.anchor.y+n.y,i.push(s)}var r=new SAT.Polygon((new V).copy(t.position),i);e.setCustomSensor(r)},Importer.prototype.applyValues=function(t,e){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i];t[i]=n}},Importer.prototype.createStyle=function(t){var e={};if(this.applyValues(e,Default.stylesClean[t.type]),t.styleName){var i=Styles.types[t.type][t.styleName];i?this.applyValues(e,i.style):console.warn("Style: "+t.styleName+" not found")}return this.applyValues(e,t.style||{}),e},Importer.prototype.createProperties=function(t){var e={};if(this.applyValues(e,Default.properties[t.type]),t.styleName){var i=Styles.types[t.type][t.styleName];i?this.applyValues(e,i.properties):console.warn("Style: "+t.styleName+" not found")}return this.applyValues(e,t.properties),e},window.Importer=Importer}(window),function(t,e){function i(){throw"can't initialize Layout"}i.hbox=function(t,e,i,n,o,s,r,a,h){o=void 0!==o?o:10,s=s||"bottom",i=i||0,n=n||0,r=void 0===r||r,e=e||800,a=a||o;for(var l=o,c=o,u=0,p=0,d=0;d<t.length;d++)u=Math.max(u,t[d]._height);var f=0,y=[],g=[];for(d=0;d<t.length;d++){var b=t[d];r&&l+b._width+o>e&&(l=o,c+=u+a,y.push(g),g=[]),g.push(b),"bottom"===s?p=u-b._height:"center"===s&&(p=(u-b._height)/2);var v=null;h&&(v=h(b)),v&&v.spacing&&(l+=v.spacing),b.position.set(l+i,c+p+n),f=(l+=b._width+o)>f?l:f,v&&v.is_break&&(l=o,c+=u+a)}return-1===y.indexOf(g)&&y.push(g),s.startsWith("compact")&&this.squize(y,u,a),{width:f,height:c+p+u+a}},i.squize=function(t,e,i){for(var n=0,o=0;o<t.length;o++){var s=t[o];n+=this.squizeRow(s,e,i,n)}},i.squizeRow=function(t,e,i,n){for(var o=this.findDY(t,e),s=0;s<t.length;s++){t[s].position.y+=n}return o},i.findDY=function(t,e){for(var i=0,n=0;n<t.length;n++){var o=t[n];o._height>i&&(i=o._height)}return i-e},t.Layout=i}(window),function(t,e){var i=null;function n(){this.initialize()}n.prototype.initialize=function(){this.text={},this.load()},n.prototype.load=function(){var t=ContentManager.files[Config.lang];if(t)for(var e=t.split("\n"),i=0;i<e.length;i++){var n=e[i];if(n&&!n.startsWith("##")){var o=n.match(/"(?:[^"\\]|\\.)*"/g);if(o&&2===o.length){var s=o[0].replace(/\"/g,""),r=o[1].replace(/\\"/g,"secrtquots");r=(r=(r=r.replace(/\"/g,"")).replace(/secrtquots/g,'"')).replace(/\\n/g,"\n"),this.text[s]=r}}}},n.instance=function(){return null===i&&(i=new n),i},t.Localization=n}(window),function(t,e){function i(t){this.initialize(t)}i.prototype.initialize=function(t){this.playlist=t||[],this.now_playing=null,this.randomize=!1,this.current_playing_index=-1,this.is_paused=!1,this.is_stoped=!0},i.prototype.add=function(t,e){e=e||1,this.playlist.push({song:t,volume:e})},i.prototype.play=function(){if(this.is_stoped||this.is_paused){if(this.now_playing){this.now_playing.play();var t=this.playlist[this.current_playing_index];return this.now_playing.fade(0,t.volume,200),this.is_paused=!1,void(this.is_stoped=!1)}var e=0;this.stop(),e=this.randomize?Math.randomInt(0,this.playlist.length-1):++this.current_playing_index%this.playlist.length,this.current_playing_index=e,(t=this.playlist[e]).song.volume(t.volume).play(),this.now_playing=t.song;var i=this;this.now_playing.once("end",function(){timeout(function(){this.next()},100,i)}),this.is_paused=!1,this.is_stoped=!1}},i.prototype.next=function(){if(this.now_playing){var t=0;this.stop(),t=this.randomize?Math.randomInt(0,this.playlist.length-1):++this.current_playing_index%this.playlist.length,this.current_playing_index=t;var e=this.playlist[t];e.song.volume(e.volume).play(),this.now_playing=e.song;var i=this;this.now_playing.once("end",function(){i.next()}),this.is_paused=!1,this.is_stoped=!1}else this.play()},i.prototype.stop=function(){this.now_playing&&(this.now_playing.stop(),this.now_playing=null),this.is_stoped=!0,this.is_paused=!1},i.prototype.pause=function(){this.now_playing&&this.now_playing.pause(),this.is_paused=!0,this.is_stoped=!1},t.Playlist=i}(window),function(t,e){function i(){throw"can't initialize Action"}i.actions=[],i.isPaused=!1,i.add=function(t){-1===this.actions.indexOf(t)&&(this.actions.push(t),t.step(0))},i.remove=function(t){this.actions.removeElement(t)},i.pause=function(){i.isPaused=!0},i.resume=function(){i.isPaused=!1},i.stopAll=function(){i.actions=[]},i.stopByTag=function(t){for(var e=i.actions.length-1;e>=0;e--){var n=i.actions[e];n&&t===n.tag&&n.stop()}},i.isRunning=function(t){for(var e=i.actions.length;e>=0;e--)if(i.actions[e]&&t===i.actions[e].tag)return!0;return!1},i.update=function(t){if(!i.isPaused)for(var e=this.actions.length-1;e>=0;e--)this.actions[e]&&!this.actions[e].isPaused&&this.actions[e].step(t*Config.slow_motion_factor)},t.Actions=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype.initialize=function(t,e,i,n){this.mX1=t,this.mY1=e,this.mX2=i,this.mY2=n},i.prototype.A=function(t,e){return 1-3*e+3*t},i.prototype.B=function(t,e){return 3*e-6*t},i.prototype.C=function(t){return 3*t},i.prototype.GetSlope=function(t,e,i){return 3*this.A(e,i)*t*t+2*this.B(e,i)*t+this.C(e)},i.prototype.CalcBezier=function(t,e,i){return((this.A(e,i)*t+this.B(e,i))*t+this.C(e))*t},i.prototype.get=function(t){return this.mX1===this.mY1&&this.mX2===this.mY2?t:this.CalcBezier(this.GetTForX(t),this.mY1,this.mY2)},i.prototype.GetTForX=function(t){for(var e=t,i=0;i<4;++i){var n=this.GetSlope(e,this.mX1,this.mX2);if(0===n)return e;e-=(this.CalcBezier(e,this.mX1,this.mX2)-t)/n}return e},t.Bezier=i}(window),function(t,e){function i(){this.initialize()}i.prototype.initialize=function(t,e,i,n,o,s){this.object=t,this.to=e,this.bezier=i,this.duration=n,this.callback=o||function(){},this._cycleCallback=function(){},this.context=s||this,this.timePassed=0,this.ticks=0,this.isFinished=!1,this._delay=0,this._name="",this.tag=0,this._repeat=1,this._cycles=0},i.prototype.cycleCallback=function(t,e){return this.context=e||this,this._cycleCallback=t,this},i.prototype.repeat=function(t){return this._repeat=t,this},i.prototype.name=function(t){return this._name=t,this},i.prototype.delay=function(t){return this._delay=t||100,this},i.prototype.start=function(t){return this.run(t)},i.prototype.run=function(t){return this.tag=t,this.isFinished=!1,this._delay?timeout(function(){Actions.add(this)},this._delay,this,this.tag):Actions.add(this),this},i.prototype.stop=function(){return Actions.remove(this),this.timePassed=0,this.ticks=0,this.isFinished=!0,this},i.prototype.pause=function(){return this.isPaused=!0,this},i.prototype.resume=function(){return this.isPaused=!1,this},i.prototype.invokeCallback=function(){this.onCallbackInvoked(this.object,this,this.tag),this.callback.call(this.context,this.object)},i.prototype.onCallbackInvoked=function(t,e,i){},i.prototype.applyValues=function(){},i.prototype.onEmmitted=function(){},t.Tween=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n){this.parentInitialize(null,null,e,i,n),this.start_value=Config.slow_motion_factor,this.difference=t-this.start_value,this.timePassed=0,this.ticks=0},i.prototype.step=function(t){this.timePassed=this.timePassed+Ticker.step,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;Config.slow_motion_factor=this.start_value+i*this.difference,1===e&&this.ticks>1&&(this.callback(this.object),this.stop())},t.TweenTime=i}(window),function(t,e){function i(t){this.initialize(t)}i.EASE_IN_ELASTIC=0,i.EASE_OUT_ELASTIC=1,i.EASE_IN_OUT_ELASTIC=2,i.EASE_IN_BOUNCE=3,i.EASE_OUT_BOUNCE=4,i.EASE_IN_OUT_BOUNCE=5,i.prototype.initialize=function(t){this.easingFunction=null,this.elasticity=10,t===i.EASE_IN_BOUNCE?this.easingFunction=this.easeInBounce:t===i.EASE_IN_ELASTIC?this.easingFunction=this.easeInElastic:t===i.EASE_IN_OUT_BOUNCE?this.easingFunction=this.easeInOutBounce:t===i.EASE_IN_OUT_ELASTIC?this.easingFunction=this.easeInOutElastic:t===i.EASE_OUT_BOUNCE?this.easingFunction=this.easeOutBounce:t===i.EASE_OUT_ELASTIC&&(this.easingFunction=this.easeOutElastic)},i.prototype.get=function(t){return this.easingFunction(t,0,1,1)},i.prototype.easeInElastic=function(t,e,i,n){var o=0,s=i,r=0;return 0===t?e:1==(t/=n)?e+i:(o||(o=.3*n),s<Math.abs(i)?(s=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/s),-s*Math.pow(2,this.elasticity*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o)+e)},i.prototype.easeOutElastic=function(t,e,i,n){var o=0,s=i,r=0;return 0===t?e:1==(t/=n)?e+i:(o||(o=.3*n),s<Math.abs(i)?(s=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-this.elasticity*t)*Math.sin((t*n-r)*(2*Math.PI)/o)+i+e)},i.prototype.easeInOutElastic=function(t,e,i,n){var o=1.70158,s=0,r=i;o=0;return 0===t?e:2==(t/=n/2)?e+i:(s||(s=n*(.3*1.5)),r<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,this.elasticity*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*-.5+e:r*Math.pow(2,-this.elasticity*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*.5+i+e)},i.prototype.easeInBounce=function(t,e,i,n){return i-this.easeOutBounce(n-t,0,i,n)+e},i.prototype.easeOutBounce=function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},i.prototype.easeInOutBounce=function(t,e,i,n){return t<n/2?.5*this.easeInBounce(2*t,0,i,n)+e:.5*this.easeOutBounce(2*t-n,0,i,n)+.5*i+e},t.Easing=i}(window),function(t,e){var i=0;function n(t){this.initialize(t)}n.prototype.initialize=function(t){this.threads=[],this.isRunning=!1,this.isPaused=!1,this.delegate=t,this._countFinishedThreads=0,this.tag=0,this.context=null},n.prototype.setGlobalContext=function(t){this.context=t;for(var e=0;e<this.threads.length;e++)for(var i=this.threads[e],n=0;n<i.length;n++){i[n].context=t}},n.prototype.addThread=function(t,e){e=e||"_thread"+i++;for(var o=0,s=[],r=0;r<t.length;r++){void 0===(c=t[r]).length?s.push([c]):s.push(c)}for(r=0;r<s.length;r++){for(var a=0,h=-1,l=0;l<s[r].length;l++){(c=s[r][l]).duration>a&&(a=c.duration,h=l),c.onCallbackInvoked=n.prototype.delgateCallback.bind(this)}var c;if((c=s[r][h]).onCallbackInvoked=n.prototype.onCallback.bind(this),0===c._repeat)throw"You can't run infinite tweens into Sequencer \n(They will never finish and call the next!)";o+=c.duration}var u={tweens:s,tag:e,index:-1,duration:o};return this.threads.push(u),u},n.prototype.delgateCallback=function(t,e,i){this.delegate&&this.delegate.onTweenEnded&&this.delegate.onTweenEnded(e,e._name,i,this)},n.prototype.onCallback=function(t,e,i){this.delgateCallback(t,e,i),this.next(i)},n.prototype.run=function(){this.isRunning||(this.isRunning=!0,this.delegate&&this.delegate.onSequencerStarted&&this.delegate.onSequencerStarted(this));for(var t=0;t<this.threads.length;t++){var e=this.threads[t];e.index++;for(var i=0;i<e.tweens.length;i++)if(e.index===i)for(var n=0;n<e.tweens[i].length;n++){var o=e.tweens[i][n];o.applyValues(),this.delegate&&this.delegate.onTweenStarted&&this.delegate.onTweenStarted(o,o._name,e.tag,this),o.run(e.tag)}}},n.prototype.next=function(t){if(!this.isFinished)for(var e=0;e<this.threads.length;e++){var i=this.threads[e];if(i.tag===t)if(i.index++,i.index>=i.tweens.length)this._countFinishedThreads++,this.delegate&&this.delegate.onThreadFinished&&this.delegate.onThreadFinished(i),this._countFinishedThreads===this.threads.length&&this.delegate&&this.delegate.onSequencerFinished&&this.delegate.onSequencerFinished(this);else for(var n=0;n<i.tweens.length;n++)for(var o=0;o<i.tweens[n].length;o++){var s=i.tweens[n][o];i.index===n&&(s.applyValues(),this.delegate&&this.delegate.onTweenStarted&&this.delegate.onTweenStarted(s,s._name,i.tag,this),s.run(i.tag))}}},n.prototype.pause=function(){if(!this.isPaused){this.isPaused=!0;for(var t=0;t<this.threads.length;t++)for(var e=this.threads[t],i=0;i<e.tweens.length;i++)for(var n=e.tweens[i],o=0;o<n.length;o++){n[o].pause()}}},n.prototype.resume=function(){if(this.isPaused){this.isPaused=!1;for(var t=0;t<this.threads.length;t++)for(var e=this.threads[t],i=0;i<e.tweens.length;i++)for(var n=e.tweens[i],o=0;o<n.length;o++){n[o].resume()}}},n.prototype.stop=function(){this.isRunning=!1,this.isFinished=!0;for(var t=0;t<this.threads.length;t++){var e=this.threads[t];Actions.stopByTag(e.tag)}},n.prototype.reset=function(){this.isFinished=!1,this._countFinishedThreads=0;for(var t=0;t<this.threads.length;t++){this.threads[t].index=-1}},t.Sequencer=n}(window),function(t,e){function i(t,e,i,n,o,s){this.initialize(t,e,i,n,o,s)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o,s){this.parentInitialize(i,null,n,e,o,s),this.stepCallback=t},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;1===e&&this.ticks>1?(this.stepCallback.call(this.context,i,this.object,t),this.invokeCallback(),this.stop()):this.stepCallback.call(this.context,i,this.object,t)},t.Stepper=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i){this.parentInitialize(null,null,null,e,t,i)},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;1===(e=e>=1?1:e)&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.Timer=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.timePassed=0,this.applyValues()},i.prototype.applyValues=function(){this.startAlpha=this.object.alpha,this.difference=this.to-this.startAlpha},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.alpha=this.startAlpha+i*this.difference,1===e&&(this.invokeCallback(),this.stop())},t.TweenAlpha=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.half=(new V).copy(e).scale(.5),this.begin=(new V).copy(t.position),this._repeat=0},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=new V;e<.25?(i.copy(this.half),i.scale(e/.25),i=V.addition(this.begin,i)):e<.5?(i.copy(this.half),i.reverse(),i.scale((e-.25)/.25),(i=V.addition(this.begin,i)).add(this.half)):e<.75?(i.copy(this.half),i.reverse(),i.scale((e-.5)/.25),i=V.addition(this.begin,i)):(i.copy(this.half),i.scale((e-.75)/.25),(i=V.addition(this.begin,i)).sub(this.half)),this.object.position.set(i.x,i.y),1===e&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenBackForth=i}(window),function(t,e){function i(t,e,i,n,o,s){this.initialize(t,e,i,n,o,s)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o,s){i=i||new Bezier(.26,.66,.32,1.01),this.parentInitialize(t,e,i,n,o,s),this._originalAlpha=t.alpha,this.startAlpha=t.alpha,this.difference=e-this.startAlpha,this._repeat=0},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration,i=0;if((e=e>=1?1:e)<.5){var n=e/.5,o=this.bezier?this.bezier.get(n):n;i=this.startAlpha+(this.to-this._originalAlpha)*o}else{n=(e-.5)/.5,o=this.bezier?this.bezier.get(n):n;i=this.to-(this.to-this._originalAlpha)*o}this.object.alpha=i,1===e&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenBlink=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.magnitude=e,this._repeat=0,this.applyValues()},i.prototype.applyValues=function(){var t=this.object.position;this.startPosition=new V(t.x,t.y)},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e,n=Math.sin(6.283184*i)*this.magnitude;this.object.position.y=n+this.startPosition.y,1===e&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.object.position.y=this.startPosition.y,this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenFloat=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.timePassed=0,this.applyValues()},i.prototype.applyValues=function(){for(var t in this._properties={},this._list=[],this.to)if(this.to.hasOwnProperty(t)){var e=t;this._properties["start"+e]=this.object[e],this._properties["difference"+e]=this.to[e]-this.object[e],this._list.push(e)}},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;for(var i=this.bezier?this.bezier.get(e):e,n=0;n<this._list.length;n++){var o=this._list[n];this.object[o]=this._properties["start"+o]+i*this._properties["difference"+o]}1===e&&(this.invokeCallback(),this.stop())},i.prototype.to=function(t,e,i){},i.prototype.call=function(t,e,i){},t.TweenGeneric=i}(window),function(t,e){function i(t,e){this.initialize(t,e)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e){this.parentInitialize(null,null,null,t,e),this.applyValues()},i.prototype.applyValues=function(){},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;1===(e=e>=1?1:e)&&(this.invokeCallback(),this.stop())},t.TweenIdle=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t){this.parentInitialize(null,null,null,0,t),this.applyValues()},i.prototype.applyValues=function(){},i.prototype.step=function(t){this.timePassed+=t,this.callback.call(this.context,t,this.timePassed)},t.TweenInfinity=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){var t=this.object.position;this.startPosition=new V(t.x,t.y),this.distanceX=this.to.x-t.x,this.distanceY=this.to.y-t.y},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.position.set(this.startPosition.x+this.distanceX*i,this.startPosition.y+this.distanceY*i),1===e&&(this.invokeCallback(),this.stop())},t.TweenMoveTo=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.bezier2=new Easing(Easing.EASE_OUT_ELASTIC),this.nonBouncePercent=.1,this.applyValues()},i.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.startScale-this.to},i.prototype.nonBounce=function(t){return this.nonBouncePercent=t,this},i.prototype.elsticity=function(t){return this.bezier2.elsticity=t,this},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;if((e=e>=1?1:e)<=this.nonBouncePercent){var i=e/this.nonBouncePercent;this.bezier&&(i=this.bezier.get(e/this.nonBouncePercent)),this.object.scale.set(this.startScale+(this.to-this.startScale)*i)}else{i=(e-this.nonBouncePercent)/(1-this.nonBouncePercent);var n=this.bezier2.get(i);this.object.scale.set(this.to+n*this.difference)}1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenPop=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.startScale=t.scale.x,this._repeat=0},i.prototype.step=function(t){this.timePassed+=t,this.ticks++;var e=this.timePassed/this.duration,i=0;if((e=e>=1?1:e)<.5){var n=e/.5,o=this.bezier?this.bezier.get(n):n;i=this.startScale+(this.to-this.startScale)*o}else{n=(e-.5)/.5,o=this.bezier?this.bezier.get(n):n;i=this.to-(this.to-this.startScale)*o}this.object.scale.set(i),1===e&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenPulsate=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.startAngle=t.rotation,this._repeat=0},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration,i=this.bezier?this.bezier.get(e):e;this.object.rotation=this.startAngle+2*Math.PI*i*this.to,e>=1&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.object.rotation=this.startAngle,this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenRotate=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){this.startAngle=this.object.rotation},i.prototype.step=function(t){this.timePassed+=t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.rotation=this.startAngle+i*this.to,1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenRotateBy=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){this.startAngle=this.object.rotation,this.diffrenece=this.to-this.object.rotation},i.prototype.step=function(t){this.timePassed+=t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.rotation=this.startAngle+i*this.diffrenece,1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenRotateTo=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.to-this.startScale},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.scale.set(this.startScale+i*this.difference),1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenScale=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){this.startScale=this.object.scale.x,this.difference=this.to-this.startScale},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.scale.x=this.startScale+i*this.difference,1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenScaleX=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.applyValues()},i.prototype.applyValues=function(){this.startScale=this.object.scale.y,this.difference=this.to-this.startScale},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;this.object.scale.y=this.startScale+i*this.difference,1===e&&this.ticks>1&&(this.invokeCallback(),this.stop())},t.TweenScaleY=i}(window),function(t,e){function i(t,e,i,n,o,s){this.initialize(t,e,i,n,o,s)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o,s){this.parentInitialize(t,null,n,o,s),this.magnitude=e,this.frequency=i||.025,this.shakeAccumulation=new V,this.applyValues()},i.prototype.applyValues=function(){this.startPoint=(new V).copy(this.object.position),this.shakes=0},i.prototype.step=function(t){this.timePassed+=t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=Math.round(this.frequency*this.timePassed)-this.shakes;if(i>0){this.shakes+=i;var n=this.bezier?this.bezier.get(e):1,o=Math.randomInt(0,360),s=new V;for(s.setLength(Math.randomInt(this.magnitude/3,this.magnitude*n)),s.setAngle(Math.degreesToRadians(o));V.addition(s,this.shakeAccumulation).getLength()>this.magnitude*n;){o=Math.randomInt(0,360);s.setLength(Math.randomInt(this.magnitude/3,this.magnitude*n)),s.setAngle(Math.degreesToRadians(o))}this.shakeAccumulation.add(s),this.object.x+=s.x,this.object.y+=s.y}1===e&&this.ticks>1&&(this.object.x-=this.shakeAccumulation.x,this.object.y-=this.shakeAccumulation.y,this.invokeCallback(),this.stop())},t.TweenShake=i}(window),function(t,e){function i(t,e,i,n,o,s){this.initialize(t,e,i,n,o,s)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o,s){this.parentInitialize(t,null,n,o,s),this.magnitude=e,this.frequency=i||.025,this.applyValues()},i.prototype.applyValues=function(){this.startPoint=(new V).copy(this.object.position),this.shakes=0,this.isLeft=!1},i.prototype.step=function(t){this.timePassed+=t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=Math.round(this.frequency*this.timePassed)-this.shakes;if(i>0){this.shakes+=i+2e3;var n=0;this.isLeft&&(n=-180),this.isLeft=!this.isLeft;var o=new V;o.setLength(this.magnitude),o.setAngle(Math.degreesToRadians(n));var s=this.startPoint.clone();s.add(o),this.object.position.set(s.x,s.y)}1===e&&this.ticks>1&&(this.object.position.set(this.startPoint.x,this.startPoint.y),this.invokeCallback(),this.stop())},t.TweenShakeX=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.toX=e,this.toY=1-e+1,this.startScale=(new V).copy(t.scale),this._repeat=0},i.prototype.step=function(t){this.timePassed=this.timePassed+t;var e=this.timePassed/this.duration,i=1,n=1;if((e=e>=1?1:e)<.5){var o=e/.5,s=this.bezier?this.bezier.get(o):o;i=this.startScale.x+(this.toX-this.startScale.x)*s,n=this.startScale.y+(this.toY-this.startScale.y)*s}else{o=(e-.5)/.5,s=this.bezier?this.bezier.get(o):o;i=this.toX-(this.toX-this.startScale.x)*s,n=this.toY-(this.toY-this.startScale.y)*s}this.object.scale.set(i,n),1===e&&(this._cycles++,this._cycleCallback.call(this.context,this._cycles),this._cycles===this._repeat&&(this.invokeCallback(),this.stop()),this.timePassed-=this.duration)},t.TweenSquashStretch=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){i=i||new Bezier(.34,-.14,.48,.98),this.parentInitialize(t,e,i,n,o),this.duration=n,this.applyValues()},i.prototype.applyValues=function(){this.startScale_x=this.object.scale.x,this.startScale_y=this.object.scale.y},i.prototype.step=function(t){this.timePassed=this.timePassed+t,this.ticks++;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=(this.bezier?this.bezier.get(e):e)-e;this.object.scale.x=this.startScale_x+this.to*i,this.object.scale.y=this.startScale_y-this.to*i,1===e&&(this.invokeCallback(),this.stop())},t.TweenSquashy=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.prototype=new Tween,i.prototype.parentInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n,o){this.parentInitialize(t,e,i,n,o),this.start_tint=new Color(t.tint),this.end_tint=new Color(e),this.timePassed=0},i.prototype.step=function(t){this.timePassed+=t;var e=this.timePassed/this.duration;e=e>=1?1:e;var i=this.bezier?this.bezier.get(e):e;1===e&&(i=.9);var n=(this.end_tint.red-this.start_tint.red)*i+this.start_tint.red,o=(this.end_tint.green-this.start_tint.green)*i+this.start_tint.green,s=(this.end_tint.blue-this.start_tint.blue)*i+this.start_tint.blue;this.object.tint=Color.get_color_32(1,n,o,s),1===e&&(this.callback(this.object),this.stop())},t.TweenTint=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype.initialize=function(t){this.states=t,this.subscribers=[],this.currentState="",this.previousState="",this.initial_state=null,this.indexes={};for(var e=0;e<this.states.length;e++)this.indexes[this.states[e].name]=e,this.states[e].initial&&(this.currentState=this.states[e],this.previousState=this.states[e],this.initial_state=this.currentState);if(!this.initial_state)throw"you must have initial state when configuring a state machine"},i.prototype.go_to_previus_state=function(){this.set(this.previousState.name)},i.prototype.set=function(t,e){if(this.currentState.events[t]){var i=this.currentState;this.previousState=i,this.currentState=this.states[this.indexes[this.currentState.events[t]]];var n=this.subscribers[this.currentState.name];if(n)for(var o=n.length,s=0;s<o;s++)n[s].on_state(i,this.currentState,e)}},i.prototype.get=function(){return this.currentState.name},i.prototype.reset=function(){this.set(this.initial_state.name),this.subscribers=[]},i.prototype.subscribe=function(t,e){if("*"===t)for(var i=0;i<this.states.length;i++){var n=this.states[i].name;this.subscribers[n]||(this.subscribers[n]=[]),this.subscribers[n].push(e)}else this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(e)},i.prototype.unsubscribe=function(t,e){var i=this.subscribers[t];if(i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}},i.prototype.get_subscribers=function(){return this.subscribers},i.prototype.unsubscribe_from_all=function(t){for(var e in this.subscribers){var i=this.subscribers[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},i.prototype.unsubscribe_all=function(){this.subscribers=[]},t.StateMachine=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.UP=0,i.DOWN=1,i.MOVE=2,i.CANCEL=4,i.UNKNOWN=-1,i.prototype.initialize=function(t,e,i,n){this.propagate=!0,this.isCanceled=!1,this.point=new V(t||0,e||0),this.type=i,this.idx=n,this.originalEvent=null},i.prototype.stopPropagation=function(){this.propagate=!1},i.prototype.cancel=function(){this.isCanceled=!0},t.HEvent=i}(window),function(t,e){function i(t,e){this.initialize(t,e)}i.prototype.initialize=function(t,e){this.point={x:0,y:0},this.app=t,this.device=t.device,this.elements=[],this.offset={top:0,left:0},this.element=e,this.isBlocked=!1,this.lastOriginalEvent=null,this.lastCursorIcon="",this.currentCursorIcon="default",this.addListener(e),this.wisperListeners=[]},i.prototype.addListener=function(t){this.offset=this.recursiveOffset(t),this.element=t,this.registerTouch(t),this.registerMouse(t)},i.prototype.registerTouch=function(t){var e=this;t.addEventListener("touchmove",function(t){e.lastOriginalEvent=t;for(var i=0;i<t.changedTouches.length;i++){var n=e.point.x,o=e.point.y;if(e.mapTouchLocation(t.changedTouches[i]),n===e.point.x&&o===e.point.y)return;e.setMouseMove(t.changedTouches[i].identifier)}t.preventDefault(),t.stopPropagation()},!1),t.addEventListener("touchend",function(t){e.lastOriginalEvent=t;for(var i=0;i<t.changedTouches.length;i++)e.mapTouchLocation(t.changedTouches[i]),e.setMouseUp(t.changedTouches[i].identifier);t.preventDefault(),t.stopPropagation()},!1),t.addEventListener("touchleave",function(t){e.lastOriginalEvent=t;for(var i=0;i<t.changedTouches.length;i++)e.mapTouchLocation(t.changedTouches[i]),e.setMouseUp(t.changedTouches[i].identifier);t.preventDefault(),t.stopPropagation()},!1),t.addEventListener("touchstart",function(t){e.lastOriginalEvent=t;for(var i=0;i<t.changedTouches.length;i++)e.mapTouchLocation(t.changedTouches[i]),e.setMouseDown(t.changedTouches[i].identifier);t.preventDefault(),t.stopPropagation()},!1),t.addEventListener("touchcancel",function(t){e.lastOriginalEvent=t;for(var i=0;i<t.changedTouches.length;i++)e.setMouseCancel(t.changedTouches[i].identifier);t.cancelable&&t.preventDefault(),t.stopPropagation()},!1)},i.prototype.registerMouse=function(e){var i=this;e.addEventListener("mouseup",function(t){i.lastOriginalEvent=t;var e=i.getMousePoint(t);i.mapPointLocation(e.x,e.y),1===t.which?i.setMouseUp(1):!0===t.ctrlKey?i.setMouseUp(1):i.setRightMouseUp()},!1),e.addEventListener("mouseleave",function(t){i.lastOriginalEvent=t;var e=i.getMousePoint(t);i.mapPointLocation(e.x,e.y),1===t.which?i.setMouseCancel(1):!0===t.ctrlKey?i.setMouseCancel(1):i.setRightMouseUp()},!1),e.addEventListener("mousedown",function(t){i.lastOriginalEvent=t;var e=i.getMousePoint(t);i.mapPointLocation(e.x,e.y),1===t.which?i.setMouseDown(1):!0===t.ctrlKey?i.setMouseDown(1):i.setRightMouseDown()},!1),e.addEventListener("mousemove",function(t){i.lastOriginalEvent=t;var e=i.getMousePoint(t),n=i.point.x,o=i.point.y;i.mapPointLocation(e.x,e.y),n===i.point.x&&o===i.point.y||(1===t.which?i.setMouseMove(1):!0===t.ctrlKey?i.setMouseMove(1):i.setRightMouseMove())},!1),e.addEventListener("contextmenu",function(t){i.lastOriginalEvent=t,t.preventDefault()}),e.addEventListener("wheel",function(e){var n=0;e||(e=t.event),e.deltaY?n=-e.deltaY:e.wheelDelta?n=e.wheelDelta/120:e.detail&&(n=-e.detail/3);var o=n<0?-1:1;i.lastOriginalEvent=e,e.preventDefault(),i.setWheel(o)})},i.prototype.fixWhich=function(t){!t.which&&t.button&&(1&t.button?t.which=1:4&t.button?t.which=2:2&t.button&&(t.which=3))},i.prototype.addElement=function(t){var e=this.elements.indexOf(t);if(!t)throw"can't add undefined value to Input";-1===e&&(t.isMouseDown&&(t.eventIdx=-1,t.isMouseDown=!1,t.onMouseCancel(null,this)),this.elements.push(t),t.onInputAdded(),t.enableSensor())},i.prototype.add=function(t){if("[object Array]"===Object.prototype.toString.call(t))for(var e=0;e<t.length;e++){var i=t[e];this.addElement(i)}else this.addElement(t);0!==t._width&&0!==t._height||console.warn("you are trying to add zero size element for a click")},i.prototype.remove=function(t){if("[object Array]"===Object.prototype.toString.call(t))for(var e=0;e<t.length;e++)this.removeElement(t[e]);else this.removeElement(t)},i.prototype.removeElement=function(t){var e=this.elements.indexOf(t);-1!==e&&(this.elements.splice(e,1),t.onInputRemoved())},i.prototype.removeAll=function(){for(var t=0;t<this.elements.length;t++)this.elements[t].onInputRemoved();this.elements=[]},i.prototype.sortInput=function(){Math.insertionSort(this.elements,function(t,e){return t.priority<e.priority})},i.prototype.getMousePoint=function(e){this.fixWhich(e);var i=0,n=0;return e||(e=t.event),e.pageX||e.pageY?(i=e.offsetX?e.offsetX:e.layerX,n=e.offsetY?e.offsetY:e.layerY):(e.clientX||e.clientY)&&(i=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),new V(i,n)},i.prototype.mapTouchLocation=function(t){this.mapPointLocation(t.pageX-this.offset.left,t.pageY-this.offset.top)},i.prototype.mapPointLocation=function(t,e){var i=t/this.app.canvasWidth*this.app.width,n=e/this.app.canvasHeight*this.app.height;this.point.x=i,this.point.y=n},i.prototype.recalucateOffset=function(){this.offset=this.recursiveOffset(this.element)},i.prototype.recursiveOffset=function(t){for(var e=0,i=0;t;)e+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return{left:e,top:i}},i.prototype.setWheel=function(t){if(!this.isBlocked){var e=new HEvent(0,t,0,null);e.originalEvent=this.lastOriginalEvent,this.sortInput(),this.wisper(e,"Wheel");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];if(n){if(!e.propagate)break;n._check(this.point)&&n.onWheel(e,n)}}}},i.prototype.setMouseDown=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.DOWN,t);e.originalEvent=this.lastOriginalEvent,this.sortInput(),this.wisper(e,"MouseDown");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];if(n&&-1===n.eventIdx&&!n.isMouseDown&&n._check(e.point)&&n.isTouchable){if(!e.propagate)break;n.isMouseDown=!0,n.eventIdx=e.idx,n.onMouseDown(e,n),e.isCanceled&&this.setMouseCancel(t)}}}},i.prototype.setMouseMove=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.DOWN,t);e.originalEvent=this.lastOriginalEvent,this.wisper(e,"MouseMove");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];n&&n.eventIdx===t&&n.isMouseDown&&(n.eventIdx=e.idx,n.onMouseMove(e,n),e.isCanceled&&this.setMouseCancel(t))}}},i.prototype.setMouseUp=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.UP,t);e.originalEvent=this.lastOriginalEvent,this.wisper(e,"MouseUp");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];n&&n.eventIdx===t&&n.isMouseDown&&(n._check(e.point)&&e.propagate?(n.isMouseDown=!1,n.eventIdx=-1,n.onMouseUp(e,n)):this.setMouseCancel(t))}}},i.prototype.setMouseCancel=function(t){if(!this.isBlocked){this.wisper(null,"MouseCancel");for(var e=0;e<this.elements.length;e++){var i=this.elements[e],n=new HEvent(0,0,HEvent.CANCEL,t);n.originalEvent=this.lastOriginalEvent,i&&i.eventIdx===t&&(i.eventIdx=-1,i.isMouseDown=!1,i.onMouseCancel(n,i))}}},i.prototype.setRightMouseUp=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.UP,t);e.originalEvent=this.lastOriginalEvent,this.wisper(e,"RightMouseUp");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];n&&n.eventIdx===t&&n.isMouseDown&&(n._check(e.point)&&e.propagate?(n.isMouseDown=!1,n.eventIdx=-1,n.onRightMouseUp(e,n)):this.setMouseCancel(t))}}},i.prototype.setRightMouseDown=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.DOWN,t);e.originalEvent=this.lastOriginalEvent,this.sortInput(),this.wisper(e,"RightMouseDown");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];if(n&&-1===n.eventIdx&&!n.isMouseDown&&n._check(e.point)&&n.isTouchable){if(!e.propagate)break;n.isMouseDown=!0,n.eventIdx=e.idx,n.onRightMouseDown(e,n),e.isCanceled&&this.setMouseCancel(t)}}}},i.prototype.setRightMouseMove=function(t){if(!this.isBlocked){var e=new HEvent(this.point.x,this.point.y,HEvent.MOVE,t);e.originalEvent=this.lastOriginalEvent,this.wisper(e,"RightMouseMove");for(var i=0;i<this.elements.length;i++){var n=this.elements[i];n&&n.eventIdx===t&&n.isMouseDown&&(n.eventIdx=e.idx,n.onRightMouseMove(e,n),e.isCanceled&&this.setMouseCancel(t))}}};var n=null;i.prototype.setCursor=function(e){if(e!==this.currentCursorIcon){var i=t.document.body;this.currentCursorIcon=e,this.lastCursorIcon=i.style.cursor,clearTimeout(n),n=setTimeout(function(){i.style.cursor=e},30)}};var o=null;i.prototype.restoreCursor=function(){if(this.currentCursorIcon!==this.lastCursorIcon){var e=t.document.body;this.currentCursorIcon=this.lastCursorIcon,clearTimeout(o);var i=this;o=setTimeout(function(){e.style.cursor=i.lastCursorIcon},30)}},i.prototype.wisper=function(t,e){e="onWisper"+e;for(var i=0;i<this.wisperListeners.length;i++){var n=this.wisperListeners[i];n[e]&&n[e](t)}},t.Input=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.prototype.initialize=function(t,e,i){this.queue=[],this.numberOfEvents=0,this.totalTime=0,this.callback=function(){},this.isSingleLoop=e,this.currentTime=i?-i:0,this.currentEventName="",this.previousEventName=null,this.currentPercent=0,this.isFinished=!1,this.delay=i||0;for(var n=0;n<t.length;n++){var o=t[n];"function"==typeof o?this.callback=o:(this.numberOfEvents++,this.totalTime+=o.duration,this.queue.push(o))}},i.prototype.step=function(t){this.update(t)},i.prototype.update=function(t){if(this.isFinished)return!1;this.currentTime+=t,this.currentTime<0&&(null===this.previousEventName?this.previousEventName="":this.previousEventName=this.currentEventName,this.currentEventName="delay",this.currentPercent=(this.delay-Math.abs(this.currentTime))/this.delay);var e=0;if(this.currentTime>this.totalTime){if(this.isSingleLoop)return this.isFinished=!0,void this.callback();this.currentTime-=this.totalTime,this.previousEventName="",this.callback()}for(var i=0;i<this.queue.length;i++){var n=this.queue[i],o=e;if(e+=n.duration,this.currentTime>=o&&this.currentTime<=e){this.previousEventName=this.currentEventName,this.currentEventName=n.name;var s=this.currentTime-o;this.currentPercent=s/n.duration}}},i.prototype.restart=function(){this.isFinished=!1,this.currentTime=-this.delay,this.currentEventName=null,this.currentPercent=0,this.previousEventName=null},i.prototype.goToNext=function(){for(var t=0,e=0;e<this.queue.length;e++){var i=t;if(t+=this.queue[e].duration,this.currentTime>=i&&this.currentTime<=t){this.queue.length>e+1&&(this.currentTime=t+1,this.currentPercent=0);break}}},i.prototype.get=function(){return{name:this.currentEventName,percent:this.currentPercent,isFirstTime:this.previousEventName!==this.currentEventName}},t.Looper=i}(window),function(t,e){function i(){throw"Can't initialize Notes"}i.listeners={},i.add=function(t,e){if(!t.onNote)throw"the object must implement onNote method in order to recive Notes";i.listeners[e]||(i.listeners[e]=[]),-1===i.listeners[e].indexOf(t)&&i.listeners[e].push(t)},i.remove=function(t,e){if(e)(o=i.listeners[e])&&-1!==(s=o.indexOf(t))&&o.splice(s,1);else for(var n in i.listeners){var o,s;if(o=i.listeners[n])-1!==(s=o.indexOf(t))&&o.splice(s,1)}},i.removeAll=function(){i.listeners={}},i.send=function(t,e,n){if(i.listeners[t])for(var o=i.listeners[t],s=0;s<o.length;s++){o[s].onNote(t,e,n)}else log("You are tring to send a message for which there are no subscribers :"+t)},t.Notes=i}(window),function(t){var e=function(){throw"cant initialize"};e.baseURL="",e.countLoaded=0,e.countToLoad=0,e.countSoundsToLoad=0,e.countSoundsLoaded=0,e.countProgress=0,e.soundsToLoad=[],e.hasError=!1,e.callback=function(){},e.context=null,e.spine={},e.files={},e.jsons={},e.isSoundLoaded=!0,e.isResourcesLoaded=!0,e.onProgress=function(t,i){e.countLoaded++,e.countProgress++,i.type===PIXI.LoaderResource.TYPE.IMAGE?Images[i.name]=i:i.data&&i.data.bones?e.spine[i.name]=i:i.type===PIXI.LoaderResource.TYPE.JSON?e.jsons[i.name]=i.data:i.url.endsWith(".fnt")||(e.files[i.name]=i.data)},e.onComplete=function(){e.isResourcesLoaded=!0,e.isSoundLoaded&&(e.countLoaded=0,e.countToLoad=0,e.countSoundsLoaded=0,e.countSoundsToLoad=0,e.countProgress=0,e.soundsToLoad=[],e.loader.reset(),e.callback.call(e.context,e.hasError))},e.setLoader=function(){(e.loader=PIXI.Loader.shared).pre(function(e,i){t._VERSION&&-1===e.url.indexOf("?v=")&&(e.url+="?v="+t._VERSION),i()}).on("progress",function(t,i){e.onProgress(t,i)}).on("error",function(){e.hasError=!0}).on("complete",function(){e.onComplete()})},e.addImage=function(t,i,n){e.loader.resources[t]||PIXI.utils.TextureCache[t]||(n||(i?i.startsWith("http")||(i=i.startsWith("../")?e.baseURL+i:e.baseURL+"assets/images/"+i):i=e.baseURL+"assets/images/"+t+".png"),e.loader.add(t,i,{loadType:PIXI.LoaderResource.LOAD_TYPE.IMAGE,crossOrigin:!0}),e.countToLoad++,e.isResourcesLoaded=!1)},e.addFile=function(t,i){i=e.baseURL+i,e.loader.add(t,i),e.countToLoad++,e.isResourcesLoaded=!1},e.addSound=function(t,i){if(Howler.noAudio)Sounds[t]={play:function(){return this},volume:function(){return this},_volume:1,once:function(){}};else{for(var n=0;n<i.length;n++){var o=i[n];o.startsWith("data:")||(i[n]=e.baseURL+o)}e.soundsToLoad[t]=i,e.countToLoad++,e.countSoundsToLoad++,e.isSoundLoaded=!1}},e.addSpine=function(t){this.loader.add(t,e.baseURL+"assets/spine/"+t+".json"),e.isResourcesLoaded=!1,e.countToLoad+=3},e.addAtlas=function(t){var i="";i=t.startsWith("..")?e.baseURL+t+".json":e.baseURL+"assets/images/atlases/"+t+".json",e.loader.add(t,i),e.countToLoad+=2,e.isResourcesLoaded=!1},e.addFont=function(t,i){e.loader.resources[t]||(e.loader.add(t,e.baseURL+i),e.countToLoad++,e.isResourcesLoaded=!1)},e.addBitmapFont=function(t,i){e.loader.add(t,e.baseURL+i),e.countToLoad+=2,e.isResourcesLoaded=!1},e.addAudio=function(t,i){if(Howler.noAudio)Sounds[t]={play:function(){return this},volume:function(){return this},_volume:1,once:function(){}};else{for(var n=0;n<i.length;n++){var o=i[n];o.startsWith("data:")||(i[n]=e.baseURL+o)}var s=new Howl({src:i,onload:function(){},onloaderror:function(){}});Sounds[t]=s}},e.downloadResources=function(t,i){for(var n in e.callback=t,e.context=i,e.hasError=!1,e.soundsToLoad){var o=e.soundsToLoad[n],s=new Howl({src:o,onload:function(){e.countLoaded++,e.countSoundsToLoad===++e.countSoundsLoaded&&(e.isSoundLoaded=!0,e.soundsToLoad=[]),e.countToLoad===e.countLoaded&&e.isResourcesLoaded&&e.onComplete()},onloaderror:function(t){log("Error loading: "+n),log(t),e.hasError=!0,e.countLoaded++,e.countSoundsLoaded++,e.countToLoad===e.countLoaded&&e.isResourcesLoaded&&e.onComplete()},buffer:!0});Sounds[n]=s}e.loader.load()},e.readBaseURL=function(){var t=document.URL;if(t.indexOf("localhost")>0){var i=t.lastIndexOf("/"),n=t.substring(0,i);e.baseURL=n+"/"}else e.baseURL="";Config.baseURL&&(e.baseURL=Config.baseURL)},e.readBaseURL(),e.setLoader(),t.ContentManager=e}(window),function(t,e){t.Fonts=function(){throw"Can't initialize fonts"}}(window),function(t,e){t.Images=function(){throw"Can't initialize images"}}(window),function(t,e){t.Sounds=function(){throw"cant initialize sounds"}}(window),function(t,e){function i(t){this.initialize(t)}i.ANIMATION_TYPE_SLIDE=0,i.ANIMATION_TYPE_SLIDEOVER=1,i.ANIMATION_TYPE_FADEIN=2,i.ANIMATION_TYPE_FADE_TO_BLACK=3,i.ANIMATION_TYPE_DELAYED_REMOVAL=4,i.ANIMATION_TYPE_SCREEN=5,i.ANIMATION_TYPE_FADEOUT=6,i.ANIMATION_TYPE_ALPHA=7,i.ANIMATION_DIRECTION_LEFT=0,i.ANIMATION_DIRECTION_RIGHT=1,i.ANIMATION_DIRECTION_UP=2,i.ANIMATION_DIRECTION_DOWN=3,i.prototype.initialize=function(t){this.app=t,this.screens=[],this.currentScreen=null,this.newScreen=null,this.transitionCallback=null,this.isTransitioning=!1,this.transitionScreen=null,this.queue=[]},i.prototype.add=function(t,e,n,o,s){if(this.isTransitioning)return this.queue.push({method:"add",screen:t,duration:e,animationType:n,transitionCallback:o,transitionScreen:s}),!1;this.isTransitioning=!0;var r=void 0===e?200:e,a=void 0===n?i.ANIMATION_TYPE_ALPHA:n;this.transitionCallback=o,this.transitionScreen=s||null,this.screens.push(t),this.currentScreen?(this.newScreen=t,this.currentScreen.onHide(),this.currentScreen.deactivateTouchables(),this.app.stage.addChild(this.newScreen),this.newScreen.onBeforeShow(),this.setAnimation(a,r,i.ANIMATION_DIRECTION_LEFT,this.onTransitionFinished)):(this.currentScreen=t,this.app.stage.addChild(this.currentScreen),this.currentScreen.onBeforeShow(),this.currentScreen.onShow(),this.isTransitioning=!1,this.transitionCallback&&this.transitionCallback(),this.processQueue()),app.input.restoreCursor()},i.prototype.processQueue=function(){if(this.queue.length>0){var t=this.queue.shift();"add"===t.method?this.add(t.screen,t.duration,t.animationType,t.transitionCallback,t.transitionScreen):"goBack"===t.method&&this.goBack(t.duration,t.animationType,t.transitionCallback)}},i.prototype.setAnimation=function(t,e,n,o){t===i.ANIMATION_TYPE_FADEIN?this.animationFadeIn(e,o):t===i.ANIMATION_TYPE_SLIDE?this.animationSlide(e,n,o):t===i.ANIMATION_TYPE_SLIDEOVER?this.animationSlideOver(e,n,o):t===i.ANIMATION_TYPE_DELAYED_REMOVAL?this.animationDelayedRemoval(e,o):t===i.ANIMATION_TYPE_FADE_TO_BLACK?this.animationFadeToBlack(e,o):t===i.ANIMATION_TYPE_SCREEN?this.animationScreen(e,o):t===i.ANIMATION_TYPE_FADEOUT?this.animationFadeOut(e,o):t===i.ANIMATION_TYPE_ALPHA?this.animationAlpha(e,o):(this.newScreen.position.set(0,0),this.newScreen.alpha=1,o.call(app.navigator))},i.prototype.animationScreen=function(t,e){this.transitionScreen.zIndex=2,this.currentScreen.zIndex=1,this.newScreen.zIndex=0,this.currentScreen.position.set(0,0),this.newScreen.position.set(0,0),this.transitionScreen.position.set(0,0),this.transitionScreen.onShow(),this.app.stage.addChild(this.transitionScreen),timeout(function(){this.newScreen.zIndex=1,this.currentScreen.zIndex=0},t/2,this),timeout(function(){e.call(app.navigator),this.transitionScreen.onHide(),this.app.stage.removeChild(this.transitionScreen),this.transitionScreen.removeFromParent(),this.transitionScreen=null},t,this)},i.prototype.animationFadeToBlack=function(t,e){var i=t/3;this.newScreen.alpha=0,this.currentScreen.alpha=1,this.newScreen.position.set(0,0);var n=new TweenAlpha(this.currentScreen,0,null,t/2-i/2),o=new TweenAlpha(this.newScreen,1,null,t/2-i/2,function(){e.call(app.navigator)});n.run(),timeout(function(){o.run()},t/2+i/2)},i.prototype.animationFadeIn=function(t,e){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=0;var i=new TweenAlpha(this.currentScreen,0,null,t),n=new TweenAlpha(this.newScreen,1,null,t,function(){e.call(app.navigator)});i.run(),n.run()},i.prototype.animationFadeOut=function(t,e){this.currentScreen.zIndex=1,this.newScreen.zIndex=0,this.newScreen.alpha=1,new TweenAlpha(this.currentScreen,0,new Bezier(.72,.08,.91,.68),t,function(){e.call(app.navigator)}).run()},i.prototype.animationAlpha=function(t,e){this.currentScreen.zIndex=0,this.newScreen.zIndex=1;var i=this.newScreen.filters||[],n=this.currentScreen.filters||[],o=new PIXI.filters.AlphaFilter(0);i.push(o),this.newScreen.filters=i;var s=new PIXI.filters.AlphaFilter(1);n.push(s),this.currentScreen.filters=n;var r=this.newScreen,a=this.currentScreen;this.newScreen.filterArea=new PIXI.Rectangle(0,0,app.width,app.height),this.currentScreen.filterArea=new PIXI.Rectangle(0,0,app.width,app.height);var h=new TweenAlpha(s,0,null,t),l=new TweenAlpha(o,1,null,t,function(){e.call(app.navigator),i.removeElement(o),n.removeElement(s),r.filters=i,a.filters=n});h.run(),l.run()},i.prototype.animationSlide=function(t,e,i){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=1,this.newScreen.position.set(this.app.width,0);var n=new TweenMoveTo(this.currentScreen,new V(-this.app.width,0),null,t),o=new TweenMoveTo(this.newScreen,new V(0,0),null,t,function(){i.call(app.navigator)});n.run(),o.run()},i.prototype.animationSlideOver=function(t,e,i){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.alpha=1,this.newScreen.position.set(this.app.width,0);var n=new TweenMoveTo(this.currentScreen,new V(0,0),null,0),o=new TweenMoveTo(this.newScreen,new V(0,0),null,t,function(){i.call(app.navigator)});n.run(),o.run()},i.prototype.animationDelayedRemoval=function(t,e){this.currentScreen.zIndex=0,this.newScreen.zIndex=1,this.newScreen.position.set(0,0),timeout(function(){e.call(app.navigator)},t)},i.prototype.goBack=function(t,e,n){if(this.isTransitioning)return this.queue.push({method:"goBack",duration:t,animationType:e,transitionCallback:n}),!1;this.isTransitioning=!0,this.transitionCallback=n;var o=void 0===t?200:t,s=void 0===e?i.ANIMATION_TYPE_ALPHA:e;this.screens.length>1?(this.newScreen=this.screens[this.screens.length-2],this.currentScreen.onHide(),this.currentScreen.deactivateTouchables(),this.app.stage.addChild(this.newScreen),this.newScreen.onBeforeShow(),this.screens.pop(),this.setAnimation(s,o,i.ANIMATION_DIRECTION_RIGHT,this.onTransitionFinished)):this.isTransitioning=!1,app.input.restoreCursor()},i.prototype.goToRootCallback=function(){this.currentScreen.removeFromParent(),this.currentScreen.onDestroy(),this.currentScreen.deactivateTouchables(),this.currentScreen=this.newScreen;for(var t=this.screens.length-1;t>0;t--)this.screens.splice(t,1);this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null)},i.prototype.goToIndexCallback=function(){this.currentScreen.removeFromParent(),this.currentScreen.onDestroy(),this.currentScreen.deactivateTouchables(),this.currentScreen=this.newScreen;for(var t=this.screens.length-1;t>=0;t--){if(this.screens[t]===this.newScreen)break;this.screens.splice(t,1)}this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null)},i.prototype.setCurrentAsRoot=function(){for(var t=this.screens.indexOf(this.currentScreen),e=0;e<this.screens.length;e++)e!==t&&(this.screens[e].onDestroy(),this.screens[e].deactivateTouchables());this.screens=[],this.newScreen=null,this.screens.push(this.currentScreen)},i.prototype.justDisplay=function(t){if(this.isTransitioning)return!1;this.isTransitioning=!0,this.newScreen=t,t.onShow(),this.app.stage.addChild(t),this.onTransitionFinished()},i.prototype.goToRoot=function(t,e,n){if(this.isTransitioning)return!1;if(this.isTransitioning=!0,this.screens.length){this.transitionCallback=n;var o=void 0===t?200:t;this.newScreen=this.screens[0],this.currentScreen.onHide(),this.app.stage.removeChild(this.currentScreen),this.newScreen.onShow(),this.app.stage.addChild(this.newScreen),this.setAnimation(e,o,i.ANIMATION_DIRECTION_LEFT,this.goToRootCallback)}},i.prototype.setCurrentAtIndex=function(t){for(var e=this.screens.indexOf(this.currentScreen),i=0;i<this.screens.length;i++)i!==e&&i>=t&&(this.screens[i].deactivateTouchables(),this.screens[i].onDestroy());this.screens=this.screens.slice(0,t),this.newScreen=null,this.screens.push(this.currentScreen)},i.prototype.goToIndex=function(t,e,n,o){if(this.isTransitioning)return!1;if(this.isTransitioning=!0,this.screens.length){this.transitionCallback=o;var s=void 0===e?200:e;this.newScreen=this.screens[t],this.currentScreen.onHide(),this.app.stage.removeChild(this.currentScreen),this.newScreen.onShow(),this.app.stage.addChild(this.newScreen),this.setAnimation(n,s,i.ANIMATION_DIRECTION_LEFT,this.goToIndexCallback)}},i.prototype.removePrevious=function(){if(this.screens.length>=2){var t=this.screens.length-2,e=this.screens[t];this.screens.splice(t,1),e.onDestroy(),e.deactivateTouchables()}},i.prototype.popAndGo=function(t,e,i,n,o){var s=this;this.add(t,e,i,function(){s.removePrevious(),n&&n()},o)},i.prototype.update=function(t){t*=Config.slow_motion_factor,Math.insertionSort(this.app.stage.children,function(t,e){return t.zIndex>e.zIndex}),null===this.transitionScreen||this.transitionScreen.isPaused||(this.transitionScreen.onUpdate(t),this.transitionScreen.updateChildren(t,this.transitionScreen.children),this.transitionScreen.postUpdate(t)),null===this.currentScreen||this.currentScreen.isPaused||(this.currentScreen.onUpdate(t),this.currentScreen.updateChildren(t,this.currentScreen.children),this.currentScreen.postUpdate(t)),null!==this.newScreen&&(this.newScreen.isPaused||(this.newScreen.onUpdate(t),this.newScreen.updateChildren(t,this.newScreen.children),this.newScreen.postUpdate(t)))},i.prototype.onTransitionFinished=function(){this.currentScreen.removeFromParent(),this.currentScreen.onAfterHide(),this.currentScreen=this.newScreen,this.currentScreen.onShow(),this.currentScreen.activateTouchables(),this.newScreen=null,this.isTransitioning=!1,this.transitionCallback&&(this.transitionCallback(),this.transitionCallback=null),this.processQueue()},t.HNavigator=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=Object.create(PIXI.Sprite.prototype),i.prototype.constructor=i,i.prototype.initialize=function(t){PIXI.Sprite.call(this,this.findTexture(t),!0),this.imageName=t},t.Sprite=i}(window),function(t,e){function i(){this.initialize()}i.prototype=Object.create(PIXI.Container.prototype),i.prototype.constructor=i,i.prototype.initialize=function(){PIXI.Container.call(this),this.enableSensor(),this._touchables=[],this.isPaused=!1,"undefined"!=typeof app&&(this.setSensorSize(app.width,app.height),this._background=new Sprite,this._background.texture=PIXI.Texture.WHITE,this._background.zIndex=-1,this._background.visible=!1,this._background.stretch(app.width,app.height),this.addChild(this._background)),this.constraints=new Constraints(this)},i.prototype.setBackgroundColor=function(t){t?(this._background.tint=convertColor(t),this._background.visible=!0):this._background.visible=!1},i.prototype.activateTouchables=function(){app.input.add(this._touchables)},i.prototype.deactivateTouchables=function(){app.input.remove(this._touchables)},i.prototype.addTouchable=function(t){app.input.add(t),this._touchables.push(t)},i.prototype.removeTouchable=function(t){app.input.remove(t);var e=this._touchables.indexOf(t);-1!==e&&this._touchables.splice(e,1)},i.prototype.onShow=function(){},i.prototype.onHide=function(){},i.prototype.onBeforeShow=function(){},i.prototype.onAfterHide=function(){},i.prototype.onAnimationEnd=function(){},i.prototype.onUpdate=function(t){},i.prototype.postUpdate=function(t){},i.prototype.updateChildren=function(t,e){Math.insertionSort(e,function(t,e){return t.zIndex>e.zIndex});for(var i=e.length;i-- >0;){var n=e[i];n.visible&&(n.onUpdate(t),n&&this.updateChildren(t,n.children),n.postUpdate(t))}},i.prototype.onVisibilityChange=function(t){},i.prototype._onResize=function(t,e){this.setSensorSize(t,e),this.constraints.applyValues(),this.onResize&&this.onResize(t,e)},i.prototype.onDestroy=function(){},i.prototype.goBack=function(){app.navigator.goBack()},i.prototype.goTo=function(e){if(t[e]){var i=new t[e];app.navigator.add(i)}else console.warn("Screen name does not exist: "+e)},t.HScreen=i}(window),function(t,e){function i(){this.initialize()}i.prototype=Object.create(PIXI.Container.prototype),i.prototype.constructor=i,i.prototype.initialize=function(){PIXI.Container.call(this),this.enableSensor(),this.setSensorSize(app.width,app.height)},t.Layer=i}(window),function(t,e){function i(){this.initialize()}i.prototype=Object.create(PIXI.Sprite.prototype),i.prototype.constructor=i,i.prototype.initialize=function(){PIXI.Sprite.call(this),this.points=[]},i.prototype.onUpdate=function(t){},i.prototype.setData=function(t,e,i){},i.prototype.onImport=function(){},t.LinePath=i}(window),function(t,e){function i(){this.initialize()}i.prototype=Object.create(PIXI.Sprite.prototype),i.prototype.constructor=i,i.prototype.initialize=function(){PIXI.Sprite.call(this),this.myGraphics=new PIXI.Graphics,this.addChild(this.myGraphics),this.selectedHandle=null,this.lastPoint=null,this.points=[],this.curves=[],this.sensors=[],this.curve=new BEZIER.PolyBezier,this.isAlt=!1,this.isCtrl=!1,this.type="PolyBezier"},i.prototype.build=function(t){if(this.canResize=!1,this.hasFrame=!1,t){for(var e=0;e<t.points.length;e++){var i=new OV(t.points[e].x,t.points[e].y);this.addPoint(i)}for(e=0;e<t.points.length;e++){var n=t.points[e];i=this.points[e];if(n.handles)for(var o=0;o<n.handles.length;o++){var s=n.handles[o],r=i.handles[o];s.x===r.sensor.pos.x&&s.y===r.sensor.pos.y||(r.sensor.pos.x=s.x,r.sensor.pos.y=s.y,r.enabled=!0)}}this.position.set(t.position.x,t.position.y),this.id=t.id,this.className=t.className}this.enableSensor()},i.prototype.get=function(t){for(var e=this.curve.length(),i=Math.lerp(t,0,e),n=null,o=0;o<this.curves.length;o++){var s=(n=this.curves[o]).length();if((i-=s)<=0){var r=1-Math.abs(i)/s;return n.getEqual(r)}}return n.get(1)},i.prototype.animate=function(t,e,i){t=t||2e3;var n=this;new Stepper(function(t,e,i){var o=n.get(t);this.renderMe(),this.myGraphics.clear(),this.myGraphics.lineStyle(2,0,1),this.myGraphics.beginFill(16777215,.5),this.myGraphics.drawCircle(o.x,o.y,10),this.myGraphics.endFill()},t,null,null,function(){e&&e.call(i||n,this),this.myGraphics.clear()},this).run()},i.prototype.addPoint=function(t){if(t.basePoint=null,t.handles=[],t.curves=[],t.callback=this.onHandleMove,t.context=this,t.sensor=this.createSensor(t,!0),this.points.push(t),this.lastPoint){var e=new OV(this.lastPoint.x,this.lastPoint.y),i=new OV(t.x,t.y),n=new BEZIER.Bezier(this.lastPoint,e,i,t);this.curves.push(n),e.sensor=this.createSensor(e,!1),i.sensor=this.createSensor(i,!1),e.basePoint=this.lastPoint,i.basePoint=t,e.curves=[],i.curves=[],t.curves.push(n),this.lastPoint.curves.push(n),e.curves.push(n),i.curves.push(n),e.handles=[],i.handles=[],this.lastPoint.handles.push(e),t.handles.push(i),e.callback=this.onHandleMove,e.context=this,i.callback=this.onHandleMove,i.context=this,Math.bubbleSort(this.sensors,function(t,e){return!(!t.pos.enabled||e.pos.enabled)}),this.curve.addCurve(n)}this.lastPoint=t},i.prototype.createSensor=function(t,e){t.callback=this.onHandleMove,t.context=this,t.index=this.sensors.length;var i=new SAT.Circle(t,20);return i.pos.enabled=e,this.sensors.push(i),i},i.prototype.renderMe=function(){this.myGraphics.clear();for(var t=0;t<this.curves.length;t++){var e=this.curves[t];this.renderMePolyBezier(e,this.myGraphics)}this.renderMeHandles(this.myGraphics)},i.prototype.renderMePolyBezier=function(t,e){e.beginFill(16777215,0),e.lineStyle(4,1841640,1);var i=t.points[0];e.moveTo(i.x,i.y),e.lineTo(i.x,i.y);for(var n=1;n<50;n++){var o=t.get(n/50);e.lineTo(o.x,o.y)}i=t.get(1);e.lineTo(i.x,i.y),e.lineStyle(1,2236962,1);var s=t.points;e.moveTo(s[0].x,s[0].y),e.lineTo(s[1].x,s[1].y),e.moveTo(s[2].x,s[2].y),e.lineTo(s[3].x,s[3].y),e.endFill()},i.prototype.renderMeHandles=function(t){t.lineStyle(2,0,1),t.beginFill(16777215,.5);for(var e=0;e<this.sensors.length;e++){var i=this.sensors[e];t.drawCircle(i.pos.x,i.pos.y,i.r)}t.endFill()},i.prototype.onHandleMove=function(t){if(t.basePoint){if(!this.isCtrl&&!this.isAlt)for(var e=0;e<t.basePoint.handles.length;e++){var i=t.basePoint.handles[e];if(i.index!==t.index){var n=Math.getDistance(i,t.basePoint),o=Math.getAngle(t,t.basePoint),s=new V;s.setLength(n),s.setAngle(o),s=V.addition(t.basePoint,s),i._x=s.x,i._y=s.y}}}else for(e=0;e<t.handles.length;e++){var r=t.handles[e];r.sensor.pos.enabled||(r._x=t.x,r._y=t.y)}for(e=0;e<t.curves.length;e++){t.curves[e].update()}},i.prototype.onUpdate=function(){},t.PolyBezier=i}(window),Default={properties:{Label:{width:0},Button:{imageNormal:"white",imageSelected:"white",width:200,height:80,padding:"1",offsetX:0,offsetY:0,sensorWidth:0,sensorHeight:0,labelRotation:0,isNineSlice:!0,backgroundColorNormal:"#8AC6D0",backgroundColorDown:"#50A8B9",backgroundColorHover:"#C5E2E8",backgroundColorDisabled:"#bababa",textColorNormal:"#36213E",textColorDown:"#36213E",textColorHover:"#36213E",textColorDisabled:"#cccccc",onMouseDown:"",onMouseMove:"",onMouseUp:"",onMouseCancel:""},Input:{width:320,height:90,padding:"20",sensorWidth:0,sensorHeight:0,hasPlaceholder:!1,hasNext:!1,placeholderColor:"#555555",input_type:0,doneText:"",scrollTo:""},NineSlice:{width:250,height:100,backgroundName:"white",tintColor:"#ffffff",padding:"1",sensorWidth:0,sensorHeight:0},TilingSprite:{width:250,height:100,backgroundName:"white",tilePositionX:0,tilePositionY:0,tileScaleX:1,tileScaleY:1}},styles:{Label:{_align:"left",_breakWords:!1,_dropShadow:!1,_dropShadowAlpha:1,_dropShadowAngle:.5235987755982988,_dropShadowBlur:0,_dropShadowColor:"black",_dropShadowDistance:0,_fill:"#36213E",_fillGradientType:0,_fontFamily:"'Arial Black', Gadget, sans-serif",_fontSize:50,_fontStyle:"normal",_fontVariant:"normal",_fontWeight:"normal",_leading:0,_letterSpacing:0,_lineHeight:0,_lineJoin:"miter",_miterLimit:10,_padding:4,_stroke:"black",_strokeThickness:0,_textBaseline:"alphabetic",_trim:!1,_whiteSpace:"pre",_wordWrap:!1,_wordWrapWidth:100}},stylesClean:{Label:{align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:.5235987755982988,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:0,fill:"#36213E",fillGradientType:0,fontFamily:"'Arial Black', Gadget, sans-serif",fontSize:50,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:4,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100}}},Default.properties.LabelObject=Default.properties.Label,Default.properties.ButtonObject=Default.properties.Button,Default.properties.NineSliceObject=Default.properties.NineSlice,Default.properties.TilingSpriteObject=Default.properties.TilingSprite,Default.styles.LabelObject=Default.styles.Label,Default.styles.Button=Default.styles.Label,Default.styles.ButtonObject=Default.styles.Label,Default.stylesClean.LabelObject=Default.stylesClean.Label,Default.stylesClean.Button=Default.stylesClean.Label,Default.stylesClean.ButtonObject=Default.stylesClean.Label,function(t,e){function i(t,e){this.initialize(t,e)}i.prototype=Object.create(PIXI.Text.prototype),i.prototype.constructor=i,i.TEXT_H_ALIGN_CENTER="center",i.TEXT_H_ALIGN_LEFT="left",i.TEXT_H_ALIGN_RIGHT="right",i.TEXT_V_ALIGN_TOP="top",i.TEXT_V_ALIGN_MIDDLE="middle",i.TEXT_V_ALIGN_BOTTOM="bottom",i.TEXT_V_ALIGN_ALPHABETIC="alphabetic",i.prototype.initialize=function(t,e){t=t||{},PIXI.Text.call(this,e||"Default Label Text"),this.resolution=2,this.setStyle(t)},i.prototype.setStyle=function(t){this.style=t},i.prototype.clone=function(){return null},i.prototype.onUpdate=function(t){},Object.defineProperty(i.prototype,"txt",{get:function(){return this._txt},set:function(t){this._txt=t,this.text=t}}),t.Label=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t){this.spriteInitialize(null),this.setSensorSize(app.width,app.height),this.anchor.set(.5,.5),this.position.set(app.width/2,app.height/2),this.delegate=t,this.visible=!1,this.priority=1e3,this.background=new Sprite(null),this.background.anchor.set(.5,.5),this.background.zIndex=-1,this.addChild(this.background)},i.prototype.onMouseDown=function(t,e){t.stopPropagation()},i.prototype.show=function(t){this.delegate.addChild(this),this.visible=!0,t?(this.alpha=1,this.scale.set(1)):(this.background.alpha=0,this.background.scale.set(.2),new TweenAlpha(this.background,1,null,200).run(),new TweenScale(this.background,1,new Bezier(.18,.66,.64,1.23),200).run()),app.input.add(this)},i.prototype.hide=function(t){if(t){var e=new Bezier(.44,-.51,.76,.36);new TweenAlpha(this,0,null,300).run(),new TweenScale(this,.5,e,300,function(t){t.removeFromParent()}).run()}else this.removeFromParent();app.input.remove(this)},t.Popup=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t){this.spriteInitialize(t),this.TYPE=i.TYPE},i.prototype.setSize=function(t,e){this._width=t,this._height=e},i.prototype.onUpdate=function(t){},t.ScrollviewContent=i}(window),function(t,e){function i(t,e){this.initialize(t,e)}i.prototype=new Sprite,i.prototype.parentInitialize=Sprite.prototype.initialize,i.TYPE_NORMAL=0,i.TYPE_NINE_SLICE=1,i.prototype.initialize=function(t,e){var n=(e=e||{}).style||{fontFamily:"ArialHebrew-Bold,Impact"};this.parentInitialize(),e.properties=e.properties||{},e.properties.backgroundColorNormal=e.properties.backgroundColorNormal?e.properties.backgroundColorNormal:"#8AC6D0",e.properties.backgroundColorDown=e.properties.backgroundColorDown?e.properties.backgroundColorDown:"#50A8B9",e.properties.backgroundColorHover=e.properties.backgroundColorHover?e.properties.backgroundColorHover:"#C5E2E8",e.properties.backgroundColorDisabled=e.properties.backgroundColorDisabled?e.properties.backgroundColorDisabled:"#bababa",e.properties.textColorNormal=e.properties.textColorNormal?e.properties.textColorNormal:"#36213E",e.properties.textColorDown=e.properties.textColorDown?e.properties.textColorDown:"#36213E",e.properties.textColorHover=e.properties.textColorHover?e.properties.textColorHover:"#36213E",e.properties.textColorDisabled=e.properties.textColorDisabled?e.properties.textColorDisabled:"#cccccc",e.properties.imageNormal=e.properties.imageNormal?e.properties.imageNormal:"white",e.properties.imageSelected=e.properties.imageSelected?e.properties.imageSelected:"white",e.properties.padding=e.properties.padding?e.properties.padding:"1",e.properties.width=e.properties.width?e.properties.width:200,e.properties.height=e.properties.height?e.properties.height:80,e.properties.isNineSlice=void 0===e.properties.isNineSlice||e.properties.isNineSlice,this.properties=e.properties,this.type=void 0===this.properties.isNineSlice||!0===this.properties.isNineSlice?i.TYPE_NINE_SLICE:i.TYPE_NORMAL,this.offsetX=this.properties.offsetX||0,this.offsetY=this.properties.offsetY||0,this._isTinted=!1,this.background=new Sprite,this.anchor.set(.5,.5),this.label=new Label(n),this.label.txt=t,this.label.anchor.set(.5,.5),this.label.rotation=this.properties.labelRotation||0,this.type===i.TYPE_NORMAL?(this.imageNormal=this.properties.imageNormal||null,this.imageSelected=this.properties.imageSelected||null,this.background=new Sprite(this.imageNormal),this.background.centered(),this.addChild(this.background),this.setSensorSize(this.background.width,this.background.height)):this.type===i.TYPE_NINE_SLICE&&(this.background=new NineSlice(this.properties.imageNormal,this.properties.padding||"10"),this.background.setSize(this.properties.width||200,this.properties.height||80),this.addChild(this.background),this.background.tint=convertColor(this.properties.backgroundColorNormal),this.label.style.fill=this.properties.textColorNormal,this.setSensorSize(this.background.width,this.background.height)),this.addChild(this.label),this.priority=10,this.isHoverReactive=!0,this.isHovered=!1},i.prototype.onUpdate=function(t){this.disabled||(this.type===i.TYPE_NORMAL?this.handleNormalType(t):this.type===i.TYPE_NINE_SLICE&&this.handleNineSlice(t)),this.label.position.set(this.offsetX,this.offsetY),this.isHoverReactive&&!this.disabled&&(this._check(app.input.point)?this.onHoverIn():this.onHoverOut())},i.prototype.onHoverIn=function(){this.isHovered||(this.type===i.TYPE_NINE_SLICE&&(this.background.tint=convertColor(this.properties.backgroundColorHover)),this.label.style.fill=this.properties.textColorHover,this.isHovered=!0,app.input.setCursor("pointer"))},i.prototype.onHoverOut=function(){this.isHovered&&(this.type===i.TYPE_NINE_SLICE&&(this.background.tint=convertColor(this.properties.backgroundColorNormal)),this.label.style.fill=this.properties.textColorNormal,this.isHovered=!1,app.input.setCursor("default"))},i.prototype.handleNormalType=function(t){this.isMouseDown?this.imageSelected?this.imageNormal===this.imageSelected?this.background.tint=14540253:this.imageNormal!==this.imageSelected&&this.background.setTexture(this.imageSelected):this.background.tint=14540253:(this.background.tint=16777215,this.imageNormal&&this.imageNormal!==this.imageSelected&&this.background.setTexture(this.imageNormal))},i.prototype.handleNineSlice=function(t){this.isMouseDown&&!this._isTinted?(this.background.tint=convertColor(this.properties.backgroundColorDown),this.label.style.fill=this.properties.textColorDown,this._isTinted=!0):!this.isMouseDown&&this._isTinted&&(this.background.tint=convertColor(this.properties.backgroundColorNormal),this.label.style.fill=this.properties.textColorNormal,this._isTinted=!1)},i.prototype.onMouseMove=function(t){this._check(t.point)||(this.eventIdx=-1,this.isMouseDown=!1,this.onMouseCancel(t,this))},Object.defineProperty(i.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t?(this.background.tint=convertColor(this.properties.backgroundColorDisabled),this.label.style.fill=this.properties.textColorDisabled,this.isTouchable=!1,this.isHovered&&app.input.restoreCursor()):(this.background.tint=convertColor(this.properties.backgroundColorNormal),this.label.style.fill=this.properties.textColorNormal,this.isTouchable=!0),this._disabled=t}}),Object.defineProperty(i.prototype,"imageNormal",{get:function(){return this._imageNormal},set:function(t){this._imageNormal=t,this.type===i.TYPE_NORMAL&&(this.background.setTexture(t),this.setSensorSize(this.background.width,this.background.height))}}),Object.defineProperty(i.prototype,"imageSelected",{get:function(){return this._imageSelected},set:function(t){this._imageSelected=t}}),Object.defineProperty(i.prototype,"txt",{get:function(){return this._text},set:function(t){this._text=t,this.label.txt=t}}),t.Button=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.SUCCESS=0,i.WARRNING=1,i.ERROR=2,i.prototype=Object.create(PIXI.Container.prototype),i.prototype.constructor=i,i.prototype.initialize=function(t,e,i){PIXI.Container.call(this),this.message=t,i=i||{};this.fontSize=app.width<app.height?app.width/app.height*100:app.height/app.width*100*2,this.textureName=i.texture||"white",this.fontFamily=i.fontFamily||"Helvetica,San Fancisco,ArialHebrew-Bold",this.fontSize=i.fontSize||this.fontSize,this.padding=i.padding||25,this.backgroundAlpha=i.alpha||.95,this.duration=3e3,this.subTitle=i.subTitle||"",this.yesText=i.yesText||"Yes",this.acceptCallback=e,this.animation=null,this.backColor=i.backColor||5000035,this.textColor=i.textColor||16777215,i&&(this.duration=i.duration||this.duration,this.backgroundAlpha=i.alpha||this.backgroundAlpha,this.fontSize=i.fontSize||this.fontSize),this.zIndex=1e3,this.build()},i.prototype.build=function(){var t=null;"white"===this.textureName?(t=new Sprite("white")).setSize=function(t,e){this.stretch(t,e)}.bind(t):t=new NineSlice(this.textureName,"20"),this.addChild(t);var e=0,i=this.padding;e=app.width;e=Math.clamp(e,200,1600);var n=new Label;n.style.fontFamily=this.fontFamily,n.style.fontSize=this.fontSize,n.style.fill=this.textColor,n.style.wordWrap=!0,n.style.wordWrapWidth=e-2*i,n.txt=this.message,n.anchor.set(0,0),n.x=i,n.y=i,this.addChild(n),this.buttons=[];var o=new Button(this.yesText,{style:{fontSize:30,fontFamily:this.fontFamily},properties:{imageNormal:"white",imageSelected:"white",width:200,height:80,padding:"1",isNineSlice:!0,backgroundColorNormal:"#16b86c",backgroundColorDown:"#14a863",backgroundColorHover:"#1fcf7d",backgroundColorDisabled:"#DEDEDE",textColorNormal:"#FFFFFF",textColorDown:"#FFFFFF",textColorHover:"#FFFFFF",textColorDisabled:"#cccccc"}});o.name=this.yesText,o.onMouseUp=function(t,e){this.onCallback(t,this)}.bind(this),o.x=e-150,o.y=n.y+n.height/2,o.priority=1e3,this.addChild(o),this.buttons.push(o),this._height=n.height+2*i,this._width=e,t.setSize(Math.max(e,n.width),this._height),t.alpha=this.backgroundAlpha,t.tint=this.backColor,"white"!==this.textureName&&(t.x=t._width/2,t.y=t._height/2),this.sensor=null,this.setSensorSize(this._width,this._height)},i.prototype.onCallback=function(t,e){Actions.stopByTag("call-to-action-loop"),this.removeFromParent();for(var i=0;i<this.buttons.length;i++){var n=this.buttons[i];app.input.remove(n)}this.acceptCallback&&this.acceptCallback(t,e)},i.show=function(t,e,n){var o=new i(t,e,n);i.animate(o)},i.animate=function(t){app.stage.addChild(t),t.x=(app.width-t._width)/2,t.y=app.height,t.alpha=0;for(var e=0;e<t.buttons.length;e++){var i=t.buttons[e];app.input.add(i)}t.animation=new Sequencer,t.animation.addThread([new TweenGeneric(t,{y:app.height-t._height,alpha:1},null,200)]),t.animation.run(),new TweenInfinity(function(e,i){for(var n=0;n<t.buttons.length;n++){t.buttons[n].onUpdate(e)}}).run("call-to-action-loop")},t.CallToAction=i}(window),function(t,e){function i(){this.initialize()}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(){this.spriteInitialize(),this.buttons=[],this.inputs=[],this.radioButtons=[],this.priority=2,this.delegate=null},i.prototype.enableButtons=function(t){for(var e=0;e<this.buttons.length;e++){(i=this.buttons[e]).isTouchable=t}for(e=0;e<this.inputs.length;e++){(i=this.inputs[e]).isTouchable=t}for(e=0;e<this.radioButtons.length;e++){var i;(i=this.radioButtons[e]).isTouchable=t,t?Notes.add(i,Notes.RADIO_BUTTON_SELECTED):Notes.remove(i,Notes.RADIO_BUTTON_SELECTED)}this.isTouchable=t},i.prototype.show=function(t){t?(this.visible=!0,this.enableButtons(!0),t.addChild(this),this.alpha=0,this.scale.x=.5,new TweenScale(this,1,new Bezier(.17,.67,.62,1.17),200).run(),new TweenAlpha(this,1,null,200).run()):console.warn("You need to set a layer")},i.prototype.hide=function(t){t?(this.removeFromParent(),this.enableButtons(!1),this.visible=!1):new TweenAlpha(this,0,null,200,function(){this.object.removeFromParent(),this.object.enableButtons(!1),this.object.visible=!1},this).run()},i.prototype.setData=function(t){this.setTexture(t.imageName)},i.prototype.onImport=function(){this._findButtons(this.children),this._findInputs(this.children),this._findRadioButtons(this.children);for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t];e.onMouseDown=this.onBtnDown.bind(this),e.onMouseUp=this.onBtn.bind(this)}this.visible=!0},i.prototype._findButtons=function(t){for(var e=0;e<t.length;e++){var i=t[e];(i instanceof Button||i instanceof TableView)&&this.buttons.push(i),this._findButtons(i.children)}},i.prototype._findInputs=function(t){for(var e=0;e<t.length;e++){var i=t[e];i instanceof InputField&&this.inputs.push(i),this._findInputs(i.children)}},i.prototype._findRadioButtons=function(t){for(var e=0;e<t.length;e++){var i=t[e];i instanceof RadioButton&&this.radioButtons.push(i),this._findRadioButtons(i.children)}},i.prototype.onBtnDown=function(t,e){t.stopPropagation()},i.prototype.onBtn=function(t,e){t.stopPropagation(),this.delegate&&this.delegate.onPopup&&!1===this.delegate.onPopup(this,e)||this.hide()},i.prototype.onMouseDown=function(t,e){t.stopPropagation()},i.prototype.onUpdate=function(t){},t.GenericPopup=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t){if(!t)throw"You must initialize the InputContent with a delegate";this.spriteInitialize(null),this.delegate=t,this.keyboard=new Keyboard(this),this.delegate.addChild(this.keyboard),this.inputFields=[],this.priority=-100,this._inputTabCounter=0,this.tabIndex=0,this.setSensorSize(app.width,app.height)},i.prototype.addInput=function(t){t.setKeyboard(this.keyboard),t.tabIndex=this._inputTabCounter++,t.delegate=this,t.onFocus=i.prototype.onInputFocus.bind(this),this.inputFields.push(t),app.input.add(t)},i.prototype.onInputFocus=function(t){this.tabIndex=t.tabIndex;for(var e=0;e<this.inputFields.length;e++){var i=this.inputFields[e];Object.is(t,i)||(i.isFocused&&this.delegate&&this.delegate.onKeyboardInputBlur&&this.delegate.onKeyboardInputBlur(t),i.blur())}this.delegate&&this.delegate.onKeyboardInputFocus&&this.delegate.onKeyboardInputFocus(t)},i.prototype.onMouseUp=function(e,i){for(var n=0;n<this.inputFields.length;n++){var o=this.inputFields[n];o.isFocused&&this.delegate&&this.delegate.onKeyboardInputBlur&&this.delegate.onKeyboardInputBlur(o),o.blur()}t.focus()},i.prototype.onMouseCancel=function(e,i){for(var n=0;n<this.inputFields.length;n++){var o=this.inputFields[n];o.isFocused&&this.delegate&&this.delegate.onKeyboardInputBlur&&this.delegate.onKeyboardInputBlur(o),o.blur()}t.focus()},i.prototype.onKeyboardShow=function(){var t=this.position.y,e=this.keyboard.getSize(),i=new V(0,-e.height);Actions.stopByTag("animate_content");for(var n=new V,o=null,s=0;s<this.inputFields.length;s++){var r=this.inputFields[s];r.isFocused&&(o=r,n.copy(r.getGlobalPosition()))}if(o.scrollToY)new TweenMoveTo(this,new V(0,o.scrollToY-n.y),null,200).run("animate_content");else{var a=(app.height-e.height)/2;i.y=a-n.y+t,i.y<-e.height&&(i.y=-e.height);var h=app.height-e.height;(n.y+o._height/2>h||n.y-o._height/2<0)&&new TweenMoveTo(this,i,null,200).run("animate_content")}this.delegate&&this.delegate.onKeyboardActivated&&this.delegate.onKeyboardActivated()},i.prototype.onKeyboardHide=function(){var t=new V(0,0);Actions.stopByTag("animate_content"),new TweenMoveTo(this,t,null,200).run("animate_content"),this.delegate&&this.delegate.onKeyboardActivated&&this.delegate.onKeyboardDismissed()},i.prototype.onTab=function(){if(this.inputFields.length)for(var t=++this.tabIndex%this.inputFields.length,e=0;e<this.inputFields.length;e++){var i=this.inputFields[e];if(i.tabIndex===t){i.focus();break}}},i.prototype.onShiftTab=function(){if(this.inputFields.length){var t=--this.tabIndex%this.inputFields.length;t=t<0?this.inputFields.length+t:t;for(var e=0;e<this.inputFields.length;e++){var i=this.inputFields[e];if(i.tabIndex===t){i.focus();break}}}},i.prototype.onEsc=function(){for(var e=0;e<this.inputFields.length;e++){this.inputFields[e].blur()}t.focus()},i.prototype.onEnter=function(){this.delegate&&this.delegate.onKeyboardDone&&this.delegate.onKeyboardDone();for(var e=0;e<this.inputFields.length;e++){var i=this.inputFields[e];i.isFocused&&i.onEnter(i),i.blur()}t.focus()},i.prototype.onInputAdded=function(){app.input.add(this.inputFields)},i.prototype.onInputRemoved=function(){app.input.remove(this.inputFields),this.keyboard.hide(!0);for(var t=0;t<this.inputFields.length;t++){this.inputFields[t].blur()}},i.prototype.onStreamChanged=function(t,e,i){this.delegate&&this.delegate.onKeyboardStream&&this.delegate.onKeyboardStream(t,e,i)},i.prototype.onKeyboardDone=function(){this.delegate&&this.delegate.onKeyboardDone&&this.delegate.onKeyboardDone()},i.prototype.onUpdate=function(t){},t.InputContent=i}(window),function(t,e){function i(t,e,i,n,o){this.initialize(t,e,i,n,o)}i.TYPE_ALL=0,i.TYPE_ALPHA_NUMERIC=1,i.TYPE_NUMERIC=2,i.TYPE_ALPHABETIC=3,i.TYPE_DECIMAL=4,i.TYPE_NUMERIC_SYMBOLS=5,i.TYPE_EMAIL=6,i.MODE_STANDARD=0,i.MODE_CENTER=1,i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,n,o,s){this.spriteInitialize(),this.delegate=s,this.keyboard=null,this.setKeyboard(o),this.type=e||i.TYPE_ALL,this.mode=n||i.MODE_STANDARD,this.hasNext=!1,this.isFocused=!1,this.priority=10,this.stream="",this.doneText=null,this.placeholder="",this.tabIndex=0,this.scrollToY=0,this.padding=20,this.fontSize=t?t.fontSize:30,this.cursorColor=0,this.originalColor=t?t.fill:"#000000",this.placeholderColor=t&&t.placeholderColor||"#bbbbbb",this.backgroundImageName=t?t.background:"button",this.backgroundPadding=t?t.backgroundPadding||"10":"20",this.anchor.set(.5,.5),this.background=new NineSlice(this.backgroundImageName,this.backgroundPadding),this.addChild(this.background),this.label=new Label(t),this.addChild(this.label),this.cursor=new Sprite("white"),this.cursor.tint=this.cursorColor,this.cursor.anchor.set(.5,.5),this.addChild(this.cursor),this.setText(""),this.blink=new TweenBlink(this.cursor,0,null,400),this.blur()},i.prototype.setKeyboard=function(t){this.keyboard=t,t&&this.keyboard.subscribe(this)},i.prototype.setSize=function(t,e){this._width=t,this._height=e,this.setSensorSize(t,e),this.label&&this.build()},i.prototype.setFontSize=function(t){this.label.style.fontSize=this.fontSize=t},i.prototype.build=function(){var t=this._width,e=this._height;this.cursor.tint=this.cursorColor,this.label.style.fontSize=this.fontSize?this.fontSize:Math.round(.7*e),this.mode===i.MODE_CENTER?(this.label.anchor.set(.5,.5),this.label.position.set(0,0)):this.mode===i.MODE_STANDARD&&(this.label.anchor.set(0,.5),this.label.position.set(-t/2+this.padding,0)),this.background.setSize(t,e),this.cursor.stretch(2,e-2*this.padding)},i.prototype.onKeyboardChange=function(t){this.isFocused&&this.setStream(t)},i.prototype.onMouseDown=function(t,e){t.stopPropagation()},i.prototype.onMouseUp=function(t,e){this.focus()},i.prototype.onFocus=function(t){},i.prototype.onBlur=function(t){},i.prototype.focus=function(){document.activeElement&&document.activeElement.blur(),t.focus(),this.isFocused||(this.onFocus(this),this.blink.run(),this.isFocused=!0,this.keyboard.hasNext=this.hasNext,app.device.isTouch&&(this.keyboard.setDoneText(this.doneText),this.keyboard.show(this.type)),this.keyboard.kiboRegister(),this.keyboard.kiboSetType(this.type),this.label.txt===this.placeholder&&(this.setText(""),this.label.style.fill=this.originalColor),this.keyboard.stream=this.stream,this.keyboard.limit=this.limit)},i.prototype.blur=function(){this.blink.stop(),this.cursor.alpha=0,this.isFocused=!1,this.keyboard&&(this.keyboard.kiboUnregister(),app.device.isTouch&&this.keyboard.hide()),""===this.label.txt.trim()?this.placeholder?(this.setText(this.placeholder),this.label.style.fill=this.placeholderColor):this.label.style.fill=this.originalColor:this.label.txt.trim()!==this.placeholder&&(this.label.style.fill=this.originalColor),this.onBlur(this)},i.prototype.setLimit=function(t){this.limit=t,this.keyboard.limit=t},i.prototype.setStream=function(t,e){var i=this.stream;if(this.stream=this.keyboard.stream=t,e=void 0===e||e,this.delegate&&this.delegate.on_stream_change){var n=this.delegate.on_stream_change(t,this);!1!==n&&this.setText(n)}else this.setText(t);this.stream===this.placeholder?this.label.style.fill=this.placeholderColor:this.label.style.fill=this.originalColor,this.delegate&&this.delegate.onStreamChanged&&e&&this.delegate.onStreamChanged(t,i,this)},i.prototype.setText=function(t){var e=this._width;this.label.txt=t;var n=this.label.position;if(this.mode===i.MODE_CENTER?(""===this.label.txt?this.cursor.position.set(0,0):this.cursor.position.set(this.label.width/2+5,0),this.label.position.set(0,0)):this.mode===i.MODE_STANDARD&&(""===this.label.txt?this.cursor.position.set(n.x+5,0):this.cursor.position.set(n.x+this.label.width+5,0),this.label.position.set(-e/2+this.padding,0)),this.label.width>=this._width-2*this.padding&&1!==this._width){if(this.label.mask||this.setMask(),this.mode===i.MODE_CENTER);else if(this.mode===i.MODE_STANDARD){var o=this.label.width-(e-2*this.padding);this.label.position.set(-e/2+this.padding-o,0)}this.cursor.position.set(e/2-this.padding,0)}else this.label.mask&&(this.label.mask.removeFromParent(),this.label.mask=null);this.label.style.fill=this.originalColor},i.prototype.setMask=function(){var t=this.label.mask;!t&&this._width&&this._height&&(t=new PIXI.Graphics,this.addChild(t),t.clear(),t.beginFill(),t.drawRect(-this._width/2+this.padding,-this._height/2,this._width-2*this.padding,this._height),t.endFill(),this.label.mask=t)},i.prototype.getText=function(){return this.label.txt===this.placeholder?"":this.label.txt},i.prototype.getStream=function(){return this.stream},i.prototype.setPlaceholder=function(t,e){this.placeholder=t,this.setText(t),this.label.style.fill=e||this.placeholderColor,e&&(this.placeholderColor=e)},i.prototype.onEnter=function(t){},i.prototype.onUpdate=function(t){},t.InputField=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.VERTICAL=0,i.HORIZONTAL=1,i.prototype.initialize=function(e,i,n){this.spriteInitialize(),this.type=n,this.delegate=e,this.priority=99,this.orientation=i,this.openPosition=new V,this.deleteMainTimer=null,this.deleteIntervalTimer=null,this.limit=0,this.stream="",this.hasNext=!1,this.subscribers=[],this.mainSymbols=[],this.is2ndSymbols=!1,this.numberOfRows=-1,this.cellWidth=app.width/10,this.cellHeight=1.5*this.cellWidth,this.fontSize=null,this.keySpacingX=Config.keyboardSpacingX||.08*this.cellWidth,this.keySpacingY=Config.keyboardSpacingY||.12*this.cellHeight,this.raisedBed=void 0===Config.hasRaisedBed?null:Config.hasRaisedBed,this.doneText=Config.keyboardDoneText||"Done",this.nextText=Config.keyboardNextText||"Next",this.isVibrating=void 0===Config.keyboardVibrate||Config.keyboardVibrate,this.previewKeyOffsetY=this.cellHeight/2,this.capitalizeKey=null,this.colors={layoutBackground:15395823,specialKeys:{background:14277861,text:0,backgorundPressed:31223,textPressed:16777215,dropShadow:5592405},keys:{background:16777215,text:0,backgorundPressed:15658734,textPressed:0,dropShadow:8947848},done:{background:31223,text:16777215,backgorundPressed:15658734,textPressed:0,dropShadow:10066329},preview:{background:16777215,text:5592405},capitalize:{background:31223,text:16777215,backgorundPressed:31223,textPressed:16777215,dropShadow:5592405}},Config.keyboardColors,this.digits=["1","2","3","4","5","6","7","8","9","0"],this.symbolsGeneric=["-","/",":",";","(",")","$","&","@",'"'],this.symbolsMore=["_","\\","|","~","<",">","","","",""],this.symbolsInterpunkt=[".",",","?","!","'"],this.symbolsMath=["[","]","{","}","#","%","^","*","+","="],this.alphabets=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],this.firstPage=this.alphabets,this.secondPage=[this.digits,this.symbolsGeneric,this.symbolsInterpunkt],this.thirdPage=[this.symbolsMath,this.symbolsMore,this.symbolsInterpunkt],this.buttons=[],this.background=null,this.isCapital=!1,this.isShown=!1,this.isSymbol=!1,this.showCapitalize=!0,this.showSymbols=!0,this.showDot=!0,this.preview=this.createButton("",100,100,0,0,this.colors.preview),this.preview.visible=!1,this.preview.zIndex=1,this.addChild(this.preview),this.visible=!1,this.hide(),this.position.set(0,app.height),this.kibo=new Kibo(t.document,this),this.kiboUnregister(),this.zIndex=100},i.prototype.setDoneText=function(t){null!==t?(this.doneText=t,this.nextText=t):(this.doneText=Config.keyboardDoneText||"Done",this.nextText=Config.keyboardNextText||"Next")},i.prototype.kiboSetType=function(t){this.type=t,this.kibo.unregisterAll();var e=this.getConfByType(this.type);this.kibo.down(e,this.kiboDown),this.kibo.down("backspace",this.kiboDownBackspace),this.kibo.down("tab",this.kiboTab),this.kibo.down("shift tab",this.kiboShiftTab),this.kibo.down("esc",this.kiboEsc),this.kibo.down("enter",this.kiboEnter)},i.prototype.kiboDown=function(t){if(!(this.limit>0&&this.limit<=this.stream.length))return this.stream+=t.key,this.onChange(this.stream),!1},i.prototype.kiboDownBackspace=function(t){return this.stream=this.stream.slice(0,-1),this.onChange(this.stream),!1},i.prototype.kiboRegister=function(){Kibo.registerEvent(this.kibo.element,"keydown",this.kibo.downHandler),Kibo.registerEvent(this.kibo.element,"keyup",this.kibo.upHandler)},i.prototype.kiboUnregister=function(){Kibo.unregisterEvent(this.kibo.element,"keydown",this.kibo.downHandler),Kibo.unregisterEvent(this.kibo.element,"keyup",this.kibo.upHandler)},i.prototype.getConfByType=function(t){return t===InputField.TYPE_ALL?["any letter","any number","space","any symbols"]:t===InputField.TYPE_ALPHABETIC?["any letter","space"]:t===InputField.TYPE_ALPHA_NUMERIC?["any number","any letter","space"]:t===InputField.TYPE_DECIMAL?["any number","any decimals"]:t===InputField.TYPE_NUMERIC?["any number"]:t===InputField.TYPE_NUMERIC_SYMBOLS?["any number","any symbols"]:["any letter","any number","space","any symbols"]},i.prototype.loadKeyboardSymbols=function(){var t=this.type;this.isSymbol=!1,this.showDot=!1,this.secondPage=[this.digits,this.symbolsGeneric,this.symbolsInterpunkt],t===InputField.TYPE_NUMERIC?(this.firstPage=[[",","7","8","9"],[".","4","5","6"],["0","1","2","3"]],this.showSymbols=!1,this.showCapitalize=!1):t===InputField.TYPE_ALPHABETIC?(this.firstPage=this.alphabets,this.showSymbols=!1,this.showCapitalize=!0):t===InputField.TYPE_ALPHA_NUMERIC?(this.firstPage=[this.digits,this.alphabets[0],this.alphabets[1],this.alphabets[2]],this.showSymbols=!0,this.showCapitalize=!0):t===InputField.TYPE_DECIMAL?(this.firstPage=[this.digits,this.symbolsMath.slice(0,7)],this.showSymbols=!1,this.showCapitalize=!1):t===InputField.TYPE_ALL?(this.firstPage=this.alphabets,this.showSymbols=!0,this.showCapitalize=!0,this.showDot=!1):t===InputField.TYPE_NUMERIC_SYMBOLS?(this.firstPage=[[",","7","8","9"],[".","4","5","6"],["0","1","2","3"]],this.secondPage=[this.symbolsMath,this.symbolsGeneric,this.symbolsInterpunkt],this.showSymbols=!0,this.showCapitalize=!1):t===InputField.TYPE_EMAIL&&(this.firstPage=this.alphabets,this.showSymbols=!0,this.showCapitalize=!0,this.showDot=!0),this.mainSymbols=this.firstPage},i.prototype.switchSymbols=function(){this.is2ndSymbols=!1,app.input.remove(this.buttons),this.isSymbol=!this.isSymbol,this.isSymbol?this.mainSymbols=this.secondPage:this.mainSymbols=this.firstPage,this.layout(),this.position.set(this.openPosition.x,this.openPosition.y),app.input.add(this.buttons),this.isSymbol||this.setCapital(this.isCapital)},i.prototype.switchSymbolsPage=function(){app.input.remove(this.buttons),this.is2ndSymbols?this.mainSymbols=this.secondPage:this.mainSymbols=this.thirdPage,this.is2ndSymbols=!this.is2ndSymbols,this.layout(),this.position.set(this.openPosition.x,this.openPosition.y),app.input.add(this.buttons)},i.prototype.switchCapitalize=function(){this.isSymbol?this.switchSymbolsPage():(this.isCapital=!this.isCapital,this.setCapital(this.isCapital),this.capitalizeKey.colors=this.isCapital?this.colors.capitalize:this.colors.specialKeys,this.capitalizeKey.setReleased())},i.prototype.setCapital=function(t){for(var e=0;e<this.buttons.length;e++){var i=this.buttons[e];if(!i.isSpecial)if(t){var n=i.label.txt.toString().charAt(0).toUpperCase();i.label.txt=n,i.symbol=n}else{var o=i.label.txt.toString().charAt(0).toLowerCase();i.label.txt=o,i.symbol=o}}},i.prototype.subscribe=function(t){this.subscribers.push(t)},i.prototype.unsubscribe=function(t){this.subscribers.removeElement(t)},i.prototype.getSize=function(){return{width:this._width,height:this._height}},i.prototype.recalculateSize=function(){var t=1.5;app.width<app.height?(this.fontSize=Config.keyboardFontSize||.4*this.cellHeight*1,this.cellWidth=app.width/10,this.cellHeight=1.5*this.cellWidth,this.keySpacingX=Config.keyboardSpacingX||.08*this.cellWidth,this.keySpacingY=Config.keyboardSpacingY||.12*this.cellHeight):(this.cellWidth=app.width/10,this.cellHeight=.8*this.cellWidth,this.fontSize=Config.keyboardFontSize||.4*this.cellHeight,this.keySpacingX=Config.keyboardSpacingX||.08*this.cellWidth,this.keySpacingY=Config.keyboardSpacingY||.08*this.cellHeight,t=1.2),this.preview.label.style.fontSize=Math.round(this.fontSize*t*1.5),this.preview.setSize(this.cellWidth*t,this.cellHeight*t),this.numberOfRows=this.mainSymbols.length+2,this.numberOfRows-=1;var e=0;null===this.raisedBed?e=app.width<app.height?-.7*this.cellHeight:0:this.raisedBed&&(e=-.7*this.cellHeight),this.setSensorSize(app.width,this.cellHeight*this.numberOfRows-e)},i.prototype.backgroundSetup=function(){this.background&&this.background.removeFromParent(),this.background=new Sprite("white"),this.addChild(this.background),this.background.tint=this.colors.layoutBackground,this.background.width=this._width,this.background.height=this._height+500},i.prototype.layoutSymbols=function(t,e,i){for(var n=this.cellHeight/2,o=0;o<t.length;o++)for(var s=t[o],r=(app.width-s.length*e)/2,a=0;a<s.length;a++){var h=s[a];if("space"===h);else{var l=this.createButton(h,e,i,this.keySpacingX,this.keySpacingY,this.colors.keys);l.x=a*e+r+e/2,l.y=n+i*o}this.addChild(l),this.buttons.push(l)}},i.prototype.layoutSetup=function(){for(var t=0;t<this.buttons.length;t++){this.buttons[t].removeFromParent()}this.buttons=[];var e=this.cellWidth,i=this.cellHeight;this.layoutSymbols(this.mainSymbols,e,i);var n=5*e,o=app.width/2;this.showDot&&(n-=2*e,o-=e);var s=(app.width-app.width/2)/2-this.keySpacingX,r=app.width-s/2-this.keySpacingX,a=(app.width-app.width/2)/2-2*this.keySpacingX,h=new Sprite("keyboard_capitalize");h.tint=this.colors.specialKeys.text,h.fitTo(.5*e,.5*i),h.anchor.set(.5);var l=new Sprite("keyboard_symbols");l.tint=this.colors.specialKeys.text,l.fitTo(.5*e,.5*i),l.anchor.set(.5);var c=this.colors.specialKeys;!this.isSymbol&&this.isCapital&&(c=this.colors.capitalize);var u=this.createButton(this.isSymbol?l:h,1.3*e,i,this.keySpacingX,this.keySpacingY,c);u.symbol="capitalize",u.anchor.set(.5,.5),u.label.txt="",u.isSpecial=!0,this.capitalizeKey=u,l=this.isSymbol?"abc":"123";var p=this.createButton(this.isSymbol?"abc":"123",a,i,this.keySpacingX,this.keySpacingY,this.colors.specialKeys,!0);p.symbol="keyboard_symbols",p.anchor.set(.5,.5);var d=this.createButton(null,n,i,this.keySpacingX,this.keySpacingY,this.colors.keys,!0);d.symbol="space",d.anchor.set(.5,.5),d.label.txt="space",this.addChild(d);var f=null,y=null;this.showDot&&((f=this.createButton("@",e,i,this.keySpacingX,this.keySpacingY,this.colors.keys)).anchor.set(.5,.5),this.addChild(f),(y=this.createButton(".",e,i,this.keySpacingX,this.keySpacingY,this.colors.keys)).anchor.set(.5,.5),this.addChild(y),this.buttons.push(f),this.buttons.push(y));var g=new Sprite("keyboard_backspace");g.fitTo(.5*e,.5*i),g.tint=this.colors.specialKeys.text,g.anchor.set(.5);var b=this.createButton(g,1.3*e,i,this.keySpacingX,this.keySpacingY,this.colors.specialKeys,!0);b.symbol="backspace",b.anchor.set(.5,.5),b.label.txt="",this.addChild(b);var v=this.createButton(this.hasNext?this.nextText:this.doneText,s,i,this.keySpacingX,this.keySpacingY,this.colors.done,!0);v.symbol="done",v.anchor.set(.5,.5),this.addChild(v),this.buttons.push(d),this.buttons.push(b),this.buttons.push(v),this.showCapitalize&&(this.buttons.push(u),this.addChild(u)),this.showSymbols&&(this.buttons.push(p),this.addChild(p)),u.position.set(u._width/2+this.keySpacingX,i*(this.numberOfRows-2)+i/2),p.position.set(a/2+this.keySpacingX,i*(this.numberOfRows-1)+i/2),b.position.set(app.width-b._width/2-this.keySpacingX,i*(this.numberOfRows-2)+i/2),d.position.set(o,i*(this.numberOfRows-1)+i/2),v.position.set(r,i*(this.numberOfRows-1)+i/2),f&&f.position.set(r-s/2-e/2,i*(this.numberOfRows-1)+i/2),y&&y.position.set(r-s/2-e/2-e,i*(this.numberOfRows-1)+i/2)},i.prototype.createButton=function(t,e,n,o,s,r,a){o=o||0,s=s||0;var h=new NineSlice("keyboard-key","15");h.colors=r||this.colors.keys,h.isSpecial=a||!1,h.setSize(e-2*o,n-2*s),e&&n&&h.setSensorSize(e,n),null!==this.colors.keys.dropShadow&&(h.tint=this.colors.keys.dropShadow);var l=new NineSlice("keyboard-key","15");l.setSize(e-2*o,n-2*s),l.tint=this.colors.keys.background,l.y=-1,h.foreground=l,h.addChild(l);var c="string"==typeof t;return h.label=new Label({fontSize:this.fontSize*(a?.7:1),fontFamily:Config.keyboardFont||"Arial"}),h.label.anchor.set(.5),h.addChild(h.label),c?(h.label.txt=t,h.symbol=t):t&&(h.icon=t,h.addChild(t),h.label.txt=""),r&&void 0===r.dropShadow?(h.tint=this.colors.keys.backgorundPressed,h.label.zIndex=2,h.foreground.removeFromParent(),h):(h.priority=100,h.onMouseUp=i.prototype.keyMouseUp.bind(this),h.onMouseDown=i.prototype.keyMouseDown.bind(this),h.onMouseCancel=i.prototype.keyMouseCancel.bind(this),h.setColors=function(t,e){this.icon?this.icon.tint=t:this.label.style.fill=t,this.foreground.tint=e}.bind(h),h.setPressed=function(){this.setColors(this.colors.textPressed,this.colors.backgorundPressed)}.bind(h),h.setReleased=function(){this.setColors(this.colors.text,this.colors.background)}.bind(h),h.setReleased(),h)},i.prototype.onChange=function(t){for(var e=0;e<this.subscribers.length;e++){var i=this.subscribers[e];i.onKeyboardChange&&i.onKeyboardChange(t)}},i.prototype.onType=function(t,e){},i.prototype.onBackspace=function(t){},i.prototype.keyMouseCancel=function(t,e){this.preview.visible=!1,e.setReleased(),this.deleteMainTimer&&clearTimeout(this.deleteMainTimer),this.deleteIntervalTimer&&clearInterval(this.deleteIntervalTimer)},i.prototype.keyMouseDown=function(e,i){if(this.deleteMainTimer&&clearTimeout(this.deleteMainTimer),this.deleteIntervalTimer&&clearInterval(this.deleteIntervalTimer),e.stopPropagation(),i.setPressed(),i.isSpecial)if("backspace"===i.symbol){var n=this;this.deleteMainTimer=setTimeout(function(){n.deleteIntervalTimer=setInterval(function(){n.stream?(n.stream=n.stream.slice(0,-1),n.onBackspace(n.stream),n.onChange(n.stream)):clearInterval(n.deleteIntervalTimer)},60)},600)}else"capitalize"===i.symbol?this.switchCapitalize():"keyboard_symbols"===i.symbol&&this.switchSymbols();else{this.preview.visible=!0;var o=i.position;this.preview.label.txt=i.symbol;var s=o.x,r=this.preview._width;s-r/2<0?s+=r/2-s:s+r/2>app.width&&(s-=s+r/2-app.width),this.preview.position.set(s,o.y-this.cellHeight/2-this.preview._height/2+this.keySpacingY)}this.isVibrating&&t.navigator&&t.navigator.vibrate&&t.navigator.vibrate(20)},i.prototype.keyMouseUp=function(t,e){this.deleteMainTimer&&clearTimeout(this.deleteMainTimer),this.deleteIntervalTimer&&clearInterval(this.deleteIntervalTimer),t.stopPropagation(),e.setReleased(),this.preview.visible=!1,this.limit&&this.limit<=this.stream.length&&(!e.isSpecial||"space"===e.symbol)||(e.isSpecial?"backspace"===e.symbol?(this.stream=this.stream.slice(0,-1),this.onBackspace(this.stream),this.onChange(this.stream)):"space"===e.symbol?(this.stream+=" ",this.onType(" ",this.stream),this.onChange(this.stream)):"done"===e.symbol&&(this.hasNext?this.delegate.onTab():(this.delegate&&this.delegate.onKeyboardDone&&this.delegate.onKeyboardDone(),this.hide(!0))):(this.stream+=e.symbol,this.onType(e.symbol,this.stream),this.onChange(this.stream)))},i.prototype.positionSetup=function(){var t=app.height-this._height;this.openPosition.x=0,this.openPosition.y=t},i.prototype.layout=function(){this.orientation===i.VERTICAL||(this.orientation,i.VERTICAL),this.recalculateSize(),this.backgroundSetup(),this.layoutSetup(),this.positionSetup()},i.prototype.show=function(t){if(this.isShown)return!1;Actions.stopByTag("keyboard_animation"),this.isShown=!0,this.kiboSetType(t),this.loadKeyboardSymbols(),this.layout(),app.input.add(this.buttons),app.input.add(this),this.visible=!0,new TweenMoveTo(this,this.openPosition,null,200).run("keyboard_animation"),this.delegate.onKeyboardShow&&this.delegate.onKeyboardShow()},i.prototype.hide=function(t){if(!this.isShown)return!1;if(Actions.stopByTag("keyboard_animation"),this.isShown=!1,t)for(var e=0;e<this.subscribers.length;e++){var i=this.subscribers[e];t&&i.isFocused&&i.blur()}for(e=0;e<this.buttons.length;e++){var n=this.buttons[e];app.input.remove(n)}app.input.remove(this),new TweenMoveTo(this,new V(0,app.height),null,200,function(t){t.visible=!1}).run("keyboard_animation"),this.delegate.onKeyboardHide&&this.delegate.onKeyboardHide()},i.prototype.onMouseDown=function(t,e){t.stopPropagation()},i.prototype.onMouseUp=function(t,e){t.stopPropagation()},i.prototype.kiboTab=function(){return this.delegate.onTab(),!1},i.prototype.kiboShiftTab=function(){return this.delegate.onShiftTab(),!1},i.prototype.kiboEsc=function(){return this.delegate.onEsc(),!1},i.prototype.kiboEnter=function(){return this.delegate.onEnter(),!1},t.Keyboard=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t){var e=void 0!==t.background?t.background:"white";this.backgroundIsSliced=void 0===t.backgroundIsSliced||t.backgroundIsSliced,this.backgroundWidth=void 0!==t.backgroundWidth?t.backgroundWidth:500,this.backgroundHeight=void 0!==t.backgroundHeight?t.backgroundHeight:80,this.backgroundPadding=void 0!==t.backgroundPadding?t.backgroundPadding:"1 1 1 1",this.backgroundTint=void 0!==t.backgroundTint?t.backgroundTint:16777215;var i=void 0!==t.foreground?t.foreground:"white";this.foregroundIsSliced=void 0===t.foregroundIsSliced||t.foregroundIsSliced,this.foregroundWidth=void 0!==t.foregroundWidth?t.foregroundWidth:500,this.foregroundHeight=void 0!==t.foregroundHeight?t.foregroundHeight:80,this.foregroundPadding=void 0!==t.foregroundPadding?t.foregroundPadding:"1 1 1 1",this.foregroundTint=void 0!==t.foregroundTint?t.foregroundTint:16777215,this.offsetX=void 0!==t.offsetX?t.offsetX:0,this.offsetY=void 0!==t.offsetY?t.offsetY:0,this.isAnimated=void 0!==t.isAnimated&&t.isAnimated,this.duration=void 0!==t.animationSpeed?t.animationSpeed:300,this.showPercent=void 0!==t.showPercent&&t.showPercent,this.textColor=void 0!==t.textColor?t.textColor:null,this.spriteInitialize(null),this.backgroundIsSliced?this.background=new NineSlice(e,this.backgroundPadding,this.backgroundWidth,this.backgroundHeight):(this.background=new Sprite(e),void 0===t.backgroundWidth?this.backgroundWidth=this.background.width:this.background.width=this.backgroundWidth,void 0===t.backgroundHeight?this.backgroundHeight=this.background.height:this.background.height=this.backgroundHeight,this.background.centered()),this.addChild(this.background),this.foregroundIsSliced?this.foreground=new NineSlice(i,this.foregroundPadding,this.foregroundWidth,this.foregroundHeight):(this.foreground=new Sprite(i),void 0===t.foregroundWidth?this.foregroundWidth=this.foreground.width:this.foreground.width=this.foregroundWidth,void 0===t.foregroundHeight?this.foregroundHeight=this.foreground.height:this.foreground.height=this.foregroundHeight,this.foreground.centered()),this.addChild(this.foreground),this.showPercent&&(this.percentLabel=new Label({fontSize:Math.round(.7*this.foregroundHeight),fontFamily:"Impact,Arial Black ,Arial Rounded MT Bold"}),this.percentLabel.centered(),this.percentLabel.txt="0%",null===this.textColor?this.percentLabel.style.fill=this.foregroundTint:this.percentLabel.style.fill=this.textColor,this.addChild(this.percentLabel)),this.background.tint=this.backgroundTint,this.foreground.tint=this.foregroundTint,this.foreground.x=this.offsetX,this.foreground.y=this.offsetY,this.percentage=0,this.toPercentage=1,this.isAnimating=!1;var n=new PIXI.Graphics;this.foreground.mask=n,this.foreground.addChild(n),this.centered(),this.setSensorSize(this.backgroundWidth,this.backgroundHeight)},i.prototype.setPercent=function(t,e){this.timeout=this.duration,this.isAnimating=void 0===e?this.isAnimated:e,this.isAnimating?this.toPercentage=t:(this.percentage=t,this.drawMask(t))},i.prototype.onUpdate=function(t){if(this.isAnimating&&this.timeout>0){this.timeout-=t;var e=(this.duration-this.timeout)/this.duration,i=this.toPercentage-this.percentage;this.drawMask(this.percentage+i*e),this.timeout<=0&&(this.isAnimating=!1,this.percentage=this.toPercentage)}},i.prototype.drawMask=function(t){var e=this.foreground.mask;this.percentage=Math.clamp(t,0,1);var i=-this.foregroundWidth*this.anchor.x-this.offsetX*this.anchor.x,n=-this.foregroundHeight*this.anchor.y-this.offsetY*this.anchor.y;if(e&&(e.clear(),e.beginFill(16777215,1),e.drawRect(i,n,this.foregroundWidth*this.percentage,this.foregroundHeight),e.endFill()),this.showPercent){var o=Math.round(100*t);this.percentLabel.txt=o+"%",o>50?null===this.textColor&&(this.percentLabel.style.fill=this.backgroundTint):null===this.textColor&&(this.percentLabel.style.fill=this.foregroundTint)}},t.LoadingBar=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n){this.backgroundParts=[],this.spriteInitialize(null),this.imageName=t,this.padding=e,this._width=i,this._height=n,this.anchor.set(.5,.5),this.setSize(i,n)},i.prototype.setSize=function(t,e){this._width=t||2,this._height=e||2,this.sensor=null,this.setSensorSize(this._width,this._height),this.buildBackground()},i.prototype.buildBackground=function(){if(this.imageName){var t=this._width||2,e=this._height||2,i=this.padding.toString().split(" "),n=Number(i[0])||0,o=Number(i[1])||n,s=Number(i[2])||o,r=Number(i[3])||s,a=new Sprite(this.imageName);if(n+s>a.height||r+o>a.width)console.warn("Invalid Padding for Nine Slice");else{for(var h=0;h<this.backgroundParts.length;h++){this.backgroundParts[h].removeFromParent()}this.backgroundParts=[],a.texture=a.texture.clone();var l=a.texture.frame;a.texture.frame=new PIXI.Rectangle(l.x+r,l.y+n,l.width-r-o,l.height-n-s),a.position.set(r-t/2,n-e/2),a.stretch(t-r-o,e-n-s),this.addChild(a),this.backgroundParts.push(a);var c=new Sprite(this.imageName);c.texture=c.texture.clone();l=c.texture.frame;var u=new PIXI.Rectangle(l.x+r,l.y,Math.abs(l.width-r-o),n);c.texture.frame=u,c.stretch(t-r-o,n),c.position.set(r-t/2,-e/2),this.addChild(c),this.backgroundParts.push(c);var p=new Sprite(this.imageName);p.texture=p.texture.clone();l=p.texture.frame;p.texture.frame=new PIXI.Rectangle(l.x,l.y,r,n),p.position.set(-t/2,-e/2),this.addChild(p),this.backgroundParts.push(p);var d=new Sprite(this.imageName);d.texture=d.texture.clone();l=d.texture.frame;d.texture.frame=new PIXI.Rectangle(l.x+l.width-o,l.y,o,n),d.position.set(t/2-o,-e/2),this.addChild(d),this.backgroundParts.push(d);var f=new Sprite(this.imageName);f.texture=f.texture.clone();l=f.texture.frame;f.texture.frame=new PIXI.Rectangle(l.x+l.width-o,l.y+n,o,l.height-n-s),f.position.set(t/2-o,-e/2+n),f.stretch(o,e-n-s),this.addChild(f),this.backgroundParts.push(f);var y=new Sprite(this.imageName);y.texture=y.texture.clone();l=y.texture.frame;y.texture.frame=new PIXI.Rectangle(l.x+l.width-o,l.y+l.height-s,o,s),y.position.set(t/2-o,e/2-s),this.addChild(y),this.backgroundParts.push(y);var g=new Sprite(this.imageName);g.texture=g.texture.clone();l=g.texture.frame;g.texture.frame=new PIXI.Rectangle(l.x+o,l.y+l.height-s,l.width-r-o,s),g.position.set(-t/2+r,e/2-s),g.stretch(t-r-o,s),this.addChild(g),this.backgroundParts.push(g);var b=new Sprite(this.imageName);b.texture=b.texture.clone();l=b.texture.frame;b.texture.frame=new PIXI.Rectangle(l.x,l.y+l.height-s,r,s),b.position.set(-t/2,e/2-s),this.addChild(b),this.backgroundParts.push(b);var v=new Sprite(this.imageName);v.texture=v.texture.clone();l=v.texture.frame;v.texture.frame=new PIXI.Rectangle(l.x,l.y+n,r,l.height-n-s),v.position.set(-t/2,-e/2+n),v.stretch(r,e-n-s),this.addChild(v),this.backgroundParts.push(v);for(h=0;h<this.backgroundParts.length;h++)this.backgroundParts[h].tint=this.tint}}},Object.defineProperty(i.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t;for(var e=0;e<this.backgroundParts.length;e++)this.backgroundParts[e].tint=t}}),Object.defineProperty(i.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.setSize(this._width,this._height)}}),Object.defineProperty(i.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.setSize(this._width,this._height)}}),t.NineSlice=i}(window),function(t,e){function i(t,e,i,n){this.initialize(t,e,i,n)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t,e,i,n){n=void 0===n?20:n,this.isSelected=!1,this.spriteInitialize(null),this.radioImage=e,this.radioSprite=new Sprite(e),this.label=new Label(i),this.label.txt=t,this.label.position.set(this.radioSprite.width+n,0),this.addChild(this.radioSprite),this.addChild(this.label);var o=this.getBounds();this.setSensorSize(o.width,o.height),this.priority=10},i.prototype.setSelected=function(t){t=void 0===t||t,this.isSelected=t,t?(Notes.send(Notes.RADIO_BUTTON_SELECTED,null,this),this.radioSprite.setTexture(this.radioImage+"_selected")):this.radioSprite.setTexture(this.radioImage)},i.prototype.onMouseUp=function(t,e){this.setSelected()},i.prototype.onUpdate=function(t){},i.prototype.onNote=function(t,e,i){t===Notes.RADIO_BUTTON_SELECTED&&(i===this||this.setSelected(!1))},t.RadioButton=i}(window),function(t,e){function i(){this.initialize()}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(){this.spriteInitialize(),this.contentWidth=0,this.contentHeight=0,this.bodyWidth=0,this.bodyHeight=0,this.body=new Layer,Sprite.prototype.addChild.call(this,this.body),this.content=new ScrollviewContent,this.body.addChild(this.content),this.scrollingSpeed=new V,this.lastScrollPosition=new V,this.currentScrollPosition=new V,this.startScrollPosition=new V,this.prevX=0,this.prevY=0,this.priority=11,this._hasScrolled=!1},i.prototype.scrollToElement=function(t,e){var i=(new V).copy(t.getGlobalPosition()),n=new V(app.width/2,app.height/3*2),o=V.substruction(n,i);if(e>0){var s=this,r=V.addition(o,this.currentScrollPosition),a=new Bezier(.48,.15,.52,.92);new TweenMoveTo(this.content,r,a,e,function(t){s.currentScrollPosition.copy(t.position),s.lastScrollPosition.copy(s.currentScrollPosition)}).run()}else this.scrollBy(o.x,o.y),this.lastScrollPosition.copy(this.currentScrollPosition)},i.prototype.scrollBy=function(t,e){var i=this.currentScrollPosition,n=i.x+t,o=i.y+e,s=this._width-this.contentWidth;(n>0||n<s)&&(this.scrollingSpeed.x=0),n=(n=n>0?0:n)<s?s:n;var r=this._height-this.contentHeight;(o>0||o<r)&&(this.scrollingSpeed.y=0),o=(o=o>0?0:o)<r?r:o,this.content.position.set(n,o),this.currentScrollPosition.x=n,this.currentScrollPosition.y=o},i.prototype.onMouseDown=function(t,e){this.prevY=t.point.y,this.prevX=t.point.x,this.startScrollPosition.copy(t.point),this._hasScrolled=!1},i.prototype.onMouseMove=function(t,e){if(Math.getDistance(this.startScrollPosition,t.point)>10){var i=-this.prevX+t.point.x,n=-this.prevY+t.point.y;this.scrollBy(i,n),this.prevX=t.point.x,this.prevY=t.point.y,this._hasScrolled=!0}},i.prototype.onMouseUp=function(t){this._hasScrolled&&t.stopPropagation(),this._hasScrolled=!1},i.prototype.onMouseCancel=function(){},i.prototype.onWheel=function(t){t.point.y<0?this.scrollingSpeed.y=-1:this.scrollingSpeed.y=1},i.prototype.onUpdate=function(t){var e=V.substruction(this.currentScrollPosition,this.lastScrollPosition);e.len()>0&&(this.scrollingSpeed.x=(this.scrollingSpeed.x+e.x/t)/2,this.scrollingSpeed.y=(this.scrollingSpeed.y+e.y/t)/2);var i=this.scrollingSpeed.len();i>.02?(this.is_mouse_down||this.scrollBy(this.scrollingSpeed.x*t,this.scrollingSpeed.y*t),this.scrollingSpeed.scale(.9,.9)):i<.02&&(this.scrollingSpeed.x=0,this.scrollingSpeed.y=0),this.lastScrollPosition.copy(this.currentScrollPosition)},i.prototype.addChild=function(){throw"Don't add child content to the scroll view directly , use the content instead"},i.prototype.setSize=function(t,e){this.bodyWidth=t,this.bodyHeight=e,this.setSensorSize(t,e),this.body.mask&&this.body.mask.removeFromParent();var i=new PIXI.Graphics;i.beginFill(),i.drawRect(0,0,this._width,this._height),i.endFill(),this.body.mask=i,this.body.addChild(i)},i.prototype.setContentSize=function(t,e){this.contentWidth=t,this.contentHeight=e,this.content.setSensorSize(t,e)},t.ScrollView=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.ANIMATION_DOTS=0,i.ANIMATION_SQUARE=1,i.prototype=Object.create(PIXI.Container.prototype),i.prototype.constructor=i,i.prototype.initialize=function(t,e,n){PIXI.Container.call(this),this.speed=e.speed||1e3,this.restore=void 0===e.restore||e.restore,this.size=e.size||30,this.jumpHeight=void 0===e.jump?20:e.jump,this.animated=void 0===e.animated||e.animated,this.animationType=e.animation||i.ANIMATION_DOTS,this.tint=e.color||3433707,this.replaceObject=t,this.replaceObject&&(this.x=this.replaceObject.x,this.y=this.replaceObject.y),this.animation=null,n&&(this.animation=n.bind(this)),this.replaceInitialScale=1,this.tag="spinner-animation",this.isRunning=!1},i.prototype.createSquare=function(){var t=new Sprite("white");return t.stretch(this.size,this.size),t.tint=this.tint,t.centered(),this.addChild(t),t},i.prototype.animate=function(){return this.replaceObject&&(this.replaceObject.parent.addChild(this),this.replaceInitialScale=this.replaceObject.scale.x),this.animated?(this.replaceObject&&new TweenScale(this.replaceObject,.2,null,60,function(){this.object.visible=!1}).run(this.tag),this.scale.set(0),new TweenScale(this,1,null,60).delay(30).run(this.tag)):this.replaceObject&&(this.replaceObject.visible=!1),this.animation?this.animation(this.tag):this.animationType===i.ANIMATION_SQUARE?(this.animateSquare(),this.jump&&this.jump(this,this.jumpHeight)):this.animationType===i.ANIMATION_DOTS&&this.animateDots(),this},i.prototype.animateSquare=function(){return this.background=this.createSquare(),new TweenRotate(this,1,null,this.speed).run(this.tag),this},i.prototype.animateDots=function(){var t=this.createSquare(),e=this.createSquare(),i=this.createSquare();t.x=2*-this.size,i.x=2*this.size,t.alpha=0,e.alpha=0,i.alpha=0;var n=this;return n.jump(t,n.jumpHeight),new TweenIdle(100,function(){n.jump(e,n.jumpHeight)}).run(this.tag),new TweenIdle(200,function(){n.jump(i,n.jumpHeight)}).run(this.tag),new TweenAlpha(t,1,null,100).delay(0).run(this.tag),new TweenAlpha(e,1,null,100).delay(100).run(this.tag),new TweenAlpha(i,1,null,100).delay(200).run(this.tag),this},i.prototype.jump=function(t,e){var i=new Easing(Easing.EASE_OUT_BOUNCE),n=this,o=t.y;return new TweenMoveTo(t,new V(t.x,o-e),new Bezier(.24,.81,.54,1),200,function(){new TweenMoveTo(t,new V(t.x,o),i,400,function(){n.jump(t,e)}).run(this.tag)}).delay(300).run(this.tag),this},i.prototype.start=function(){return this.run()},i.prototype.run=function(){return i.spinners.push(this),this.animate(),this.isRunning=!0,this},i.prototype.stop=function(){return this.isRunning=!1,this.restore&&this.replaceObject&&(this.replaceObject.visible=!0,this.animated&&new TweenScale(this.replaceObject,this.replaceInitialScale,null,60).run()),this.animated?new TweenScale(this,0,null,30,function(){this.object.removeFromParent()}).run():this.removeFromParent(),i.spinners.removeElement(this),Actions.stopByTag(this.tag),this},i.spinners=[],i.create=function(t,e){return new i(null,t||{},e)},i.replace=function(t,e,n){var o=new i(t,e||{},n);return o.run(),o},i.stop=function(){for(var t=i.spinners.length-1;t>=0;t--){i.spinners[t].stop()}i.spinners=[]},t.Spinner=i}(window),function(t,e){var i={colors:{},types:{Button:{},Label:{},Input:{}}};i.types.ButtonObject=i.types.Button,i.types.LabelObject=i.types.Label,i.types.InputObject=i.types.Input,i.addLabel=function(t,e,n){var o=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(n||null));i.types.Label[t]={style:o,properties:s}},i.addButton=function(t,e,n){var o=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(n));i.types.Button[t]={style:o,properties:s}},i.addColor=function(t,e){i.colors[t]=e},t.Styles=i}(window),function(t,e){function i(){this.initialize()}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(){this.spriteInitialize(),this.index=0,this.isSelected=!1,this._width=100,this._height=60,this.tappedLocation={x:0,y:0},this._id=-1,this.label=new Label,this.label.style.fill="#dddddd",this.label.style.fontSize=32,this.label.style.fontFamily="Arial Black",this.label.anchor.set(0,.5),this.label.position.set(20,30),this.addChild(this.label),this.setSensorSize(this._width,this._height),this.isMouseDown=!1,this.hasMoved=!1},i.prototype.onMouseDown=function(t,e){this.isMouseDown=!0,this.hasMoved=!1},i.prototype.onMouseMove=function(t,e){this.hasMoved=!0},i.prototype.onMouseUp=function(t,e){this.isMouseDown=!1,this.hasMoved=!1},i.prototype.onMouseCancel=function(t,e){this.isMouseDown=!1,this.hasMoved=!1},i.prototype.bindData=function(t){this.label.txt=t.text},t.TableCell=i}(window),function(t,e){function i(t){this.initialize(t)}i.prototype=new Sprite,i.prototype.spriteInitialize=i.prototype.initialize,i.prototype.initialize=function(t){this.spriteInitialize(),this.delegate=t,this.cellType=TableCell,this.data=[],this.offsetY=0,this.offsetX=0,this.cells=[],this.cellsHeight=100,this.numberOfVisibleCells=0,this.previousY=0,this.scrollingSpeed=0,this.friction=.05,this.previousFrameOffsetY=0,this.isChildrenSortable=!1,this.isScrollable=!0,this.cellSelectedIndex=void 0,this.toleranceDistance=5,this.tappedLocation={x:0,y:0},this.tappedCell=null,this.readyCounter=100,this.touchTimer=0,this.mask=new PIXI.Graphics},i.prototype.onWheel=function(t){t.point.y<0?this.scrollingSpeed=-1:this.scrollingSpeed=1},i.prototype.setSize=function(t,e){this._width=t,this._height=e,this.setSensorSize(t,e),this.mask.clear(),this.mask.beginFill(),this.mask.drawRect(0,0,this._width,this._height),this.mask.endFill(),this.addChild(this.mask)},i.prototype.onMouseDown=function(t){this.previousY=t.point.y,this.tappedLocation=t.point,this.touchTimer=0,t.stopPropagation();for(var e=0;e<this.cells.length;e++){var i=this.cells[e];SAT.pointInPolygon(t.point,i.getSensor())&&(this.tappedCell=i)}},i.prototype.onMouseUp=function(t){t.stopPropagation(),this.tappedCell&&(0===this.scrollingSpeed&&this.tappedCell&&!this.tappedCell.hasMoved?this.onCellSelected(this.tappedCell,t):this.touchTimer<200&&Math.abs(this.scrollingSpeed<.05)&&Math.abs(this.tappedLocation.y-t.point.y)<10&&this.onCellSelected(this.tappedCell,t),this.tappedCell.onMouseUp(t,this))},i.prototype.onMouseMove=function(t){var e=Math.getDistance(this.tappedLocation,t.point),i=this.previousY-t.point.y;this.previousY=t.point.y,e>this.toleranceDistance&&this.scrollY(i),this.tappedCell&&(this.touchTimer<200&&Math.abs(this.scrollingSpeed<.05)&&Math.abs(this.tappedLocation.y-t.point.y)<10||this.tappedCell.onMouseMove(t,this))},i.prototype.onMouseCancel=function(t){this.tappedCell&&this.tappedCell.onMouseCancel(t,this)},i.prototype.setCellType=function(t){this.cellType=t},i.prototype.scrollY=function(t){if(!this.isScrollable)return this.offsetY=0,!0;this.offsetY+t<0?(this.offsetY=0,this.scrollingSpeed=0):this.offsetY+t>=this.data.length*this.cellsHeight-this._height?(this.offsetY=this.data.length*this.cellsHeight-this._height,this.scrollingSpeed=0):this.offsetY+=t},i.prototype.setEmpty=function(){for(var t=0;t<this.cells.length;t++)this.cells[t].removeFromParent();this.cells=[],this.data=[],this.offsetX=0,this.offsetY=0,this.stopScrolling()},i.prototype.initCells=function(){if(this._width<=0||this._height<=0)throw"framework: table must have visible size";if(this.data.length){for(i=0;i<this.cells.length;i++)this.cells[i].removeFromParent();this.cells=[];var t=new this.cellType;this.cellsHeight=t._height,this.cellsHeight*this.data.length<=this._height?(this.numberOfVisibleCells=this.data.length,this.isScrollable=!1):(this.numberOfVisibleCells=Math.ceil(this._height/this.cellsHeight)+1,this.isScrollable=!0);for(i=0;i<this.numberOfVisibleCells;i++){var e=new this.cellType;this.cells.push(e),this.addChild(e)}}else{this.offsetX=0,this.offsetY=0,this.stopScrolling();for(var i=0;i<this.cells.length;i++)this.cells[i].removeFromParent();this.cells=[]}},i.prototype.setData=function(t){if(this.setEmpty(),this.data=t,t)for(var e=0;e<t.length;e++){t[e]._id=e}},i.prototype.get_first_visible_cell_index=function(){return Math.floor(this.offsetY/this.cellsHeight)},i.prototype.stopScrolling=function(){this.readyCounter=0,this.scrollingSpeed=0,this.previousFrameOffsetY=this.offsetY},i.prototype.onUpdate=function(t){if(this.touchTimer+=t,this.touchTimer>40&&this.isMouseDown&&(!this.tappedCell||this.tappedCell.isMouseDown||this.tappedCell.hasMoved||this.tappedCell.onMouseDown(null,this)),this.data.length){var e=this.offsetY-this.previousFrameOffsetY;0!==e&&(this.scrollingSpeed=(this.scrollingSpeed+e/t)/2),this.scrollingSpeed>.02||this.scrollingSpeed<-.02?(this.isMouseDown||this.scrollY(this.scrollingSpeed*t),this.scrollingSpeed=this.scrollingSpeed-this.scrollingSpeed*this.friction):this.scrollingSpeed<.02&&this.scrollingSpeed>-.02&&(this.scrollingSpeed=0),this.previousFrameOffsetY=this.offsetY;for(var i=Math.floor(this.offsetY/this.cellsHeight),n=this.offsetY%this.cellsHeight,o=0,s=i;s<i+this.numberOfVisibleCells;s++){var r=this.cells[o];if(r.index=s,r.position.set(0,o*this.cellsHeight-n),s===this.data.length)break;r.isSelected=!1,r.index===this.cellSelectedIndex&&(r.isSelected=!0),this.data[s]._id!==r._id&&(r._id=this.data[s]._id,r.bindData(this.data[s])),o++}}},i.prototype.onInputAdded=function(){},i.prototype.onInputRemoved=function(){},i.prototype.onCellSelected=function(t,e){this.cellSelectedIndex=t.index,this.delegate&&this.delegate.onTableViewCellSelected&&this.delegate.onTableViewCellSelected(t)},t.TableView=i}(window),function(t,e){function i(t,e,i){this.initialize(t,e,i)}i.SUCCESS=0,i.WARRNING=1,i.ERROR=2,i.prototype=Object.create(PIXI.Container.prototype),i.prototype.constructor=i,i.prototype.initialize=function(t,e,n){PIXI.Container.call(this),this.message=t,this.type=e;switch(this.fontSize=app.width<app.height?app.width/app.height*100:app.height/app.width*100*2,this.textureName=Config.TOAST_TEXTURE||"white",this.fontName=Config.TOAST_FONT_NAME||"arial",this.fontSize=Config.TOAST_FONT_SIZE||this.fontSize,this.padding=Config.TOAST_PADDING||25,this.backgroundAlpha=Config.TOAST_ALPHA||.95,this.duration=3e3,this.animation=null,e){case i.SUCCESS:this.backColor=Config.TOAST_SUCCESS_BACK_COLOR||1489004,this.textColor=Config.TOAST_SUCCESS_TEXT_COLOR||16777215;break;case i.WARRNING:this.backColor=Config.TOAST_WARRNING_BACK_COLOR||16230198,this.textColor=Config.TOAST_WARRNING_TEXT_COLOR||16777215;break;case i.ERROR:this.backColor=Config.TOAST_ERROR_BACK_COLOR||13573405,this.textColor=Config.TOAST_ERROR_TEXT_COLOR||16777215;break;default:this.backColor=Config.TOAST_SUCCESS_BACK_COLOR||1489004,this.textColor=Config.TOAST_SUCCESS_TEXT_COLOR||16777215}n&&(this.duration=n.duration||this.duration,this.backgroundAlpha=n.alpha||this.backgroundAlpha,this.fontSize=n.fontSize||this.fontSize),this.zIndex=1e3,this.build()},i.prototype.build=function(){var t=null;"white"===this.textureName?(t=new Sprite("white")).setSize=function(t,e){this.stretch(t,e)}.bind(t):t=new NineSlice(this.textureName,"20"),this.addChild(t);var e=0,i=this.padding;e=app.width;e=Math.clamp(e,200,1600);var n=new Label;n.style.fontFamily=this.fontName,n.style.fontSize=this.fontSize,n.style.fill=this.textColor,n.style.wordWrap=!0,n.style.wordWrapWidth=e-2*i,n.txt=this.message,n.anchor.set(0,0),n.x=i,n.y=i,this.addChild(n),this._height=n.height+2*i,this._width=e,t.setSize(Math.max(e,n.width),this._height),t.alpha=this.backgroundAlpha,t.tint=this.backColor,"white"!==this.textureName&&(t.x=t._width/2,t.y=t._height/2),this.sensor=null,this.setSensorSize(this._width,this._height)},i.prototype.onMouseDown=function(t,e){this.animation.pause()},i.prototype.onMouseUp=function(t,e){this.visible=!1,this.isTouchable=!1},i.prototype.onMouseCancel=function(t,e){this.visible=!1,this.isTouchable=!1},i.success=function(){var t=new i(arguments[0],i.SUCCESS,arguments[1]);i.animate(t)},i.warrning=function(){var t=new i(arguments[0],i.WARRNING,arguments[1]);i.animate(t)},i.error=function(){var t=new i(arguments[0],i.ERROR,arguments[1]);i.animate(t)},i.animate=function(t){app.stage.addChild(t),t.x=(app.width-t._width)/2,t.y=-50,t.alpha=0,app.input.add(t),t.animation=new Sequencer,t.animation.addThread([new TweenGeneric(t,{y:0,alpha:1},null,200),new TweenIdle(t.duration),new TweenGeneric(t,{y:-50,alpha:0},null,200,function(){t.removeFromParent(),app.input.remove(t)})]),t.animation.run()},t.Toast=i}(window);